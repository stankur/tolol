import{s as Cn,e as Zt,c as Qt,b as Qr,f as Ge,p as Xr,i as wn,n as St,S as Kl,o as Gl,T as Zl,r as Nu,L as Yr,U as oi,V as si,K as ze,w as Ql,W as li,X as ai,Y as Dt,Z as Xl,a as eu,g as tu,O as Yl,h as Fn,_ as Lo,l as ci}from"./scheduler.DA8G3igw.js";import{S as lr,i as ar,f as qo,c as nu,a as ru,m as uu,t as on,b as sn,d as iu,g as ea,e as ta}from"./index.Vas_EnUa.js";import{g as na}from"./spread.CgU5AtxT.js";function H(t){this.content=t}H.prototype={constructor:H,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,u=r.find(t),i=r.content.slice();return u==-1?i.push(n||t,e):(i[u+1]=e,n&&(i[u]=n)),new H(i)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new H(n)},addToStart:function(t,e){return new H([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new H(n)},addBefore:function(t,e,n){var r=this.remove(e),u=r.content.slice(),i=r.find(t);return u.splice(i==-1?u.length:i,0,e,n),new H(u)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=H.from(t),t.size?new H(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=H.from(t),t.size?new H(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=H.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};H.from=function(t){if(t instanceof H)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new H(e)};function Vo(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let u=t.child(r),i=e.child(r);if(u==i){n+=u.nodeSize;continue}if(!u.sameMarkup(i))return n;if(u.isText&&u.text!=i.text){for(let o=0;u.text[o]==i.text[o];o++)n++;return n}if(u.content.size||i.content.size){let o=Vo(u.content,i.content,n+1);if(o!=null)return o}n+=u.nodeSize}}function $o(t,e,n,r){for(let u=t.childCount,i=e.childCount;;){if(u==0||i==0)return u==i?null:{a:n,b:r};let o=t.child(--u),s=e.child(--i),l=o.nodeSize;if(o==s){n-=l,r-=l;continue}if(!o.sameMarkup(s))return{a:n,b:r};if(o.isText&&o.text!=s.text){let a=0,c=Math.min(o.text.length,s.text.length);for(;a<c&&o.text[o.text.length-a-1]==s.text[s.text.length-a-1];)a++,n--,r--;return{a:n,b:r}}if(o.content.size||s.content.size){let a=$o(o.content,s.content,n-1,r-1);if(a)return a}n-=l,r-=l}}class b{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,u=0,i){for(let o=0,s=0;s<n;o++){let l=this.content[o],a=s+l.nodeSize;if(a>e&&r(l,u+s,i||null,o)!==!1&&l.content.size){let c=s+1;l.nodesBetween(Math.max(0,e-c),Math.min(l.content.size,n-c),r,u+c)}s=a}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,u){let i="",o=!0;return this.nodesBetween(e,n,(s,l)=>{let a=s.isText?s.text.slice(Math.max(e,l)-l,n-l):s.isLeaf?u?typeof u=="function"?u(s):u:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&a||s.isTextblock)&&r&&(o?o=!1:i+=r),i+=a},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,u=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(u[u.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)u.push(e.content[i]);return new b(u,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],u=0;if(n>e)for(let i=0,o=0;o<n;i++){let s=this.content[i],l=o+s.nodeSize;l>e&&((o<e||l>n)&&(s.isText?s=s.cut(Math.max(0,e-o),Math.min(s.text.length,n-o)):s=s.cut(Math.max(0,e-o-1),Math.min(s.content.size,n-o-1))),r.push(s),u+=s.nodeSize),o=l}return new b(r,u)}cutByIndex(e,n){return e==n?b.empty:e==0&&n==this.content.length?this:new b(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let u=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return u[e]=n,new b(u,i)}addToStart(e){return new b([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new b(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let u=this.content[n];e(u,r,n),r+=u.nodeSize}}findDiffStart(e,n=0){return Vo(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return $o(this,e,n,r)}findIndex(e,n=-1){if(e==0)return Nn(0,e);if(e==this.size)return Nn(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,u=0;;r++){let i=this.child(r),o=u+i.nodeSize;if(o>=e)return o==e||n>0?Nn(r+1,o):Nn(r,u);u=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return b.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new b(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return b.empty;let n,r=0;for(let u=0;u<e.length;u++){let i=e[u];r+=i.nodeSize,u&&i.isText&&e[u-1].sameMarkup(i)?(n||(n=e.slice(0,u)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new b(n||e,r)}static from(e){if(!e)return b.empty;if(e instanceof b)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new b([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}b.empty=new b([],0);const Cr={index:0,offset:0};function Nn(t,e){return Cr.index=t,Cr.offset=e,Cr}function jn(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!jn(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!jn(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}class v{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let u=0;u<e.length;u++){let i=e[u];if(this.eq(i))return e;if(this.type.excludes(i.type))n||(n=e.slice(0,u));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(n||(n=e.slice(0,u)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&jn(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);return r.create(n.attrs)}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return v.none;if(e instanceof v)return[e];let n=e.slice();return n.sort((r,u)=>r.type.rank-u.type.rank),n}}v.none=[];class Jn extends Error{}class k{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=Wo(this.content,e+this.openStart,n);return r&&new k(r,this.openStart,this.openEnd)}removeBetween(e,n){return new k(Ho(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return k.empty;let r=n.openStart||0,u=n.openEnd||0;if(typeof r!="number"||typeof u!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new k(b.fromJSON(e,n.content),r,u)}static maxOpen(e,n=!0){let r=0,u=0;for(let i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.lastChild)u++;return new k(e,r,u)}}k.empty=new k(b.empty,0,0);function Ho(t,e,n){let{index:r,offset:u}=t.findIndex(e),i=t.maybeChild(r),{index:o,offset:s}=t.findIndex(n);if(u==e||i.isText){if(s!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(Ho(i.content,e-u-1,n-u-1)))}function Wo(t,e,n,r){let{index:u,offset:i}=t.findIndex(e),o=t.maybeChild(u);if(i==e||o.isText)return t.cut(0,e).append(n).append(t.cut(e));let s=Wo(o.content,e-i-1,n);return s&&t.replaceChild(u,o.copy(s))}function ra(t,e,n){if(n.openStart>t.depth)throw new Jn("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Jn("Inconsistent open depths");return jo(t,e,n,0)}function jo(t,e,n,r){let u=t.index(r),i=t.node(r);if(u==e.index(r)&&r<t.depth-n.openStart){let o=jo(t,e,n,r+1);return i.copy(i.content.replaceChild(u,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,s=o.content;return ct(o,s.cut(0,t.parentOffset).append(n.content).append(s.cut(e.parentOffset)))}else{let{start:o,end:s}=ua(n,t);return ct(i,Uo(t,o,s,e,r))}else return ct(i,Un(t,e,r))}function Jo(t,e){if(!e.type.compatibleContent(t.type))throw new Jn("Cannot join "+e.type.name+" onto "+t.type.name)}function ou(t,e,n){let r=t.node(n);return Jo(r,e.node(n)),r}function at(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Xt(t,e,n,r){let u=(e||t).node(n),i=0,o=e?e.index(n):u.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(at(t.nodeAfter,r),i++));for(let s=i;s<o;s++)at(u.child(s),r);e&&e.depth==n&&e.textOffset&&at(e.nodeBefore,r)}function ct(t,e){return t.type.checkContent(e),t.copy(e)}function Uo(t,e,n,r,u){let i=t.depth>u&&ou(t,e,u+1),o=r.depth>u&&ou(n,r,u+1),s=[];return Xt(null,t,u,s),i&&o&&e.index(u)==n.index(u)?(Jo(i,o),at(ct(i,Uo(t,e,n,r,u+1)),s)):(i&&at(ct(i,Un(t,e,u+1)),s),Xt(e,n,u,s),o&&at(ct(o,Un(n,r,u+1)),s)),Xt(r,null,u,s),new b(s)}function Un(t,e,n){let r=[];if(Xt(null,t,n,r),t.depth>n){let u=ou(t,e,n+1);at(ct(u,Un(t,e,n+1)),r)}return Xt(e,null,n,r),new b(r)}function ua(t,e){let n=e.depth-t.openStart,u=e.node(n).copy(t.content);for(let i=n-1;i>=0;i--)u=e.node(i).copy(b.from(u));return{start:u.resolveNoCache(t.openStart+n),end:u.resolveNoCache(u.content.size-t.openEnd-n)}}class ln{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],u=e.child(n);return r?e.child(n).cut(r):u}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],u=n==0?0:this.path[n*3-1]+1;for(let i=0;i<e;i++)u+=r.child(i).nodeSize;return u}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return v.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),u=e.maybeChild(n);if(!r){let s=r;r=u,u=s}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!u||!i[o].isInSet(u.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,u=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!u||!r[i].isInSet(u.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Kn(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],u=0,i=n;for(let o=e;;){let{index:s,offset:l}=o.content.findIndex(i),a=i-l;if(r.push(o,s,u+l),!a||(o=o.child(s),o.isText))break;i=a-1,u+=l+1}return new ln(n,r,i)}static resolveCached(e,n){let r=fi.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==n)return o}else fi.set(e,r=new ia);let u=r.elts[r.i]=ln.resolve(e,n);return r.i=(r.i+1)%oa,u}}class ia{constructor(){this.elts=[],this.i=0}}const oa=12,fi=new WeakMap;class Kn{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const sa=Object.create(null);let ft=class su{constructor(e,n,r,u=v.none){this.type=e,this.attrs=n,this.marks=u,this.content=r||b.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,u=0){this.content.nodesBetween(e,n,r,u,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,u){return this.content.textBetween(e,n,r,u)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&jn(this.attrs,n||e.defaultAttrs||sa)&&v.sameSet(this.marks,r||v.none)}copy(e=null){return e==this.content?this:new su(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new su(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return k.empty;let u=this.resolve(e),i=this.resolve(n),o=r?0:u.sharedDepth(n),s=u.start(o),a=u.node(o).content.cut(u.pos-s,i.pos-s);return new k(a,u.depth-o,i.depth-o)}replace(e,n,r){return ra(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:u}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(u==e||n.isText)return n;e-=u+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let u=this.content.child(n-1);return{node:u,index:n-1,offset:r-u.nodeSize}}resolve(e){return ln.resolveCached(this,e)}resolveNoCache(e){return ln.resolve(this,e)}rangeHasMark(e,n,r){let u=!1;return n>e&&this.nodesBetween(e,n,i=>(r.isInSet(i.marks)&&(u=!0),!u)),u}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Ko(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=b.empty,u=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,u,i),s=o&&o.matchFragment(this.content,n);if(!s||!s.validEnd)return!1;for(let l=u;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,u){if(u&&!this.type.allowsMarks(u))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=v.none;for(let n=0;n<this.marks.length;n++)e=this.marks[n].addToSet(e);if(!v.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let u=b.fromJSON(e,n.content);return e.nodeType(n.type).create(n.attrs,u,r)}};ft.prototype.text=void 0;class Gn extends ft{constructor(e,n,r,u){if(super(e,n,null,u),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Ko(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Gn(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Gn(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Ko(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class mt{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new la(e,n);if(r.next==null)return mt.empty;let u=Go(r);r.next&&r.err("Unexpected trailing text");let i=ma(pa(u));return ga(i,r),i}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let u=this;for(let i=n;u&&i<r;i++)u=u.matchType(e.child(i).type);return u}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let u=[this];function i(o,s){let l=o.matchFragment(e,r);if(l&&(!n||l.validEnd))return b.from(s.map(a=>a.createAndFill()));for(let a=0;a<o.next.length;a++){let{type:c,next:f}=o.next[a];if(!(c.isText||c.hasRequiredAttrs())&&u.indexOf(f)==-1){u.push(f);let d=i(f,s.concat(c));if(d)return d}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let u=r.shift(),i=u.match;if(i.matchType(e)){let o=[];for(let s=u;s.type;s=s.via)o.push(s.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:s,next:l}=i.next[o];!s.isLeaf&&!s.hasRequiredAttrs()&&!(s.name in n)&&(!u.type||l.validEnd)&&(r.push({match:s.contentMatch,type:s,via:u}),n[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let u=0;u<r.next.length;u++)e.indexOf(r.next[u].next)==-1&&n(r.next[u].next)}return n(this),e.map((r,u)=>{let i=u+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}mt.empty=new mt(!0);class la{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Go(t){let e=[];do e.push(aa(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function aa(t){let e=[];do e.push(ca(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function ca(t){let e=ha(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=fa(t,e);else break;return e}function di(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function fa(t,e){let n=di(t),r=n;return t.eat(",")&&(t.next!="}"?r=di(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function da(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let u=[];for(let i in n){let o=n[i];o.groups.indexOf(e)>-1&&u.push(o)}return u.length==0&&t.err("No node type or group '"+e+"' found"),u}function ha(t){if(t.eat("(")){let e=Go(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=da(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function pa(t){let e=[[]];return u(i(t,0),n()),e;function n(){return e.push([])-1}function r(o,s,l){let a={term:l,to:s};return e[o].push(a),a}function u(o,s){o.forEach(l=>l.to=s)}function i(o,s){if(o.type=="choice")return o.exprs.reduce((l,a)=>l.concat(i(a,s)),[]);if(o.type=="seq")for(let l=0;;l++){let a=i(o.exprs[l],s);if(l==o.exprs.length-1)return a;u(a,s=n())}else if(o.type=="star"){let l=n();return r(s,l),u(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=n();return u(i(o.expr,s),l),u(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(s)].concat(i(o.expr,s));if(o.type=="range"){let l=s;for(let a=0;a<o.min;a++){let c=n();u(i(o.expr,l),c),l=c}if(o.max==-1)u(i(o.expr,l),l);else for(let a=o.min;a<o.max;a++){let c=n();r(l,c),u(i(o.expr,l),c),l=c}return[r(l)]}else{if(o.type=="name")return[r(s,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Zo(t,e){return e-t}function hi(t,e){let n=[];return r(e),n.sort(Zo);function r(u){let i=t[u];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(u);for(let o=0;o<i.length;o++){let{term:s,to:l}=i[o];!s&&n.indexOf(l)==-1&&r(l)}}}function ma(t){let e=Object.create(null);return n(hi(t,0));function n(r){let u=[];r.forEach(o=>{t[o].forEach(({term:s,to:l})=>{if(!s)return;let a;for(let c=0;c<u.length;c++)u[c][0]==s&&(a=u[c][1]);hi(t,l).forEach(c=>{a||u.push([s,a=[]]),a.indexOf(c)==-1&&a.push(c)})})});let i=e[r.join(",")]=new mt(r.indexOf(t.length-1)>-1);for(let o=0;o<u.length;o++){let s=u[o][1].sort(Zo);i.next.push({type:u[o][0],next:e[s.join(",")]||n(s)})}return i}}function ga(t,e){for(let n=0,r=[t];n<r.length;n++){let u=r[n],i=!u.validEnd,o=[];for(let s=0;s<u.next.length;s++){let{type:l,next:a}=u.next[s];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(a)==-1&&r.push(a)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Qo(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Xo(t,e){let n=Object.create(null);for(let r in t){let u=e&&e[r];if(u===void 0){let i=t[r];if(i.hasDefault)u=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=u}return n}function Yo(t){let e=Object.create(null);if(t)for(let n in t)e[n]=new ba(t[n]);return e}let pi=class es{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Yo(r.attrs),this.defaultAttrs=Qo(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==mt.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Xo(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ft(this,this.computeAttrs(e),b.from(n),v.setFrom(r))}createChecked(e=null,n,r){return n=b.from(n),this.checkContent(n),new ft(this,this.computeAttrs(e),n,v.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=b.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let u=this.contentMatch.matchFragment(n),i=u&&u.fillBefore(b.empty,!0);return i?new ft(this,e,n.append(i),v.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:v.none:e}static compile(e,n){let r=Object.create(null);e.forEach((i,o)=>r[i]=new es(i,n,o));let u=n.spec.topNode||"doc";if(!r[u])throw new RangeError("Schema is missing its top node type ('"+u+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class ba{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class cr{constructor(e,n,r,u){this.name=e,this.rank=n,this.schema=r,this.spec=u,this.attrs=Yo(u.attrs),this.excluded=null;let i=Qo(this.attrs);this.instance=i?new v(this,i):null}create(e=null){return!e&&this.instance?this.instance:new v(this,Xo(this.attrs,e))}static compile(e,n){let r=Object.create(null),u=0;return e.forEach((i,o)=>r[i]=new cr(i,u++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}excludes(e){return this.excluded.indexOf(e)>-1}}class xa{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let u in e)n[u]=e[u];n.nodes=H.from(e.nodes),n.marks=H.from(e.marks||{}),this.nodes=pi.compile(this.spec.nodes,this),this.marks=cr.compile(this.spec.marks,this);let r=Object.create(null);for(let u in this.nodes){if(u in this.marks)throw new RangeError(u+" can not be both a node and a mark");let i=this.nodes[u],o=i.spec.content||"",s=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=mt.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=s=="_"?null:s?mi(this,s.split(" ")):s==""||!i.inlineContent?[]:null}for(let u in this.marks){let i=this.marks[u],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:mi(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,u){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof pi){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,u)}text(e,n){let r=this.nodes.text;return new Gn(r,r.defaultAttrs,e,v.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return ft.fromJSON(this,e)}markFromJSON(e){return v.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function mi(t,e){let n=[];for(let r=0;r<e.length;r++){let u=e[r],i=t.marks[u],o=i;if(i)n.push(i);else for(let s in t.marks){let l=t.marks[s];(u=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(u)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function ya(t){return t.tag!=null}function ka(t){return t.style!=null}class an{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(u=>{if(ya(u))this.tags.push(u);else if(ka(u)){let i=/[^=]*/.exec(u.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(u)}}),this.normalizeLists=!this.tags.some(u=>{if(!/^(ul|ol)\b/.test(u.tag)||!u.node)return!1;let i=e.nodes[u.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new bi(this,n,!1);return r.addAll(e,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new bi(this,n,!0);return r.addAll(e,n.from,n.to),k.maxOpen(r.finish())}matchTag(e,n,r){for(let u=r?this.tags.indexOf(r)+1:0;u<this.tags.length;u++){let i=this.tags[u];if(Da(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,n,r,u){for(let i=u?this.styles.indexOf(u)+1:0;i<this.styles.length;i++){let o=this.styles[i],s=o.style;if(!(s.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||s.length>e.length&&(s.charCodeAt(e.length)!=61||s.slice(e.length+1)!=n))){if(o.getAttrs){let l=o.getAttrs(n);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let n=[];function r(u){let i=u.priority==null?50:u.priority,o=0;for(;o<n.length;o++){let s=n[o];if((s.priority==null?50:s.priority)<i)break}n.splice(o,0,u)}for(let u in e.marks){let i=e.marks[u].spec.parseDOM;i&&i.forEach(o=>{r(o=xi(o)),o.mark||o.ignore||o.clearMark||(o.mark=u)})}for(let u in e.nodes){let i=e.nodes[u].spec.parseDOM;i&&i.forEach(o=>{r(o=xi(o)),o.node||o.ignore||o.mark||(o.node=u)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new an(e,an.schemaRules(e)))}}const ts={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ca={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ns={ol:!0,ul:!0},Zn=1,Qn=2,Yt=4;function gi(t,e,n){return e!=null?(e?Zn:0)|(e==="full"?Qn:0):t&&t.whitespace=="pre"?Zn|Qn:n&~Yt}class In{constructor(e,n,r,u,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.pendingMarks=u,this.solid=i,this.options=s,this.content=[],this.activeMarks=v.none,this.stashMarks=[],this.match=o||(s&Yt?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(b.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,u;return(u=r.findWrapping(e.type))?(this.match=r,u):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Zn)){let r=this.content[this.content.length-1],u;if(r&&r.isText&&(u=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==u[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-u[0].length))}}let n=b.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(b.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}popFromStashMark(e){for(let n=this.stashMarks.length-1;n>=0;n--)if(e.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]}applyPending(e){for(let n=0,r=this.pendingMarks;n<r.length;n++){let u=r[n];(this.type?this.type.allowsMarkType(u.type):_a(u.type,e))&&!u.isInSet(this.activeMarks)&&(this.activeMarks=u.addToSet(this.activeMarks),this.pendingMarks=u.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!ts.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class bi{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0;let u=n.topNode,i,o=gi(null,n.preserveWhitespace,0)|(r?Yt:0);u?i=new In(u.type,u.attrs,v.none,v.none,!0,n.topMatch||u.type.contentMatch,o):r?i=new In(null,null,v.none,v.none,!0,null,o):i=new In(e.schema.topNodeType,null,v.none,v.none,!0,null,o),this.nodes=[i],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,n){let r=e.style;if(!r||!r.length)return n();let u=this.readStyles(e.style);if(!u)return;let[i,o]=u,s=this.top;for(let l=0;l<o.length;l++)this.removePendingMark(o[l],s);for(let l=0;l<i.length;l++)this.addPendingMark(i[l]);n();for(let l=0;l<i.length;l++)this.removePendingMark(i[l],s);for(let l=0;l<o.length;l++)this.addPendingMark(o[l])}addTextNode(e){let n=e.nodeValue,r=this.top;if(r.options&Qn||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(r.options&Zn)r.options&Qn?n=n.replace(/\r\n?/g,`
`):n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let u=r.content[r.content.length-1],i=e.previousSibling;(!u||i&&i.nodeName=="BR"||u.isText&&/[ \t\r\n\u000c]$/.test(u.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(e)}else this.findInside(e)}addElement(e,n){let r=e.nodeName.toLowerCase(),u;ns.hasOwnProperty(r)&&this.parser.normalizeLists&&wa(e);let i=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(u=this.parser.matchTag(e,this,n));if(i?i.ignore:Ca.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(e=i.skip);let o,s=this.top,l=this.needsBlock;if(ts.hasOwnProperty(r))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),o=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}i&&i.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(s),this.needsBlock=l}else this.withStyleRules(e,()=>{this.addElementByRule(e,i,i.consuming===!1?u:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let n=v.none,r=v.none;if(e.length)for(let u=0;u<this.parser.matchedStyles.length;u++){let i=this.parser.matchedStyles[u],o=e.getPropertyValue(i);if(o)for(let s=void 0;;){let l=this.parser.matchStyle(i,o,this,s);if(!l)break;if(l.ignore)return null;if(l.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(a=>{l.clearMark(a)&&(r=a.addToSet(r))}):n=this.parser.schema.marks[l.mark].create(l.attrs).addToSet(n),l.consuming===!1)s=l;else break}}return[n,r]}addElementByRule(e,n,r){let u,i,o;n.node?(i=this.parser.schema.nodes[n.node],i.isLeaf?this.insertNode(i.create(n.attrs))||this.leafFallback(e):u=this.enter(i,n.attrs||null,n.preserveWhitespace)):(o=this.parser.schema.marks[n.mark].create(n.attrs),this.addPendingMark(o));let s=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l)}u&&this.sync(s)&&this.open--,o&&this.removePendingMark(o,s)}addAll(e,n,r){let u=n||0;for(let i=n?e.childNodes[n]:e.firstChild,o=r==null?null:e.childNodes[r];i!=o;i=i.nextSibling,++u)this.findAtPoint(e,u),this.addDOM(i);this.findAtPoint(e,u)}findPlace(e){let n,r;for(let u=this.open;u>=0;u--){let i=this.nodes[u],o=i.findWrapping(e);if(o&&(!n||n.length>o.length)&&(n=o,r=i,!o.length)||i.solid)break}if(!n)return!1;this.sync(r);for(let u=0;u<n.length;u++)this.enterInner(n[u],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(e)){this.closeExtra();let n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));let r=n.activeMarks;for(let u=0;u<e.marks.length;u++)(!n.type||n.type.allowsMarkType(e.marks[u].type))&&(r=e.marks[u].addToSet(r));return n.content.push(e.mark(r)),!0}return!1}enter(e,n,r){let u=this.findPlace(e.create(n));return u&&this.enterInner(e,n,!0,r),u}enterInner(e,n=null,r=!1,u){this.closeExtra();let i=this.top;i.applyPending(e),i.match=i.match&&i.match.matchType(e);let o=gi(e,u,i.options);i.options&Yt&&i.content.length==0&&(o|=Yt),this.nodes.push(new In(e,n,i.activeMarks,i.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let n=this.open;n>=0;n--)if(this.nodes[n]==e)return this.open=n,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let u=r.length-1;u>=0;u--)e+=r[u].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let u=0;u<this.find.length;u++)this.find[u].pos==null&&e.nodeType==1&&e.contains(this.find[u].node)&&n.compareDocumentPosition(this.find[u].node)&(r?2:4)&&(this.find[u].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,u=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(u?0:1),o=(s,l)=>{for(;s>=0;s--){let a=n[s];if(a==""){if(s==n.length-1||s==0)continue;for(;l>=i;l--)if(o(s-1,l))return!0;return!1}else{let c=l>0||l==0&&u?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!c||c.name!=a&&c.groups.indexOf(a)==-1)return!1;l--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let n=Ea(e,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,n){for(let r=this.open;r>=0;r--){let u=this.nodes[r];if(u.pendingMarks.lastIndexOf(e)>-1)u.pendingMarks=e.removeFromSet(u.pendingMarks);else{u.activeMarks=e.removeFromSet(u.activeMarks);let o=u.popFromStashMark(e);o&&u.type&&u.type.allowsMarkType(o.type)&&(u.activeMarks=o.addToSet(u.activeMarks))}if(u==n)break}}}function wa(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&ns.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function Da(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function xi(t){let e={};for(let n in t)e[n]=t[n];return e}function _a(t,e){let n=e.schema.nodes;for(let r in n){let u=n[r];if(!u.allowsMarkType(t))continue;let i=[],o=s=>{i.push(s);for(let l=0;l<s.edgeCount;l++){let{type:a,next:c}=s.edge(l);if(a==e||i.indexOf(c)<0&&o(c))return!0}};if(o(u.contentMatch))return!0}}function Ea(t,e){for(let n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}class Fe{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=wr(n).createDocumentFragment());let u=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let s=0,l=0;for(;s<i.length&&l<o.marks.length;){let a=o.marks[l];if(!this.marks[a.type.name]){l++;continue}if(!a.eq(i[s][0])||a.type.spec.spanning===!1)break;s++,l++}for(;s<i.length;)u=i.pop()[1];for(;l<o.marks.length;){let a=o.marks[l++],c=this.serializeMark(a,o.isInline,n);c&&(i.push([a,u]),u.appendChild(c.dom),u=c.contentDOM||c.dom)}}u.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:u}=Fe.renderSpec(wr(n),this.nodes[e.type.name](e));if(u){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,u)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let u=e.marks.length-1;u>=0;u--){let i=this.serializeMark(e.marks[u],e.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,n,r={}){let u=this.marks[e.type.name];return u&&Fe.renderSpec(wr(r),u(e,n))}static renderSpec(e,n,r=null){if(typeof n=="string")return{dom:e.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;let u=n[0],i=u.indexOf(" ");i>0&&(r=u.slice(0,i),u=u.slice(i+1));let o,s=r?e.createElementNS(r,u):e.createElement(u),l=n[1],a=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){a=2;for(let c in l)if(l[c]!=null){let f=c.indexOf(" ");f>0?s.setAttributeNS(c.slice(0,f),c.slice(f+1),l[c]):s.setAttribute(c,l[c])}}for(let c=a;c<n.length;c++){let f=n[c];if(f===0){if(c<n.length-1||c>a)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}else{let{dom:d,contentDOM:p}=Fe.renderSpec(e,f,r);if(s.appendChild(d),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:s,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Fe(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=yi(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return yi(e.marks)}}function yi(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function wr(t){return t.document||window.document}const rs=65535,us=Math.pow(2,16);function Sa(t,e){return t+e*us}function ki(t){return t&rs}function Aa(t){return(t-(t&rs))/us}const is=1,ss=2,$n=4,ls=8;class lu{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&ls)>0}get deletedBefore(){return(this.delInfo&(is|$n))>0}get deletedAfter(){return(this.delInfo&(ss|$n))>0}get deletedAcross(){return(this.delInfo&$n)>0}}class re{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&re.empty)return re.empty}recover(e){let n=0,r=ki(e);if(!this.inverted)for(let u=0;u<r;u++)n+=this.ranges[u*3+2]-this.ranges[u*3+1];return this.ranges[r*3]+n+Aa(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let u=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let l=this.ranges[s]-(this.inverted?u:0);if(l>e)break;let a=this.ranges[s+i],c=this.ranges[s+o],f=l+a;if(e<=f){let d=a?e==l?-1:e==f?1:n:n,p=l+u+(d<0?0:c);if(r)return p;let h=e==(n<0?l:f)?null:Sa(s/3,e-l),m=e==l?ss:e==f?is:$n;return(n<0?e!=l:e!=f)&&(m|=ls),new lu(p,m,h)}u+=c-a}return r?e+u:new lu(e+u,0,null)}touches(e,n){let r=0,u=ki(n),i=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let l=this.ranges[s]-(this.inverted?r:0);if(l>e)break;let a=this.ranges[s+i],c=l+a;if(e<=c&&s==u*3)return!0;r+=this.ranges[s+o]-a}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let u=0,i=0;u<this.ranges.length;u+=3){let o=this.ranges[u],s=o-(this.inverted?i:0),l=o+(this.inverted?0:i),a=this.ranges[u+n],c=this.ranges[u+r];e(s,s+a,l,l+c),i+=c-a}}invert(){return new re(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?re.empty:new re(e<0?[0,-e,0]:[0,0,e])}}re.empty=new re([]);class At{constructor(e=[],n,r=0,u=e.length){this.maps=e,this.mirror=n,this.from=r,this.to=u}slice(e=0,n=this.maps.length){return new At(this.maps,this.mirror,e,n)}copy(){return new At(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,n){this.to=this.maps.push(e),n!=null&&this.setMirror(this.maps.length-1,n)}appendMapping(e){for(let n=0,r=this.maps.length;n<e.maps.length;n++){let u=e.getMirror(n);this.appendMap(e.maps[n],u!=null&&u<n?r+u:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this.maps.length+e.maps.length;n>=0;n--){let u=e.getMirror(n);this.appendMap(e.maps[n].invert(),u!=null&&u>n?r-u-1:void 0)}}invert(){let e=new At;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let u=0;for(let i=this.from;i<this.to;i++){let o=this.maps[i],s=o.mapResult(e,n);if(s.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this.maps[l].recover(s.recover);continue}}u|=s.delInfo,e=s.pos}return r?e:new lu(e,u,null)}}const Dr=Object.create(null);class G{getMap(){return re.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Dr[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Dr)throw new RangeError("Duplicate use of step JSON ID "+e);return Dr[e]=n,n.prototype.jsonID=e,n}}class z{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new z(e,null)}static fail(e){return new z(null,e)}static fromReplace(e,n,r,u){try{return z.ok(e.replace(n,r,u))}catch(i){if(i instanceof Jn)return z.fail(i.message);throw i}}}function Iu(t,e,n){let r=[];for(let u=0;u<t.childCount;u++){let i=t.child(u);i.content.size&&(i=i.copy(Iu(i.content,e,i))),i.isInline&&(i=e(i,n,u)),r.push(i)}return b.fromArray(r)}class We extends G{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),u=r.node(r.sharedDepth(this.to)),i=new k(Iu(n.content,(o,s)=>!o.isAtom||!s.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),u),n.openStart,n.openEnd);return z.fromReplace(e,this.from,this.to,i)}invert(){return new ke(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new We(n.pos,r.pos,this.mark)}merge(e){return e instanceof We&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new We(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new We(n.from,n.to,e.markFromJSON(n.mark))}}G.jsonID("addMark",We);class ke extends G{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new k(Iu(n.content,u=>u.mark(this.mark.removeFromSet(u.marks)),e),n.openStart,n.openEnd);return z.fromReplace(e,this.from,this.to,r)}invert(){return new We(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new ke(n.pos,r.pos,this.mark)}merge(e){return e instanceof ke&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ke(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ke(n.from,n.to,e.markFromJSON(n.mark))}}G.jsonID("removeMark",ke);class je extends G{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return z.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return z.fromReplace(e,this.pos,this.pos+1,new k(b.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let u=0;u<n.marks.length;u++)if(!n.marks[u].isInSet(r))return new je(this.pos,n.marks[u]);return new je(this.pos,this.mark)}}return new Ft(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new je(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new je(n.pos,e.markFromJSON(n.mark))}}G.jsonID("addNodeMark",je);class Ft extends G{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return z.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return z.fromReplace(e,this.pos,this.pos+1,new k(b.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new je(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ft(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ft(n.pos,e.markFromJSON(n.mark))}}G.jsonID("removeNodeMark",Ft);class K extends G{constructor(e,n,r,u=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=u}apply(e){return this.structure&&au(e,this.from,this.to)?z.fail("Structure replace would overwrite content"):z.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new re([this.from,this.to-this.from,this.slice.size])}invert(e){return new K(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new K(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof K)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?k.empty:new k(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new K(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?k.empty:new k(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new K(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new K(n.from,n.to,k.fromJSON(e,n.slice),!!n.structure)}}G.jsonID("replace",K);class J extends G{constructor(e,n,r,u,i,o,s=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=u,this.slice=i,this.insert=o,this.structure=s}apply(e){if(this.structure&&(au(e,this.from,this.gapFrom)||au(e,this.gapTo,this.to)))return z.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return z.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?z.fromReplace(e,this.from,this.to,r):z.fail("Content does not fit in gap")}getMap(){return new re([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new J(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),u=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||u<n.pos||i>r.pos?null:new J(n.pos,r.pos,u,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new J(n.from,n.to,n.gapFrom,n.gapTo,k.fromJSON(e,n.slice),n.insert,!!n.structure)}}G.jsonID("replaceAround",J);function au(t,e,n){let r=t.resolve(e),u=n-e,i=r.depth;for(;u>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,u--;if(u>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;u>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,u--}}return!1}function Ma(t,e,n,r){let u=[],i=[],o,s;t.doc.nodesBetween(e,n,(l,a,c)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(a,e),p=Math.min(a+l.nodeSize,n),h=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(h)||(o&&o.to==d&&o.mark.eq(f[m])?o.to=p:u.push(o=new ke(d,p,f[m])));s&&s.to==d?s.to=p:i.push(s=new We(d,p,r))}}),u.forEach(l=>t.step(l)),i.forEach(l=>t.step(l))}function va(t,e,n,r){let u=[],i=0;t.doc.nodesBetween(e,n,(o,s)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof cr){let a=o.marks,c;for(;c=r.isInSet(a);)(l||(l=[])).push(c),a=c.removeFromSet(a)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let a=Math.min(s+o.nodeSize,n);for(let c=0;c<l.length;c++){let f=l[c],d;for(let p=0;p<u.length;p++){let h=u[p];h.step==i-1&&f.eq(u[p].style)&&(d=h)}d?(d.to=a,d.step=i):u.push({style:f,from:Math.max(s,e),to:a,step:i})}}}),u.forEach(o=>t.step(new ke(o.from,o.to,o.style)))}function as(t,e,n,r=n.contentMatch,u=!0){let i=t.doc.nodeAt(e),o=[],s=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),c=s+a.nodeSize,f=r.matchType(a.type);if(!f)o.push(new K(s,c,k.empty));else{r=f;for(let d=0;d<a.marks.length;d++)n.allowsMarkType(a.marks[d].type)||t.step(new ke(s,c,a.marks[d]));if(u&&a.isText&&n.whitespace!="pre"){let d,p=/\r?\n|\r/g,h;for(;d=p.exec(a.text);)h||(h=new k(b.from(n.schema.text(" ",n.allowedMarks(a.marks))),0,0)),o.push(new K(s+d.index,s+d.index+d[0].length,h))}}s=c}if(!r.validEnd){let l=r.fillBefore(b.empty,!0);t.replace(s,s,new k(l,0,0))}for(let l=o.length-1;l>=0;l--)t.step(o[l])}function Ta(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Dn(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let u=t.$from.node(r),i=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&u.canReplace(i,o,n))return r;if(r==0||u.type.spec.isolating||!Ta(u,i,o))break}return null}function Oa(t,e,n){let{$from:r,$to:u,depth:i}=e,o=r.before(i+1),s=u.after(i+1),l=o,a=s,c=b.empty,f=0;for(let h=i,m=!1;h>n;h--)m||r.index(h)>0?(m=!0,c=b.from(r.node(h).copy(c)),f++):l--;let d=b.empty,p=0;for(let h=i,m=!1;h>n;h--)m||u.after(h+1)<u.end(h)?(m=!0,d=b.from(u.node(h).copy(d)),p++):a++;t.step(new J(l,a,o,s,new k(c.append(d),f,p),c.size-f,!0))}function Ru(t,e,n=null,r=t){let u=Fa(t,e),i=u&&Na(r,e);return i?u.map(Ci).concat({type:e,attrs:n}).concat(i.map(Ci)):null}function Ci(t){return{type:t,attrs:null}}function Fa(t,e){let{parent:n,startIndex:r,endIndex:u}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return n.canReplaceWith(r,u,o)?i:null}function Na(t,e){let{parent:n,startIndex:r,endIndex:u}=t,i=n.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let a=r;l&&a<u;a++)l=l.matchType(n.child(a).type);return!l||!l.validEnd?null:o}function Ia(t,e,n){let r=b.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let s=n[o].type.contentMatch.matchFragment(r);if(!s||!s.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=b.from(n[o].type.create(n[o].attrs,r))}let u=e.start,i=e.end;t.step(new J(u,i,u,i,new k(r,0,0),n.length,!0))}function Ra(t,e,n,r,u){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(o,s)=>{if(o.isTextblock&&!o.hasMarkup(r,u)&&Pa(t.doc,t.mapping.slice(i).map(s),r)){let l=null;if(r.schema.linebreakReplacement){let d=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);d&&!p?l=!1:!d&&p&&(l=!0)}l===!1&&Ba(t,o,s,i),as(t,t.mapping.slice(i).map(s,1),r,void 0,l===null);let a=t.mapping.slice(i),c=a.map(s,1),f=a.map(s+o.nodeSize,1);return t.step(new J(c,f,c+1,f-1,new k(b.from(r.create(u,null,o.marks)),0,0),1,!0)),l===!0&&za(t,o,s,i),!1}})}function za(t,e,n,r){e.forEach((u,i)=>{if(u.isText){let o,s=/\r?\n|\r/g;for(;o=s.exec(u.text);){let l=t.mapping.slice(r).map(n+1+i+o.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function Ba(t,e,n,r){e.forEach((u,i)=>{if(u.type==u.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+i);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function Pa(t,e,n){let r=t.resolve(e),u=r.index();return r.parent.canReplaceWith(u,u+1,n)}function La(t,e,n,r,u){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let o=n.create(r,null,u||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,o);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new J(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new k(b.from(o),0,0),1,!0))}function Mt(t,e,n=1,r){let u=t.resolve(e),i=u.depth-n,o=r&&r[r.length-1]||u.parent;if(i<0||u.parent.type.spec.isolating||!u.parent.canReplace(u.index(),u.parent.childCount)||!o.type.validContent(u.parent.content.cutByIndex(u.index(),u.parent.childCount)))return!1;for(let a=u.depth-1,c=n-2;a>i;a--,c--){let f=u.node(a),d=u.index(a);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(d,f.childCount),h=r&&r[c+1];h&&(p=p.replaceChild(0,h.type.create(h.attrs)));let m=r&&r[c]||f;if(!f.canReplace(d+1,f.childCount)||!m.type.validContent(p))return!1}let s=u.indexAfter(i),l=r&&r[0];return u.node(i).canReplaceWith(s,s,l?l.type:u.node(i+1).type)}function qa(t,e,n=1,r){let u=t.doc.resolve(e),i=b.empty,o=b.empty;for(let s=u.depth,l=u.depth-n,a=n-1;s>l;s--,a--){i=b.from(u.node(s).copy(i));let c=r&&r[a];o=b.from(c?c.type.create(c.attrs,o):u.node(s).copy(o))}t.step(new K(e,e,new k(i.append(o),n,n),!0))}function Pt(t,e){let n=t.resolve(e),r=n.index();return cs(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function cs(t,e){return!!(t&&e&&!t.isLeaf&&t.canAppend(e))}function fs(t,e,n=-1){let r=t.resolve(e);for(let u=r.depth;;u--){let i,o,s=r.index(u);if(u==r.depth?(i=r.nodeBefore,o=r.nodeAfter):n>0?(i=r.node(u+1),s++,o=r.node(u).maybeChild(s)):(i=r.node(u).maybeChild(s-1),o=r.node(u+1)),i&&!i.isTextblock&&cs(i,o)&&r.node(u).canReplace(s,s+1))return e;if(u==0)break;e=n<0?r.before(u):r.after(u)}}function Va(t,e,n){let r=new K(e-n,e+n,k.empty,!0);t.step(r)}function $a(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let u=r.depth-1;u>=0;u--){let i=r.index(u);if(r.node(u).canReplaceWith(i,i,n))return r.before(u+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let u=r.depth-1;u>=0;u--){let i=r.indexAfter(u);if(r.node(u).canReplaceWith(i,i,n))return r.after(u+1);if(i<r.node(u).childCount)return null}return null}function ds(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let u=n.content;for(let i=0;i<n.openStart;i++)u=u.firstChild.content;for(let i=1;i<=(n.openStart==0&&n.size?2:1);i++)for(let o=r.depth;o>=0;o--){let s=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(s>0?1:0),a=r.node(o),c=!1;if(i==1)c=a.canReplace(l,l,u);else{let f=a.contentMatchAt(l).findWrapping(u.firstChild.type);c=f&&a.canReplaceWith(l,l,f[0])}if(c)return s==0?r.pos:s<0?r.before(o+1):r.after(o+1)}return null}function zu(t,e,n=e,r=k.empty){if(e==n&&!r.size)return null;let u=t.resolve(e),i=t.resolve(n);return hs(u,i,r)?new K(e,n,r):new Ha(u,i,r).fit()}function hs(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class Ha{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=b.empty;for(let u=0;u<=e.depth;u++){let i=e.node(u);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(u))})}for(let u=e.depth;u>0;u--)this.placed=b.from(e.node(u).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let a=this.findFittable();a?this.placeNodes(a):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,u=this.close(e<0?this.$to:r.doc.resolve(e));if(!u)return null;let i=this.placed,o=r.depth,s=u.depth;for(;o&&s&&i.childCount==1;)i=i.firstChild.content,o--,s--;let l=new k(i,o,s);return e>-1?new J(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new K(r.pos,u.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,u=this.unplaced.openEnd;r<e;r++){let i=n.firstChild;if(n.childCount>1&&(u=0),i.type.spec.isolating&&u<=r){e=r;break}n=i.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let u,i=null;r?(i=_r(this.unplaced.content,r-1).firstChild,u=i.content):u=this.unplaced.content;let o=u.firstChild;for(let s=this.depth;s>=0;s--){let{type:l,match:a}=this.frontier[s],c,f=null;if(n==1&&(o?a.matchType(o.type)||(f=a.fillBefore(b.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:s,parent:i,inject:f};if(n==2&&o&&(c=a.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:s,parent:i,wrap:c};if(i&&a.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,u=_r(e,n);return!u.childCount||u.firstChild.isLeaf?!1:(this.unplaced=new k(e,n+1,Math.max(r,u.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,u=_r(e,n);if(u.childCount<=1&&n>0){let i=e.size-n<=n+u.size;this.unplaced=new k(Ut(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new k(Ut(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:u,wrap:i}){for(;this.depth>n;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let o=this.unplaced,s=r?r.content:o.content,l=o.openStart-e,a=0,c=[],{match:f,type:d}=this.frontier[n];if(u){for(let m=0;m<u.childCount;m++)c.push(u.child(m));f=f.matchFragment(u)}let p=s.size+e-(o.content.size-o.openEnd);for(;a<s.childCount;){let m=s.child(a),g=f.matchType(m.type);if(!g)break;a++,(a>1||l==0||m.content.size)&&(f=g,c.push(ps(m.mark(d.allowedMarks(m.marks)),a==1?l:0,a==s.childCount?p:-1)))}let h=a==s.childCount;h||(p=-1),this.placed=Kt(this.placed,n,b.from(c)),this.frontier[n].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=s;m<p;m++){let x=g.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),g=x.content}this.unplaced=h?e==0?k.empty:new k(Ut(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new k(Ut(o.content,e,a),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Er(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,u=this.$to.after(r);for(;r>1&&u==this.$to.end(--r);)++u;return u}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:u}=this.frontier[n],i=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Er(e,n,u,r,i);if(o){for(let s=n-1;s>=0;s--){let{match:l,type:a}=this.frontier[s],c=Er(e,s,a,l,!0);if(!c||c.childCount)continue e}return{depth:n,fit:o,move:i?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Kt(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let u=e.node(r),i=u.type.contentMatch.fillBefore(u.content,!0,e.index(r));this.openFrontierNode(u.type,u.attrs,i)}return e}openFrontierNode(e,n=null,r){let u=this.frontier[this.depth];u.match=u.match.matchType(e),this.placed=Kt(this.placed,this.depth,b.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(b.empty,!0);n.childCount&&(this.placed=Kt(this.placed,this.frontier.length,n))}}function Ut(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Ut(t.firstChild.content,e-1,n)))}function Kt(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Kt(t.lastChild.content,e-1,n)))}function _r(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function ps(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,ps(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(b.empty,!0)))),t.copy(r)}function Er(t,e,n,r,u){let i=t.node(e),o=u?t.indexAfter(e):t.index(e);if(o==i.childCount&&!n.compatibleContent(i.type))return null;let s=r.fillBefore(i.content,!0,o);return s&&!Wa(n,i.content,o)?s:null}function Wa(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function ja(t){return t.spec.defining||t.spec.definingForContent}function Ja(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let u=t.doc.resolve(e),i=t.doc.resolve(n);if(hs(u,i,r))return t.step(new K(e,n,r));let o=gs(u,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let s=-(u.depth+1);o.unshift(s);for(let d=u.depth,p=u.pos-1;d>0;d--,p--){let h=u.node(d).type.spec;if(h.defining||h.definingAsContext||h.isolating)break;o.indexOf(d)>-1?s=d:u.before(d)==p&&o.splice(1,0,-d)}let l=o.indexOf(s),a=[],c=r.openStart;for(let d=r.content,p=0;;p++){let h=d.firstChild;if(a.push(h),p==r.openStart)break;d=h.content}for(let d=c-1;d>=0;d--){let p=a[d],h=ja(p.type);if(h&&!p.sameMarkup(u.node(Math.abs(s)-1)))c=d;else if(h||!p.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let p=(d+c+1)%(r.openStart+1),h=a[p];if(h)for(let m=0;m<o.length;m++){let g=o[(m+l)%o.length],x=!0;g<0&&(x=!1,g=-g);let y=u.node(g-1),w=u.index(g-1);if(y.canReplaceWith(w,w,h.type,h.marks))return t.replace(u.before(g),x?i.after(g):n,new k(ms(r.content,0,r.openStart,p),p,r.openEnd))}}let f=t.steps.length;for(let d=o.length-1;d>=0&&(t.replace(e,n,r),!(t.steps.length>f));d--){let p=o[d];p<0||(e=u.before(p),n=i.after(p))}}function ms(t,e,n,r,u){if(e<n){let i=t.firstChild;t=t.replaceChild(0,i.copy(ms(i.content,e+1,n,r,i)))}if(e>r){let i=u.contentMatchAt(0),o=i.fillBefore(t).append(t);t=o.append(i.matchFragment(o).fillBefore(b.empty,!0))}return t}function Ua(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let u=$a(t.doc,e,r.type);u!=null&&(e=n=u)}t.replaceRange(e,n,new k(b.from(r),0,0))}function Ka(t,e,n){let r=t.doc.resolve(e),u=t.doc.resolve(n),i=gs(r,u);for(let o=0;o<i.length;o++){let s=i[o],l=o==i.length-1;if(l&&s==0||r.node(s).type.contentMatch.validEnd)return t.delete(r.start(s),u.end(s));if(s>0&&(l||r.node(s-1).canReplace(r.index(s-1),u.indexAfter(s-1))))return t.delete(r.before(s),u.after(s))}for(let o=1;o<=r.depth&&o<=u.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&u.end(o)-n!=u.depth-o)return t.delete(r.before(o),n);t.delete(e,n)}function gs(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let u=r;u>=0;u--){let i=t.start(u);if(i<t.pos-(t.depth-u)||e.end(u)>e.pos+(e.depth-u)||t.node(u).type.spec.isolating||e.node(u).type.spec.isolating)break;(i==e.start(u)||u==t.depth&&u==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&u&&e.start(u-1)==i-1)&&n.push(u)}return n}class vt extends G{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return z.fail("No node at attribute step's position");let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let u=n.type.create(r,null,n.marks);return z.fromReplace(e,this.pos,this.pos+1,new k(b.from(u),0,n.isLeaf?0:1))}getMap(){return re.empty}invert(e){return new vt(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new vt(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new vt(n.pos,n.attr,n.value)}}G.jsonID("attr",vt);class cn extends G{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let u in e.attrs)n[u]=e.attrs[u];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return z.ok(r)}getMap(){return re.empty}invert(e){return new cn(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new cn(n.attr,n.value)}}G.jsonID("docAttr",cn);let Nt=class extends Error{};Nt=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Nt.prototype=Object.create(Error.prototype);Nt.prototype.constructor=Nt;Nt.prototype.name="TransformError";class Ga{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new At}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Nt(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=k.empty){let u=zu(this.doc,e,n,r);return u&&this.step(u),this}replaceWith(e,n,r){return this.replace(e,n,new k(b.from(r),0,0))}delete(e,n){return this.replace(e,n,k.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return Ja(this,e,n,r),this}replaceRangeWith(e,n,r){return Ua(this,e,n,r),this}deleteRange(e,n){return Ka(this,e,n),this}lift(e,n){return Oa(this,e,n),this}join(e,n=1){return Va(this,e,n),this}wrap(e,n){return Ia(this,e,n),this}setBlockType(e,n=e,r,u=null){return Ra(this,e,n,r,u),this}setNodeMarkup(e,n,r=null,u){return La(this,e,n,r,u),this}setNodeAttribute(e,n,r){return this.step(new vt(e,n,r)),this}setDocAttribute(e,n){return this.step(new cn(e,n)),this}addNodeMark(e,n){return this.step(new je(e,n)),this}removeNodeMark(e,n){if(!(n instanceof v)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new Ft(e,n)),this}split(e,n=1,r){return qa(this,e,n,r),this}addMark(e,n,r){return Ma(this,e,n,r),this}removeMark(e,n,r){return va(this,e,n,r),this}clearIncompatible(e,n,r){return as(this,e,n,r),this}}const Sr=Object.create(null);class M{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new Za(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=k.empty){let r=n.content.lastChild,u=null;for(let s=0;s<n.openEnd;s++)u=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:l,$to:a}=o[s],c=e.mapping.slice(i);e.replaceRange(c.map(l.pos),c.map(a.pos),s?k.empty:n),s==0&&_i(e,i,(r?r.isInline:u&&u.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,u=this.ranges;for(let i=0;i<u.length;i++){let{$from:o,$to:s}=u[i],l=e.mapping.slice(r),a=l.map(o.pos),c=l.map(s.pos);i?e.deleteRange(a,c):(e.replaceRangeWith(a,c,n),_i(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let u=e.parent.inlineContent?new T(e):_t(e.node(0),e.parent,e.pos,e.index(),n,r);if(u)return u;for(let i=e.depth-1;i>=0;i--){let o=n<0?_t(e.node(0),e.node(i),e.before(i+1),e.index(i),n,r):_t(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new ue(e.node(0))}static atStart(e){return _t(e,e,0,0,1)||new ue(e)}static atEnd(e){return _t(e,e,e.content.size,e.childCount,-1)||new ue(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Sr[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Sr)throw new RangeError("Duplicate use of selection JSON ID "+e);return Sr[e]=n,n.prototype.jsonID=e,n}getBookmark(){return T.between(this.$anchor,this.$head).getBookmark()}}M.prototype.visible=!0;class Za{constructor(e,n){this.$from=e,this.$to=n}}let wi=!1;function Di(t){!wi&&!t.parent.inlineContent&&(wi=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class T extends M{constructor(e,n=e){Di(e),Di(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return M.near(r);let u=e.resolve(n.map(this.anchor));return new T(u.parent.inlineContent?u:r,r)}replace(e,n=k.empty){if(super.replace(e,n),n==k.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof T&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new fr(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new T(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let u=e.resolve(n);return new this(u,r==n?u:e.resolve(r))}static between(e,n,r){let u=e.pos-n.pos;if((!r||u)&&(r=u>=0?1:-1),!n.parent.inlineContent){let i=M.findFrom(n,r,!0)||M.findFrom(n,-r,!0);if(i)n=i.$head;else return M.near(n,r)}return e.parent.inlineContent||(u==0?e=n:(e=(M.findFrom(e,-r,!0)||M.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=u<0&&(e=n))),new T(e,n)}}M.jsonID("text",T);class fr{constructor(e,n){this.anchor=e,this.head=n}map(e){return new fr(e.map(this.anchor),e.map(this.head))}resolve(e){return T.between(e.resolve(this.anchor),e.resolve(this.head))}}class E extends M{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:u}=n.mapResult(this.anchor),i=e.resolve(u);return r?M.near(i):new E(i)}content(){return new k(b.from(this.node),0,0)}eq(e){return e instanceof E&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Bu(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new E(e.resolve(n.anchor))}static create(e,n){return new E(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}E.prototype.visible=!1;M.jsonID("node",E);class Bu{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new fr(r,r):new Bu(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&E.isSelectable(r)?new E(n):M.near(n)}}class ue extends M{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=k.empty){if(n==k.empty){e.delete(0,e.doc.content.size);let r=M.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new ue(e)}map(e){return new ue(e)}eq(e){return e instanceof ue}getBookmark(){return Qa}}M.jsonID("all",ue);const Qa={map(){return this},resolve(t){return new ue(t)}};function _t(t,e,n,r,u,i=!1){if(e.inlineContent)return T.create(t,n);for(let o=r-(u>0?0:1);u>0?o<e.childCount:o>=0;o+=u){let s=e.child(o);if(s.isAtom){if(!i&&E.isSelectable(s))return E.create(t,n-(u<0?s.nodeSize:0))}else{let l=_t(t,s,n+u,u<0?s.childCount:0,u,i);if(l)return l}n+=s.nodeSize*u}return null}function _i(t,e,n){let r=t.steps.length-1;if(r<e)return;let u=t.steps[r];if(!(u instanceof K||u instanceof J))return;let i=t.mapping.maps[r],o;i.forEach((s,l,a,c)=>{o==null&&(o=c)}),t.setSelection(M.near(t.doc.resolve(o),n))}const Ei=1,Rn=2,Si=4;class Xa extends Ga{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Ei)&~Rn,this.storedMarks=null,this}get selectionSet(){return(this.updated&Ei)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Rn,this}ensureMarks(e){return v.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Rn)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Rn,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||v.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let u=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(u.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(n);i=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,u.text(e,i)),this.selection.empty||this.setSelection(M.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Si,this}get scrolledIntoView(){return(this.updated&Si)>0}}function Ai(t,e){return!e||!t?t:t.bind(e)}class Gt{constructor(e,n,r){this.name=e,this.init=Ai(n.init,r),this.apply=Ai(n.apply,r)}}const Ya=[new Gt("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Gt("selection",{init(t,e){return t.selection||M.atStart(e.doc)},apply(t){return t.selection}}),new Gt("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Gt("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Ar{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Ya.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Gt(r.key,r.spec.state,r))})}}class Je{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let u=this.config.plugins[r];if(u.spec.filterTransaction&&!u.spec.filterTransaction.call(u,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),u=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let s=this.config.plugins[o];if(s.spec.appendTransaction){let l=u?u[o].n:0,a=u?u[o].state:this,c=l<n.length&&s.spec.appendTransaction.call(s,l?n.slice(l):n,a,r);if(c&&r.filterTransaction(c,o)){if(c.setMeta("appendedTransaction",e),!u){u=[];for(let f=0;f<this.config.plugins.length;f++)u.push(f<o?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),i=!0}u&&(u[o]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Je(this.config),r=this.config.fields;for(let u=0;u<r.length;u++){let i=r[u];n[i.name]=i.apply(e,this[i.name],this,n)}return n}get tr(){return new Xa(this)}static create(e){let n=new Ar(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Je(n);for(let u=0;u<n.fields.length;u++)r[n.fields[u].name]=n.fields[u].init(e,r);return r}reconfigure(e){let n=new Ar(this.schema,e.plugins),r=n.fields,u=new Je(n);for(let i=0;i<r.length;i++){let o=r[i].name;u[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,u)}return u}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let u=e[r],i=u.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(u,this[u.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let u=new Ar(e.schema,e.plugins),i=new Je(u);return u.fields.forEach(o=>{if(o.name=="doc")i.doc=ft.fromJSON(e.schema,n.doc);else if(o.name=="selection")i.selection=M.fromJSON(i.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let s in r){let l=r[s],a=l.spec.state;if(l.key==o.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(n,s)){i[o.name]=a.fromJSON.call(l,e,n[s],i);return}}i[o.name]=o.init(e,i)}}),i}}function bs(t,e,n){for(let r in t){let u=t[r];u instanceof Function?u=u.bind(e):r=="handleDOMEvents"&&(u=bs(u,e,{})),n[r]=u}return n}class xt{constructor(e){this.spec=e,this.props={},e.props&&bs(e.props,this,this.props),this.key=e.key?e.key.key:xs("plugin")}getState(e){return e[this.key]}}const Mr=Object.create(null);function xs(t){return t in Mr?t+"$"+ ++Mr[t]:(Mr[t]=0,t+"$")}class ys{constructor(e="key"){this.key=xs(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const W=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},fn=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let cu=null;const Te=function(t,e,n){let r=cu||(cu=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},ec=function(){cu=null},gt=function(t,e,n,r){return n&&(Mi(t,e,n,r,-1)||Mi(t,e,n,r,1))},tc=/^(img|br|input|textarea|hr)$/i;function Mi(t,e,n,r,u){for(;;){if(t==n&&e==r)return!0;if(e==(u<0?0:ye(t))){let i=t.parentNode;if(!i||i.nodeType!=1||_n(t)||tc.test(t.nodeName)||t.contentEditable=="false")return!1;e=W(t)+(u<0?0:1),t=i}else if(t.nodeType==1){if(t=t.childNodes[e+(u<0?-1:0)],t.contentEditable=="false")return!1;e=u<0?ye(t):0}else return!1}}function ye(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function nc(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=ye(t)}else if(t.parentNode&&!_n(t))e=W(t),t=t.parentNode;else return null}}function rc(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!_n(t))e=W(t)+1,t=t.parentNode;else return null}}function uc(t,e,n){for(let r=e==0,u=e==ye(t);r||u;){if(t==n)return!0;let i=W(t);if(t=t.parentNode,!t)return!1;r=r&&i==0,u=u&&i==ye(t)}}function _n(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const dr=function(t){return t.focusNode&&gt(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function it(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function ic(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function oc(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:r.startOffset}}}const De=typeof navigator<"u"?navigator:null,vi=typeof document<"u"?document:null,tt=De&&De.userAgent||"",fu=/Edge\/(\d+)/.exec(tt),ks=/MSIE \d/.exec(tt),du=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(tt),te=!!(ks||du||fu),Ze=ks?document.documentMode:du?+du[1]:fu?+fu[1]:0,me=!te&&/gecko\/(\d+)/i.test(tt);me&&+(/Firefox\/(\d+)/.exec(tt)||[0,0])[1];const hu=!te&&/Chrome\/(\d+)/.exec(tt),Z=!!hu,sc=hu?+hu[1]:0,Q=!te&&!!De&&/Apple Computer/.test(De.vendor),It=Q&&(/Mobile\/\w+/.test(tt)||!!De&&De.maxTouchPoints>2),le=It||(De?/Mac/.test(De.platform):!1),lc=De?/Win/.test(De.platform):!1,he=/Android \d/.test(tt),En=!!vi&&"webkitFontSmoothing"in vi.documentElement.style,ac=En?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function cc(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Me(t,e){return typeof t=="number"?t:t[e]}function fc(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function Ti(t,e,n){let r=t.someProp("scrollThreshold")||0,u=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let o=n||t.dom;o;o=fn(o)){if(o.nodeType!=1)continue;let s=o,l=s==i.body,a=l?cc(i):fc(s),c=0,f=0;if(e.top<a.top+Me(r,"top")?f=-(a.top-e.top+Me(u,"top")):e.bottom>a.bottom-Me(r,"bottom")&&(f=e.bottom-e.top>a.bottom-a.top?e.top+Me(u,"top")-a.top:e.bottom-a.bottom+Me(u,"bottom")),e.left<a.left+Me(r,"left")?c=-(a.left-e.left+Me(u,"left")):e.right>a.right-Me(r,"right")&&(c=e.right-a.right+Me(u,"right")),c||f)if(l)i.defaultView.scrollBy(c,f);else{let d=s.scrollLeft,p=s.scrollTop;f&&(s.scrollTop+=f),c&&(s.scrollLeft+=c);let h=s.scrollLeft-d,m=s.scrollTop-p;e={left:e.left-h,top:e.top-m,right:e.right-h,bottom:e.bottom-m}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function dc(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,u;for(let i=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let s=t.root.elementFromPoint(i,o);if(!s||s==t.dom||!t.dom.contains(s))continue;let l=s.getBoundingClientRect();if(l.top>=n-20){r=s,u=l.top;break}}return{refDOM:r,refTop:u,stack:Cs(t.dom)}}function Cs(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=fn(r));return e}function hc({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;ws(n,r==0?0:r-e)}function ws(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:u,left:i}=t[n];r.scrollTop!=u+e&&(r.scrollTop=u+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let kt=null;function pc(t){if(t.setActive)return t.setActive();if(kt)return t.focus(kt);let e=Cs(t);t.focus(kt==null?{get preventScroll(){return kt={preventScroll:!0},!0}}:void 0),kt||(kt=!1,ws(e,0))}function Ds(t,e){let n,r=2e8,u,i=0,o=e.top,s=e.top,l,a;for(let c=t.firstChild,f=0;c;c=c.nextSibling,f++){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=Te(c).getClientRects();else continue;for(let p=0;p<d.length;p++){let h=d[p];if(h.top<=o&&h.bottom>=s){o=Math.max(h.bottom,o),s=Math.min(h.top,s);let m=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(m<r){n=c,r=m,u=m&&n.nodeType==3?{left:h.right<e.left?h.right:h.left,top:e.top}:e,c.nodeType==1&&m&&(i=f+(e.left>=(h.left+h.right)/2?1:0));continue}}else h.top>e.top&&!l&&h.left<=e.left&&h.right>=e.left&&(l=c,a={left:Math.max(h.left,Math.min(h.right,e.left)),top:h.top});!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(i=f+1)}}return!n&&l&&(n=l,u=a,r=0),n&&n.nodeType==3?mc(n,u):!n||r&&n.nodeType==1?{node:t,offset:i}:Ds(n,u)}function mc(t,e){let n=t.nodeValue.length,r=document.createRange();for(let u=0;u<n;u++){r.setEnd(t,u+1),r.setStart(t,u);let i=Be(r,1);if(i.top!=i.bottom&&Pu(e,i))return{node:t,offset:u+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}function Pu(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function gc(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function bc(t,e,n){let{node:r,offset:u}=Ds(e,n),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,u,i)}function xc(t,e,n,r){let u=-1;for(let i=e,o=!1;i!=t.dom;){let s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.dom.nodeType==1&&(s.node.isBlock&&s.parent||!s.contentDOM)){let l=s.dom.getBoundingClientRect();if(s.node.isBlock&&s.parent&&(!o&&l.left>r.left||l.top>r.top?u=s.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(u=s.posAfter),o=!0),!s.contentDOM&&u<0&&!s.node.isText)return(s.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?s.posBefore:s.posAfter}i=s.dom.parentNode}return u>-1?u:t.docView.posFromDOM(e,n,-1)}function _s(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let u=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=u;;){let o=t.childNodes[i];if(o.nodeType==1){let s=o.getClientRects();for(let l=0;l<s.length;l++){let a=s[l];if(Pu(e,a))return _s(o,e,a)}}if((i=(i+1)%r)==u)break}return t}function yc(t,e){let n=t.dom.ownerDocument,r,u=0,i=oc(n,e.left,e.top);i&&({node:r,offset:u}=i);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),s;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let a=t.dom.getBoundingClientRect();if(!Pu(e,a)||(o=_s(t.dom,e,a),!o))return null}if(Q)for(let a=o;r&&a;a=fn(a))a.draggable&&(r=void 0);if(o=gc(o,e),r){if(me&&r.nodeType==1&&(u=Math.min(u,r.childNodes.length),u<r.childNodes.length)){let c=r.childNodes[u],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&u++}let a;En&&u&&r.nodeType==1&&(a=r.childNodes[u-1]).nodeType==1&&a.contentEditable=="false"&&a.getBoundingClientRect().top>=e.top&&u--,r==t.dom&&u==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?s=t.state.doc.content.size:(u==0||r.nodeType!=1||r.childNodes[u-1].nodeName!="BR")&&(s=xc(t,r,u,e))}s==null&&(s=bc(t,o,e));let l=t.docView.nearestDesc(o,!0);return{pos:s,inside:l?l.posAtStart-l.border:-1}}function Oi(t){return t.top<t.bottom||t.left<t.right}function Be(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(Oi(r))return r}return Array.prototype.find.call(n,Oi)||t.getBoundingClientRect()}const kc=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Es(t,e,n){let{node:r,offset:u,atom:i}=t.docView.domFromPos(e,n<0?-1:1),o=En||me;if(r.nodeType==3)if(o&&(kc.test(r.nodeValue)||(n<0?!u:u==r.nodeValue.length))){let l=Be(Te(r,u,u),n);if(me&&u&&/\s/.test(r.nodeValue[u-1])&&u<r.nodeValue.length){let a=Be(Te(r,u-1,u-1),-1);if(a.top==l.top){let c=Be(Te(r,u,u+1),-1);if(c.top!=l.top)return Ht(c,c.left<a.left)}}return l}else{let l=u,a=u,c=n<0?1:-1;return n<0&&!u?(a++,c=-1):n>=0&&u==r.nodeValue.length?(l--,c=1):n<0?l--:a++,Ht(Be(Te(r,l,a),c),c<0)}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&u&&(n<0||u==ye(r))){let l=r.childNodes[u-1];if(l.nodeType==1)return vr(l.getBoundingClientRect(),!1)}if(i==null&&u<ye(r)){let l=r.childNodes[u];if(l.nodeType==1)return vr(l.getBoundingClientRect(),!0)}return vr(r.getBoundingClientRect(),n>=0)}if(i==null&&u&&(n<0||u==ye(r))){let l=r.childNodes[u-1],a=l.nodeType==3?Te(l,ye(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(a)return Ht(Be(a,1),!1)}if(i==null&&u<ye(r)){let l=r.childNodes[u];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let a=l?l.nodeType==3?Te(l,0,o?0:1):l.nodeType==1?l:null:null;if(a)return Ht(Be(a,-1),!0)}return Ht(Be(r.nodeType==3?Te(r):r,-n),n>=0)}function Ht(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function vr(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Ss(t,e,n){let r=t.state,u=t.root.activeElement;r!=e&&t.updateState(e),u!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),u!=t.dom&&u&&u.focus()}}function Cc(t,e,n){let r=e.selection,u=n=="up"?r.$from:r.$to;return Ss(t,e,()=>{let{node:i}=t.docView.domFromPos(u.pos,n=="up"?-1:1);for(;;){let s=t.docView.nearestDesc(i,!0);if(!s)break;if(s.node.isBlock){i=s.contentDOM||s.dom;break}i=s.dom.parentNode}let o=Es(t,u.pos,1);for(let s=i.firstChild;s;s=s.nextSibling){let l;if(s.nodeType==1)l=s.getClientRects();else if(s.nodeType==3)l=Te(s,0,s.nodeValue.length).getClientRects();else continue;for(let a=0;a<l.length;a++){let c=l[a];if(c.bottom>c.top+1&&(n=="up"?o.top-c.top>(c.bottom-o.top)*2:c.bottom-o.bottom>(o.bottom-c.top)*2))return!1}}return!0})}const wc=/[\u0590-\u08ac]/;function Dc(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let u=r.parentOffset,i=!u,o=u==r.parent.content.size,s=t.domSelection();return!wc.test(r.parent.textContent)||!s.modify?n=="left"||n=="backward"?i:o:Ss(t,e,()=>{let{focusNode:l,focusOffset:a,anchorNode:c,anchorOffset:f}=t.domSelectionRange(),d=s.caretBidiLevel;s.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:h,focusOffset:m}=t.domSelectionRange(),g=h&&!p.contains(h.nodeType==1?h:h.parentNode)||l==h&&a==m;try{s.collapse(c,f),l&&(l!=c||a!=f)&&s.extend&&s.extend(l,a)}catch{}return d!=null&&(s.caretBidiLevel=d),g})}let Fi=null,Ni=null,Ii=!1;function _c(t,e,n){return Fi==e&&Ni==n?Ii:(Fi=e,Ni=n,Ii=n=="up"||n=="down"?Cc(t,e,n):Dc(t,e,n))}const fe=0,Ri=1,ot=2,_e=3;class Sn{constructor(e,n,r,u){this.parent=e,this.children=n,this.dom=r,this.contentDOM=u,this.dirty=fe,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let u=this.children[n];if(u==e)return r;r+=u.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let u;if(e==this.dom&&this.contentDOM)u=n>W(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))u=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let i=e;;i=i.parentNode){if(i==this.dom){u=!1;break}if(i.previousSibling)break}if(u==null&&n==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){u=!0;break}if(i.nextSibling)break}}return u??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,u=e;u;u=u.parentNode){let i=this.getDesc(u),o;if(i&&(!n||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let u=e;u;u=u.parentNode){let i=this.getDesc(u);if(i)return i.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let u=this.children[n],i=r+u.size;if(r==e&&i!=r){for(;!u.border&&u.children.length;)u=u.children[0];return u}if(e<i)return u.descAt(e-r-u.border);r=i}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,u=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],s=i+o.size;if(s>e||o instanceof Ms){u=e-i;break}i=s}if(u)return this.children[r].domFromPos(u-this.children[r].border,n);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof As&&i.side>=0;r--);if(n<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&n&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,n):{node:this.contentDOM,offset:i?W(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,n):{node:this.contentDOM,offset:i?W(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let u=-1,i=-1;for(let o=r,s=0;;s++){let l=this.children[s],a=o+l.size;if(u==-1&&e<=a){let c=o+l.border;if(e>=c&&n<=a-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,c);e=o;for(let f=s;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){u=W(d.dom)+1;break}e-=d.size}u==-1&&(u=0)}if(u>-1&&(a>n||s==this.children.length-1)){n=a;for(let c=s+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){i=W(f.dom);break}n+=f.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=a}return{node:this.contentDOM,from:e,to:n,fromOffset:u,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,u=!1){let i=Math.min(e,n),o=Math.max(e,n);for(let d=0,p=0;d<this.children.length;d++){let h=this.children[d],m=p+h.size;if(i>p&&o<m)return h.setSelection(e-p-h.border,n-p-h.border,r,u);p=m}let s=this.domFromPos(e,e?-1:1),l=n==e?s:this.domFromPos(n,n?-1:1),a=r.getSelection(),c=!1;if((me||Q)&&e==n){let{node:d,offset:p}=s;if(d.nodeType==3){if(c=!!(p&&d.nodeValue[p-1]==`
`),c&&p==d.nodeValue.length)for(let h=d,m;h;h=h.parentNode){if(m=h.nextSibling){m.nodeName=="BR"&&(s=l={node:m.parentNode,offset:W(m)+1});break}let g=h.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let h=d.childNodes[p-1];c=h&&(h.nodeName=="BR"||h.contentEditable=="false")}}if(me&&a.focusNode&&a.focusNode!=l.node&&a.focusNode.nodeType==1){let d=a.focusNode.childNodes[a.focusOffset];d&&d.contentEditable=="false"&&(u=!0)}if(!(u||c&&Q)&&gt(s.node,s.offset,a.anchorNode,a.anchorOffset)&&gt(l.node,l.offset,a.focusNode,a.focusOffset))return;let f=!1;if((a.extend||e==n)&&!c){a.collapse(s.node,s.offset);try{e!=n&&a.extend(l.node,l.offset),f=!0}catch{}}if(!f){if(e>n){let p=s;s=l,l=p}let d=document.createRange();d.setEnd(l.node,l.offset),d.setStart(s.node,s.offset),a.removeAllRanges(),a.addRange(d)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,u=0;u<this.children.length;u++){let i=this.children[u],o=r+i.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let s=r+i.border,l=o-i.border;if(e>=s&&n<=l){this.dirty=e==r||n==o?ot:Ri,e==s&&n==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=_e:i.markDirty(e-s,n-s);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?ot:_e}r=o}this.dirty=ot}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?ot:Ri;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class As extends Sn{constructor(e,n,r,u){let i,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return u;if(i.parent)return i.parent.posBeforeChild(i)})),!n.type.spec.raw){if(o.nodeType!=1){let s=document.createElement("span");s.appendChild(o),o=s}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,i=this}matchesWidget(e){return this.dirty==fe&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Ec extends Sn{constructor(e,n,r,u){super(e,[],n,null),this.textDOM=r,this.text=u}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class bt extends Sn{constructor(e,n,r,u){super(e,[],r,u),this.mark=n}static create(e,n,r,u){let i=u.nodeViews[n.type.name],o=i&&i(n,u,r);return(!o||!o.dom)&&(o=Fe.renderSpec(document,n.type.spec.toDOM(n,r))),new bt(e,n,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&_e||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=_e&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=fe){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=fe}}slice(e,n,r){let u=bt.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;n<o&&(i=gu(i,n,o,r)),e>0&&(i=gu(i,0,e,r));for(let s=0;s<i.length;s++)i[s].parent=u;return u.children=i,u}}class Qe extends Sn{constructor(e,n,r,u,i,o,s,l,a){super(e,[],i,o),this.node=n,this.outerDeco=r,this.innerDeco=u,this.nodeDOM=s}static create(e,n,r,u,i,o){let s=i.nodeViews[n.type.name],l,a=s&&s(n,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,u),c=a&&a.dom,f=a&&a.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Fe.renderSpec(document,n.type.spec.toDOM(n)));!f&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let d=c;return c=Os(c,r,n),a?l=new Sc(e,n,r,u,c,f||null,d,a,i,o+1):n.isText?new hr(e,n,r,u,c,d,i):new Qe(e,n,r,u,c,f||null,d,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>b.empty)}return e}matchesNode(e,n,r){return this.dirty==fe&&e.eq(this.node)&&mu(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,u=n,i=e.composing?this.localCompositionInfo(e,n):null,o=i&&i.pos>-1?i:null,s=i&&i.pos<0,l=new Mc(this,o&&o.node,e);Oc(this.node,this.innerDeco,(a,c,f)=>{a.spec.marks?l.syncToMarks(a.spec.marks,r,e):a.type.side>=0&&!f&&l.syncToMarks(c==this.node.childCount?v.none:this.node.child(c).marks,r,e),l.placeWidget(a,e,u)},(a,c,f,d)=>{l.syncToMarks(a.marks,r,e);let p;l.findNodeMatch(a,c,f,d)||s&&e.state.selection.from>u&&e.state.selection.to<u+a.nodeSize&&(p=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(a,c,f,p,e)||l.updateNextNode(a,c,f,e,d,u)||l.addNode(a,c,f,e,u),u+=a.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==ot)&&(o&&this.protectLocalComposition(e,o),vs(this.contentDOM,this.children,e),It&&Fc(this.dom))}localCompositionInfo(e,n){let{from:r,to:u}=e.state.selection;if(!(e.state.selection instanceof T)||r<n||u>n+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,s=Nc(this.node.content,o,r-n,u-n);return s<0?null:{node:i,pos:s,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:u}){if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new Ec(this,i,n,u);e.input.compositionNodes.push(o),this.children=gu(this.children,r,r+u.length,e,o)}update(e,n,r,u){return this.dirty==_e||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,u),!0)}updateInner(e,n,r,u){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(u,this.posAtStart),this.dirty=fe}updateOuterDeco(e){if(mu(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Ts(this.dom,this.nodeDOM,pu(this.outerDeco,this.node,n),pu(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function zi(t,e,n,r,u){Os(r,e,t);let i=new Qe(void 0,t,e,n,r,r,r,u,0);return i.contentDOM&&i.updateChildren(u,0),i}class hr extends Qe{constructor(e,n,r,u,i,o,s){super(e,n,r,u,i,null,o,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,u){return this.dirty==_e||this.dirty!=fe&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=fe||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,u.trackWrites==this.nodeDOM&&(u.trackWrites=null)),this.node=e,this.dirty=fe,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let u=this.node.cut(e,n),i=document.createTextNode(u.text);return new hr(this.parent,u,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=_e)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Ms extends Sn{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==fe&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Sc extends Qe{constructor(e,n,r,u,i,o,s,l,a,c){super(e,n,r,u,i,o,s,a,c),this.spec=l}update(e,n,r,u){if(this.dirty==_e)return!1;if(this.spec.update){let i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,u),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,u)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,u){this.spec.setSelection?this.spec.setSelection(e,n,r):super.setSelection(e,n,r,u)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function vs(t,e,n){let r=t.firstChild,u=!1;for(let i=0;i<e.length;i++){let o=e[i],s=o.dom;if(s.parentNode==t){for(;s!=r;)r=Bi(r),u=!0;r=r.nextSibling}else u=!0,t.insertBefore(s,r);if(o instanceof bt){let l=r?r.previousSibling:t.lastChild;vs(o.contentDOM,o.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=Bi(r),u=!0;u&&n.trackWrites==t&&(n.trackWrites=null)}const en=function(t){t&&(this.nodeName=t)};en.prototype=Object.create(null);const st=[new en];function pu(t,e,n){if(t.length==0)return st;let r=n?st[0]:new en,u=[r];for(let i=0;i<t.length;i++){let o=t[i].type.attrs;if(o){o.nodeName&&u.push(r=new en(o.nodeName));for(let s in o){let l=o[s];l!=null&&(n&&u.length==1&&u.push(r=new en(e.isInline?"span":"div")),s=="class"?r.class=(r.class?r.class+" ":"")+l:s=="style"?r.style=(r.style?r.style+";":"")+l:s!="nodeName"&&(r[s]=l))}}}return u}function Ts(t,e,n,r){if(n==st&&r==st)return e;let u=e;for(let i=0;i<r.length;i++){let o=r[i],s=n[i];if(i){let l;s&&s.nodeName==o.nodeName&&u!=t&&(l=u.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(u),s=st[0]),u=l}Ac(u,s||st[0],o)}return u}function Ac(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],u=n.class?n.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)u.indexOf(r[i])==-1&&t.classList.remove(r[i]);for(let i=0;i<u.length;i++)r.indexOf(u[i])==-1&&t.classList.add(u[i]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,u;for(;u=r.exec(e.style);)t.style.removeProperty(u[1])}n.style&&(t.style.cssText+=n.style)}}function Os(t,e,n){return Ts(t,t,st,pu(e,n,t.nodeType!=1))}function mu(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Bi(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Mc{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=vc(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let u=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;u<o&&(u==i-1?this.top:this.stack[u+1<<1]).matchesMark(e[u])&&e[u].type.spec.spanning!==!1;)u++;for(;u<i;)this.destroyRest(),this.top.dirty=fe,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let s=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let a=this.top.children[l];if(a.matchesMark(e[i])&&!this.isLocked(a.dom)){s=l;break}}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{let l=bt.create(this.top,e[i],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,n,r,u){let i=-1,o;if(u>=this.preMatch.index&&(o=this.preMatch.matches[u-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))i=this.top.children.indexOf(o,this.index);else for(let s=this.index,l=Math.min(this.top.children.length,s+5);s<l;s++){let a=this.top.children[s];if(a.matchesNode(e,n,r)&&!this.preMatch.matched.has(a)){i=s;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,n,r,u,i){let o=this.top.children[u];return o.dirty==_e&&o.dom==o.contentDOM&&(o.dirty=ot),o.update(e,n,r,i)?(this.destroyBetween(this.index,u),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let u=this.index;u<this.top.children.length;u++)if(this.top.children[u]==r)return u}return-1}e=n}}updateNextNode(e,n,r,u,i,o){for(let s=this.index;s<this.top.children.length;s++){let l=this.top.children[s];if(l instanceof Qe){let a=this.preMatch.matched.get(l);if(a!=null&&a!=i)return!1;let c=l.dom,f,d=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=_e&&mu(n,l.outerDeco));if(!d&&l.update(e,n,r,u))return this.destroyBetween(this.index,s),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(l,e,n,r,u,o)))return this.top.children[this.index]=f,f.contentDOM&&(f.dirty=ot,f.updateChildren(u,o+1),f.dirty=fe),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,u,i,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content))return null;let s=Qe.create(this.top,n,r,u,i,o);if(s.contentDOM){s.children=e.children,e.children=[];for(let l of s.children)l.parent=s}return e.destroy(),s}addNode(e,n,r,u,i){let o=Qe.create(this.top,e,n,r,u,i);o.contentDOM&&o.updateChildren(u,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let u=this.index<this.top.children.length?this.top.children[this.index]:null;if(u&&u.matchesWidget(e)&&(e==u.widget||!u.widget.type.toDOM.parentNode))this.index++;else{let i=new As(this.top,e,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof bt;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof hr)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Q||Z)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let u=new Ms(this.top,[],r,null);n!=this.top?n.children.push(u):n.children.splice(this.index++,0,u),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function vc(t,e){let n=e,r=n.children.length,u=t.childCount,i=new Map,o=[];e:for(;u>0;){let s;for(;;)if(r){let a=n.children[r-1];if(a instanceof bt)n=a,r=a.children.length;else{s=a,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=s.node;if(l){if(l!=t.child(u-1))break;--u,i.set(s,u),o.push(s)}}return{index:u,matched:i,matches:o.reverse()}}function Tc(t,e){return t.type.side-e.type.side}function Oc(t,e,n,r){let u=e.locals(t),i=0;if(u.length==0){for(let a=0;a<t.childCount;a++){let c=t.child(a);r(c,u,e.forChild(i,c),a),i+=c.nodeSize}return}let o=0,s=[],l=null;for(let a=0;;){let c,f;for(;o<u.length&&u[o].to==i;){let g=u[o++];g.widget&&(c?(f||(f=[c])).push(g):c=g)}if(c)if(f){f.sort(Tc);for(let g=0;g<f.length;g++)n(f[g],a,!!l)}else n(c,a,!!l);let d,p;if(l)p=-1,d=l,l=null;else if(a<t.childCount)p=a,d=t.child(a++);else break;for(let g=0;g<s.length;g++)s[g].to<=i&&s.splice(g--,1);for(;o<u.length&&u[o].from<=i&&u[o].to>i;)s.push(u[o++]);let h=i+d.nodeSize;if(d.isText){let g=h;o<u.length&&u[o].from<g&&(g=u[o].from);for(let x=0;x<s.length;x++)s[x].to<g&&(g=s[x].to);g<h&&(l=d.cut(g-i),d=d.cut(0,g-i),h=g,p=-1)}else for(;o<u.length&&u[o].to<h;)o++;let m=d.isInline&&!d.isLeaf?s.filter(g=>!g.inline):s.slice();r(d,m,e.forChild(i,d),p),i=h}}function Fc(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function Nc(t,e,n,r){for(let u=0,i=0;u<t.childCount&&i<=r;){let o=t.child(u++),s=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;u<t.childCount;){let a=t.child(u++);if(i+=a.nodeSize,!a.isText)break;l+=a.text}if(i>=n){if(i>=r&&l.slice(r-e.length-s,r-s)==e)return r-e.length;let a=s<r?l.lastIndexOf(e,r-s-1):-1;if(a>=0&&a+e.length+s>=n)return s+a;if(n==r&&l.length>=r+e.length-s&&l.slice(r-s,r-s+e.length)==e)return r}}return-1}function gu(t,e,n,r,u){let i=[];for(let o=0,s=0;o<t.length;o++){let l=t[o],a=s,c=s+=l.size;a>=n||c<=e?i.push(l):(a<e&&i.push(l.slice(0,e-a,r)),u&&(i.push(u),u=void 0),c>n&&i.push(l.slice(n-a,l.size,r)))}return i}function Lu(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let u=t.docView.nearestDesc(n.focusNode),i=u&&u.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let s=r.resolve(o),l,a;if(dr(n)){for(l=s;u&&!u.node;)u=u.parent;let c=u.node;if(u&&c.isAtom&&E.isSelectable(c)&&u.parent&&!(c.isInline&&uc(n.focusNode,n.focusOffset,u.dom))){let f=u.posBefore;a=new E(o==f?s:r.resolve(f))}}else{let c=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(c<0)return null;l=r.resolve(c)}if(!a){let c=e=="pointer"||t.state.selection.head<s.pos&&!i?1:-1;a=qu(t,l,s,c)}return a}function Fs(t){return t.editable?t.hasFocus():Is(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Ne(t,e=!1){let n=t.state.selection;if(Ns(t,n),!!Fs(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Z){let r=t.domSelectionRange(),u=t.domObserver.currentSelection;if(r.anchorNode&&u.anchorNode&&gt(r.anchorNode,r.anchorOffset,u.anchorNode,u.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Rc(t);else{let{anchor:r,head:u}=n,i,o;Pi&&!(n instanceof T)&&(n.$from.parent.inlineContent||(i=Li(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=Li(t,n.to))),t.docView.setSelection(r,u,t.root,e),Pi&&(i&&qi(i),o&&qi(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Ic(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Pi=Q||Z&&sc<63;function Li(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),u=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(Q&&u&&u.contentEditable=="false")return Tr(u);if((!u||u.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(u)return Tr(u);if(i)return Tr(i)}}function Tr(t){return t.contentEditable="true",Q&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function qi(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Ic(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,u=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=u)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Fs(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Rc(t){let e=t.domSelection(),n=document.createRange(),r=t.cursorWrapper.dom,u=r.nodeName=="IMG";u?n.setEnd(r.parentNode,W(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!u&&!t.state.selection.visible&&te&&Ze<=11&&(r.disabled=!0,r.disabled=!1)}function Ns(t,e){if(e instanceof E){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Vi(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Vi(t)}function Vi(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function qu(t,e,n,r){return t.someProp("createSelectionBetween",u=>u(t,e,n))||T.between(e,n,r)}function $i(t){return t.editable&&!t.hasFocus()?!1:Is(t)}function Is(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function zc(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return gt(e.node,e.offset,n.anchorNode,n.anchorOffset)}function bu(t,e){let{$anchor:n,$head:r}=t.selection,u=e>0?n.max(r):n.min(r),i=u.parent.inlineContent?u.depth?t.doc.resolve(e>0?u.after():u.before()):null:u;return i&&M.findFrom(i,e)}function Pe(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Hi(t,e,n){let r=t.state.selection;if(r instanceof T)if(n.indexOf("s")>-1){let{$head:u}=r,i=u.textOffset?null:e<0?u.nodeBefore:u.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=t.state.doc.resolve(u.pos+i.nodeSize*(e<0?-1:1));return Pe(t,new T(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let u=bu(t.state,e);return u&&u instanceof E?Pe(t,u):!1}else if(!(le&&n.indexOf("m")>-1)){let u=r.$head,i=u.textOffset?null:e<0?u.nodeBefore:u.nodeAfter,o;if(!i||i.isText)return!1;let s=e<0?u.pos-i.nodeSize:u.pos;return i.isAtom||(o=t.docView.descAt(s))&&!o.contentDOM?E.isSelectable(i)?Pe(t,new E(e<0?t.state.doc.resolve(u.pos-i.nodeSize):u)):En?Pe(t,new T(t.state.doc.resolve(e<0?s:s+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof E&&r.node.isInline)return Pe(t,new T(e>0?r.$to:r.$from));{let u=bu(t.state,e);return u?Pe(t,u):!1}}}function Xn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function tn(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ct(t,e){return e<0?Bc(t):Pc(t)}function Bc(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let u,i,o=!1;for(me&&n.nodeType==1&&r<Xn(n)&&tn(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let s=n.childNodes[r-1];if(tn(s,-1))u=n,i=--r;else if(s.nodeType==3)n=s,r=n.nodeValue.length;else break}}else{if(Rs(n))break;{let s=n.previousSibling;for(;s&&tn(s,-1);)u=n.parentNode,i=W(s),s=s.previousSibling;if(s)n=s,r=Xn(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?xu(t,n,r):u&&xu(t,u,i)}function Pc(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let u=Xn(n),i,o;for(;;)if(r<u){if(n.nodeType!=1)break;let s=n.childNodes[r];if(tn(s,1))i=n,o=++r;else break}else{if(Rs(n))break;{let s=n.nextSibling;for(;s&&tn(s,1);)i=s.parentNode,o=W(s)+1,s=s.nextSibling;if(s)n=s,r=0,u=Xn(n);else{if(n=n.parentNode,n==t.dom)break;r=u=0}}}i&&xu(t,i,o)}function Rs(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Lc(t,e){for(;t&&e==t.childNodes.length&&!_n(t);)e=W(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function qc(t,e){for(;t&&!e&&!_n(t);)e=W(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function xu(t,e,n){if(e.nodeType!=3){let i,o;(o=Lc(e,n))?(e=o,n=0):(i=qc(e,n))&&(e=i,n=i.nodeValue.length)}let r=t.domSelection();if(dr(r)){let i=document.createRange();i.setEnd(e,n),i.setStart(e,n),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:u}=t;setTimeout(()=>{t.state==u&&Ne(t)},50)}function Wi(t,e){let n=t.state.doc.resolve(e);if(!(Z||lc)&&n.parent.inlineContent){let u=t.coordsAtPos(e);if(e>n.start()){let i=t.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>u.top&&o<u.bottom&&Math.abs(i.left-u.left)>1)return i.left<u.left?"ltr":"rtl"}if(e<n.end()){let i=t.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>u.top&&o<u.bottom&&Math.abs(i.left-u.left)>1)return i.left>u.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function ji(t,e,n){let r=t.state.selection;if(r instanceof T&&!r.empty||n.indexOf("s")>-1||le&&n.indexOf("m")>-1)return!1;let{$from:u,$to:i}=r;if(!u.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=bu(t.state,e);if(o&&o instanceof E)return Pe(t,o)}if(!u.parent.inlineContent){let o=e<0?u:i,s=r instanceof ue?M.near(o,e):M.findFrom(o,e);return s?Pe(t,s):!1}return!1}function Ji(t,e){if(!(t.state.selection instanceof T))return!0;let{$head:n,$anchor:r,empty:u}=t.state.selection;if(!n.sameParent(r))return!0;if(!u)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let o=t.state.tr;return e<0?o.delete(n.pos-i.nodeSize,n.pos):o.delete(n.pos,n.pos+i.nodeSize),t.dispatch(o),!0}return!1}function Ui(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Vc(t){if(!Q||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Ui(t,r,"true"),setTimeout(()=>Ui(t,r,"false"),20)}return!1}function $c(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Hc(t,e){let n=e.keyCode,r=$c(e);if(n==8||le&&n==72&&r=="c")return Ji(t,-1)||Ct(t,-1);if(n==46&&!e.shiftKey||le&&n==68&&r=="c")return Ji(t,1)||Ct(t,1);if(n==13||n==27)return!0;if(n==37||le&&n==66&&r=="c"){let u=n==37?Wi(t,t.state.selection.from)=="ltr"?-1:1:-1;return Hi(t,u,r)||Ct(t,u)}else if(n==39||le&&n==70&&r=="c"){let u=n==39?Wi(t,t.state.selection.from)=="ltr"?1:-1:1;return Hi(t,u,r)||Ct(t,u)}else{if(n==38||le&&n==80&&r=="c")return ji(t,-1,r)||Ct(t,-1);if(n==40||le&&n==78&&r=="c")return Vc(t)||ji(t,1,r)||Ct(t,1);if(r==(le?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function zs(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:u,openEnd:i}=e;for(;u>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){u--,i--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let o=t.someProp("clipboardSerializer")||Fe.fromSchema(t.state.schema),s=$s(),l=s.createElement("div");l.appendChild(o.serializeFragment(r,{document:s}));let a=l.firstChild,c,f=0;for(;a&&a.nodeType==1&&(c=Vs[a.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let h=s.createElement(c[p]);for(;l.firstChild;)h.appendChild(l.firstChild);l.appendChild(h),f++}a=l.firstChild}a&&a.nodeType==1&&a.setAttribute("data-pm-slice",`${u} ${i}${f?` -${f}`:""} ${JSON.stringify(n)}`);let d=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:d,slice:e}}function Bs(t,e,n,r,u){let i=u.parent.type.spec.code,o,s;if(!n&&!e)return null;let l=e&&(r||i||!n);if(l){if(t.someProp("transformPastedText",d=>{e=d(e,i||r,t)}),i)return e?new k(b.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):k.empty;let f=t.someProp("clipboardTextParser",d=>d(e,u,r,t));if(f)s=f;else{let d=u.marks(),{schema:p}=t.state,h=Fe.fromSchema(p);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=o.appendChild(document.createElement("p"));m&&g.appendChild(h.serializeNode(p.text(m,d)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),o=Jc(n),En&&Uc(o);let a=o&&o.querySelector("[data-pm-slice]"),c=a&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(a.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let d=o.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;o=d}if(s||(s=(t.someProp("clipboardParser")||t.someProp("domParser")||an.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||c),context:u,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!Wc.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)s=Kc(Ki(s,+c[1],+c[2]),c[4]);else if(s=k.maxOpen(jc(s.content,u),!0),s.openStart||s.openEnd){let f=0,d=0;for(let p=s.content.firstChild;f<s.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=s.content.lastChild;d<s.openEnd&&!p.type.spec.isolating;d++,p=p.lastChild);s=Ki(s,f,d)}return t.someProp("transformPasted",f=>{s=f(s,t)}),s}const Wc=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function jc(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let u=e.node(n).contentMatchAt(e.index(n)),i,o=[];if(t.forEach(s=>{if(!o)return;let l=u.findWrapping(s.type),a;if(!l)return o=null;if(a=o.length&&i.length&&Ls(l,i,s,o[o.length-1],0))o[o.length-1]=a;else{o.length&&(o[o.length-1]=qs(o[o.length-1],i.length));let c=Ps(s,l);o.push(c),u=u.matchType(c.type),i=l}}),o)return b.from(o)}return t}function Ps(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,b.from(t));return t}function Ls(t,e,n,r,u){if(u<t.length&&u<e.length&&t[u]==e[u]){let i=Ls(t,e,n,r.lastChild,u+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(u==t.length-1?n.type:t[u+1]))return r.copy(r.content.append(b.from(Ps(n,t,u+1))))}}function qs(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,qs(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(b.empty,!0);return t.copy(n.append(r))}function yu(t,e,n,r,u,i){let o=e<0?t.firstChild:t.lastChild,s=o.content;return t.childCount>1&&(i=0),u<r-1&&(s=yu(s,e,n,r,u+1,i)),u>=n&&(s=e<0?o.contentMatchAt(0).fillBefore(s,i<=u).append(s):s.append(o.contentMatchAt(o.childCount).fillBefore(b.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(s))}function Ki(t,e,n){return e<t.openStart&&(t=new k(yu(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new k(yu(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const Vs={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Gi=null;function $s(){return Gi||(Gi=document.implementation.createHTMLDocument("title"))}function Jc(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=$s().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),u;if((u=r&&Vs[r[1].toLowerCase()])&&(t=u.map(i=>"<"+i+">").join("")+t+u.map(i=>"</"+i+">").reverse().join("")),n.innerHTML=t,u)for(let i=0;i<u.length;i++)n=n.querySelector(u[i])||n;return n}function Uc(t){let e=t.querySelectorAll(Z?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Kc(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:u,openStart:i,openEnd:o}=t;for(let s=r.length-2;s>=0;s-=2){let l=n.nodes[r[s]];if(!l||l.hasRequiredAttrs())break;u=b.from(l.create(r[s+1],u)),i++,o++}return new k(u,i,o)}const X={},Y={},Gc={touchstart:!0,touchmove:!0};class Zc{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Qc(t){for(let e in X){let n=X[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{Yc(t,r)&&!Vu(t,r)&&(t.editable||!(r.type in Y))&&n(t,r)},Gc[e]?{passive:!0}:void 0)}Q&&t.dom.addEventListener("input",()=>null),ku(t)}function Ue(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Xc(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function ku(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Vu(t,r))})}function Vu(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function Yc(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function ef(t,e){!Vu(t,e)&&X[e.type]&&(t.editable||!(e.type in Y))&&X[e.type](t,e)}Y.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Ws(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(he&&Z&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),It&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",u=>u(t,it(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Hc(t,n)?n.preventDefault():Ue(t,"key")};Y.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Y.keypress=(t,e)=>{let n=e;if(Ws(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||le&&n.metaKey)return;if(t.someProp("handleKeyPress",u=>u(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof T)||!r.$from.sameParent(r.$to)){let u=String.fromCharCode(n.charCode);!/[\r\n]/.test(u)&&!t.someProp("handleTextInput",i=>i(t,r.$from.pos,r.$to.pos,u))&&t.dispatch(t.state.tr.insertText(u).scrollIntoView()),n.preventDefault()}};function pr(t){return{left:t.clientX,top:t.clientY}}function tf(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function $u(t,e,n,r,u){if(r==-1)return!1;let i=t.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(t.someProp(e,s=>o>i.depth?s(t,n,i.nodeAfter,i.before(o),u,!0):s(t,n,i.node(o),i.before(o),u,!1)))return!0;return!1}function Tt(t,e,n){t.focused||t.focus();let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function nf(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&E.isSelectable(r)?(Tt(t,new E(n)),!0):!1}function rf(t,e){if(e==-1)return!1;let n=t.state.selection,r,u;n instanceof E&&(r=n.node);let i=t.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o);if(E.isSelectable(s)){r&&n.$from.depth>0&&o>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?u=i.before(n.$from.depth):u=i.before(o);break}}return u!=null?(Tt(t,E.create(t.state.doc,u)),!0):!1}function uf(t,e,n,r,u){return $u(t,"handleClickOn",e,n,r)||t.someProp("handleClick",i=>i(t,e,r))||(u?rf(t,n):nf(t,n))}function of(t,e,n,r){return $u(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",u=>u(t,e,r))}function sf(t,e,n,r){return $u(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",u=>u(t,e,r))||lf(t,n,r)}function lf(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Tt(t,T.create(r,0,r.content.size)),!0):!1;let u=r.resolve(e);for(let i=u.depth+1;i>0;i--){let o=i>u.depth?u.nodeAfter:u.node(i),s=u.before(i);if(o.inlineContent)Tt(t,T.create(r,s+1,s+1+o.content.size));else if(E.isSelectable(o))Tt(t,E.create(r,s));else continue;return!0}}function Hu(t){return Yn(t)}const Hs=le?"metaKey":"ctrlKey";X.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Hu(t),u=Date.now(),i="singleClick";u-t.input.lastClick.time<500&&tf(n,t.input.lastClick)&&!n[Hs]&&(t.input.lastClick.type=="singleClick"?i="doubleClick":t.input.lastClick.type=="doubleClick"&&(i="tripleClick")),t.input.lastClick={time:u,x:n.clientX,y:n.clientY,type:i};let o=t.posAtCoords(pr(n));o&&(i=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new af(t,o,n,!!r)):(i=="doubleClick"?of:sf)(t,o.pos,o.inside,n)?n.preventDefault():Ue(t,"pointer"))};class af{constructor(e,n,r,u){this.view=e,this.pos=n,this.event=r,this.flushed=u,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Hs],this.allowDefault=r.shiftKey;let i,o;if(n.inside>-1)i=e.state.doc.nodeAt(n.inside),o=n.inside;else{let c=e.state.doc.resolve(n.pos);i=c.parent,o=c.depth?c.before():0}const s=u?null:r.target,l=s?e.docView.nearestDesc(s,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:a}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||a instanceof E&&a.from<=o&&a.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&me&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ue(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ne(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(pr(e))),this.updateAllowDefault(e),this.allowDefault||!n?Ue(this.view,"pointer"):uf(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Q&&this.mightDrag&&!this.mightDrag.node.isAtom||Z&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Tt(this.view,M.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Ue(this.view,"pointer")}move(e){this.updateAllowDefault(e),Ue(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}X.touchstart=t=>{t.input.lastTouch=Date.now(),Hu(t),Ue(t,"pointer")};X.touchmove=t=>{t.input.lastTouch=Date.now(),Ue(t,"pointer")};X.contextmenu=t=>Hu(t);function Ws(t,e){return t.composing?!0:Q&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const cf=he?5e3:-1;Y.compositionstart=Y.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Yn(t,!0),t.markCursor=null;else if(Yn(t),me&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let u=r.focusNode,i=r.focusOffset;u&&u.nodeType==1&&i!=0;){let o=i<0?u.lastChild:u.childNodes[i-1];if(!o)break;if(o.nodeType==3){t.domSelection().collapse(o,o.nodeValue.length);break}else u=o,i=-1}}t.input.composing=!0}js(t,cf)};Y.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,js(t,20))};function js(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Yn(t),e))}function Js(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=df());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function ff(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=nc(e.focusNode,e.focusOffset),r=rc(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let u=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!u||!u.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function df(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Yn(t,e=!1){if(!(he&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Js(t),e||t.docView&&t.docView.dirty){let n=Lu(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}function hf(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),u=document.createRange();u.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(u),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const dn=te&&Ze<15||It&&ac<604;X.copy=Y.cut=(t,e)=>{let n=e,r=t.state.selection,u=n.type=="cut";if(r.empty)return;let i=dn?null:n.clipboardData,o=r.content(),{dom:s,text:l}=zs(t,o);i?(n.preventDefault(),i.clearData(),i.setData("text/html",s.innerHTML),i.setData("text/plain",l)):hf(t,s),u&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function pf(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function mf(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let u=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?hn(t,r.value,null,u,e):hn(t,r.textContent,r.innerHTML,u,e)},50)}function hn(t,e,n,r,u){let i=Bs(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,u,i||k.empty)))return!0;if(!i)return!1;let o=pf(i),s=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(i);return t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Us(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Y.paste=(t,e)=>{let n=e;if(t.composing&&!he)return;let r=dn?null:n.clipboardData,u=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&hn(t,Us(r),r.getData("text/html"),u,n)?n.preventDefault():mf(t,n)};class Ks{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const Gs=le?"altKey":"ctrlKey";X.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let u=t.state.selection,i=u.empty?null:t.posAtCoords(pr(n)),o;if(!(i&&i.pos>=u.from&&i.pos<=(u instanceof E?u.to-1:u.to))){if(r&&r.mightDrag)o=E.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let f=t.docView.nearestDesc(n.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(o=E.create(t.state.doc,f.posBefore))}}let s=(o||t.state.selection).content(),{dom:l,text:a,slice:c}=zs(t,s);n.dataTransfer.clearData(),n.dataTransfer.setData(dn?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",dn||n.dataTransfer.setData("text/plain",a),t.dragging=new Ks(c,!n[Gs],o)};X.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Y.dragover=Y.dragenter=(t,e)=>e.preventDefault();Y.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let u=t.posAtCoords(pr(n));if(!u)return;let i=t.state.doc.resolve(u.pos),o=r&&r.slice;o?t.someProp("transformPasted",h=>{o=h(o,t)}):o=Bs(t,Us(n.dataTransfer),dn?null:n.dataTransfer.getData("text/html"),!1,i);let s=!!(r&&!n[Gs]);if(t.someProp("handleDrop",h=>h(t,n,o||k.empty,s))){n.preventDefault();return}if(!o)return;n.preventDefault();let l=o?ds(t.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let a=t.state.tr;if(s){let{node:h}=r;h?h.replace(a):a.deleteSelection()}let c=a.mapping.map(l),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,d=a.doc;if(f?a.replaceRangeWith(c,c,o.content.firstChild):a.replaceRange(c,c,o),a.doc.eq(d))return;let p=a.doc.resolve(c);if(f&&E.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))a.setSelection(new E(p));else{let h=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((m,g,x,y)=>h=y),a.setSelection(qu(t,p,a.doc.resolve(h)))}t.focus(),t.dispatch(a.setMeta("uiEvent","drop"))};X.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Ne(t)},20))};X.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};X.beforeinput=(t,e)=>{if(Z&&he&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",i=>i(t,it(8,"Backspace")))))return;let{$cursor:u}=t.state.selection;u&&u.pos>0&&t.dispatch(t.state.tr.delete(u.pos-1,u.pos).scrollIntoView())},50)}};for(let t in Y)X[t]=Y[t];function pn(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class er{constructor(e,n){this.toDOM=e,this.spec=n||dt,this.side=this.spec.side||0}map(e,n,r,u){let{pos:i,deleted:o}=e.mapResult(n.from+u,this.side<0?-1:1);return o?null:new ce(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof er&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&pn(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Xe{constructor(e,n){this.attrs=e,this.spec=n||dt}map(e,n,r,u){let i=e.map(n.from+u,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+u,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new ce(i,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Xe&&pn(this.attrs,e.attrs)&&pn(this.spec,e.spec)}static is(e){return e.type instanceof Xe}destroy(){}}class Wu{constructor(e,n){this.attrs=e,this.spec=n||dt}map(e,n,r,u){let i=e.mapResult(n.from+u,1);if(i.deleted)return null;let o=e.mapResult(n.to+u,-1);return o.deleted||o.pos<=i.pos?null:new ce(i.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:u}=e.content.findIndex(n.from),i;return u==n.from&&!(i=e.child(r)).isText&&u+i.nodeSize==n.to}eq(e){return this==e||e instanceof Wu&&pn(this.attrs,e.attrs)&&pn(this.spec,e.spec)}destroy(){}}class ce{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new ce(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new ce(e,e,new er(n,r))}static inline(e,n,r,u){return new ce(e,n,new Xe(r,u))}static node(e,n,r,u){return new ce(e,n,new Wu(r,u))}get spec(){return this.type.spec}get inline(){return this.type instanceof Xe}get widget(){return this.type instanceof er}}const Et=[],dt={};class P{constructor(e,n){this.local=e.length?e:Et,this.children=n.length?n:Et}static create(e,n){return n.length?tr(n,e,0,dt):U}find(e,n,r){let u=[];return this.findInner(e??0,n??1e9,u,0,r),u}findInner(e,n,r,u,i){for(let o=0;o<this.local.length;o++){let s=this.local[o];s.from<=n&&s.to>=e&&(!i||i(s.spec))&&r.push(s.copy(s.from+u,s.to+u))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let s=this.children[o]+1;this.children[o+2].findInner(e-s,n-s,r,u+s,i)}}map(e,n,r){return this==U||e.maps.length==0?this:this.mapInner(e,n,0,0,r||dt)}mapInner(e,n,r,u,i){let o;for(let s=0;s<this.local.length;s++){let l=this.local[s].map(e,r,u);l&&l.type.valid(n,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[s].spec)}return this.children.length?gf(this.children,o||[],e,n,r,u,i):o?new P(o.sort(ht),Et):U}add(e,n){return n.length?this==U?P.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let u,i=0;e.forEach((s,l)=>{let a=l+r,c;if(c=Qs(n,s,a)){for(u||(u=this.children.slice());i<u.length&&u[i]<l;)i+=3;u[i]==l?u[i+2]=u[i+2].addInner(s,c,a+1):u.splice(i,0,l,l+s.nodeSize,tr(c,s,a+1,dt)),i+=3}});let o=Zs(i?Xs(n):n,-r);for(let s=0;s<o.length;s++)o[s].type.valid(e,o[s])||o.splice(s--,1);return new P(o.length?this.local.concat(o).sort(ht):this.local,u||this.children)}remove(e){return e.length==0||this==U?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,u=this.local;for(let i=0;i<r.length;i+=3){let o,s=r[i]+n,l=r[i+1]+n;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>s&&f.to<l&&(e[c]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let a=r[i+2].removeInner(o,s+1);a!=U?r[i+2]=a:(r.splice(i,3),i-=3)}if(u.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let s=0;s<u.length;s++)u[s].eq(o,n)&&(u==this.local&&(u=this.local.slice()),u.splice(s--,1))}return r==this.children&&u==this.local?this:u.length||r.length?new P(u,r):U}forChild(e,n){if(this==U)return this;if(n.isLeaf)return P.empty;let r,u;for(let s=0;s<this.children.length;s+=3)if(this.children[s]>=e){this.children[s]==e&&(r=this.children[s+2]);break}let i=e+1,o=i+n.content.size;for(let s=0;s<this.local.length;s++){let l=this.local[s];if(l.from<o&&l.to>i&&l.type instanceof Xe){let a=Math.max(i,l.from)-i,c=Math.min(o,l.to)-i;a<c&&(u||(u=[])).push(l.copy(a,c))}}if(u){let s=new P(u.sort(ht),Et);return r?new Ve([s,r]):s}return r||U}eq(e){if(this==e)return!0;if(!(e instanceof P)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return ju(this.localsInner(e))}localsInner(e){if(this==U)return Et;if(e.inlineContent||!this.local.some(Xe.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Xe||n.push(this.local[r]);return n}}P.empty=new P([],[]);P.removeOverlap=ju;const U=P.empty;class Ve{constructor(e){this.members=e}map(e,n){const r=this.members.map(u=>u.map(e,n,dt));return Ve.from(r)}forChild(e,n){if(n.isLeaf)return P.empty;let r=[];for(let u=0;u<this.members.length;u++){let i=this.members[u].forChild(e,n);i!=U&&(i instanceof Ve?r=r.concat(i.members):r.push(i))}return Ve.from(r)}eq(e){if(!(e instanceof Ve)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let u=0;u<this.members.length;u++){let i=this.members[u].localsInner(e);if(i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(let o=0;o<i.length;o++)n.push(i[o])}}return n?ju(r?n:n.sort(ht)):Et}static from(e){switch(e.length){case 0:return U;case 1:return e[0];default:return new Ve(e.every(n=>n instanceof P)?e:e.reduce((n,r)=>n.concat(r instanceof P?r:r.members),[]))}}}function gf(t,e,n,r,u,i,o){let s=t.slice();for(let a=0,c=i;a<n.maps.length;a++){let f=0;n.maps[a].forEach((d,p,h,m)=>{let g=m-h-(p-d);for(let x=0;x<s.length;x+=3){let y=s[x+1];if(y<0||d>y+c-f)continue;let w=s[x]+c-f;p>=w?s[x+1]=d<=w?-2:-1:d>=c&&g&&(s[x]+=g,s[x+1]+=g)}f+=g}),c=n.maps[a].map(c,-1)}let l=!1;for(let a=0;a<s.length;a+=3)if(s[a+1]<0){if(s[a+1]==-2){l=!0,s[a+1]=-1;continue}let c=n.map(t[a]+i),f=c-u;if(f<0||f>=r.content.size){l=!0;continue}let d=n.map(t[a+1]+i,-1),p=d-u,{index:h,offset:m}=r.content.findIndex(f),g=r.maybeChild(h);if(g&&m==f&&m+g.nodeSize==p){let x=s[a+2].mapInner(n,g,c+1,t[a]+i+1,o);x!=U?(s[a]=f,s[a+1]=p,s[a+2]=x):(s[a+1]=-2,l=!0)}else l=!0}if(l){let a=bf(s,t,e,n,u,i,o),c=tr(a,r,0,o);e=c.local;for(let f=0;f<s.length;f+=3)s[f+1]<0&&(s.splice(f,3),f-=3);for(let f=0,d=0;f<c.children.length;f+=3){let p=c.children[f];for(;d<s.length&&s[d]<p;)d+=3;s.splice(d,0,c.children[f],c.children[f+1],c.children[f+2])}}return new P(e.sort(ht),s)}function Zs(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let u=t[r];n.push(new ce(u.from+e,u.to+e,u.type))}return n}function bf(t,e,n,r,u,i,o){function s(l,a){for(let c=0;c<l.local.length;c++){let f=l.local[c].map(r,u,a);f?n.push(f):o.onRemove&&o.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)s(l.children[c+2],l.children[c]+a+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&s(t[l+2],e[l]+i+1);return n}function Qs(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,u=null;for(let i=0,o;i<t.length;i++)(o=t[i])&&o.from>n&&o.to<r&&((u||(u=[])).push(o),t[i]=null);return u}function Xs(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function tr(t,e,n,r){let u=[],i=!1;e.forEach((s,l)=>{let a=Qs(t,s,l+n);if(a){i=!0;let c=tr(a,s,n+l+1,r);c!=U&&u.push(l,l+s.nodeSize,c)}});let o=Zs(i?Xs(t):t,-n).sort(ht);for(let s=0;s<o.length;s++)o[s].type.valid(e,o[s])||(r.onRemove&&r.onRemove(o[s].spec),o.splice(s--,1));return o.length||u.length?new P(o,u):U}function ht(t,e){return t.from-e.from||t.to-e.to}function ju(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let u=n+1;u<e.length;u++){let i=e[u];if(i.from==r.from){i.to!=r.to&&(e==t&&(e=t.slice()),e[u]=i.copy(i.from,r.to),Zi(e,u+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),Zi(e,u,r.copy(i.from,r.to)));break}}}return e}function Zi(t,e,n){for(;e<t.length&&ht(n,t[e])>0;)e++;t.splice(e,0,n)}function Or(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=U&&e.push(r)}),t.cursorWrapper&&e.push(P.create(t.state.doc,[t.cursorWrapper.deco])),Ve.from(e)}const xf={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},yf=te&&Ze<=11;class kf{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Cf{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new kf,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let u=0;u<r.length;u++)this.queue.push(r[u]);te&&Ze<=11&&r.some(u=>u.type=="childList"&&u.removedNodes.length||u.type=="characterData"&&u.oldValue.length>u.target.nodeValue.length)?this.flushSoon():this.flush()}),yf&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,xf)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if($i(this.view)){if(this.suppressingSelectionUpdates)return Ne(this.view);if(te&&Ze<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&gt(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let i=e.focusNode;i;i=fn(i))n.add(i);for(let i=e.anchorNode;i;i=fn(i))if(n.has(i)){r=i;break}let u=r&&this.view.docView.nearestDesc(r);if(u&&u.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),u=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&$i(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,s=!1,l=[];if(e.editable)for(let c=0;c<n.length;c++){let f=this.registerMutation(n[c],l);f&&(i=i<0?f.from:Math.min(f.from,i),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(s=!0))}if(me&&l.length){let c=l.filter(f=>f.nodeName=="BR");if(c.length==2){let[f,d]=c;f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let d of c){let p=d.parentNode;p&&p.nodeName=="LI"&&(!f||_f(e,f)!=p)&&d.remove()}}}let a=null;i<0&&u&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&dr(r)&&(a=Lu(e))&&a.eq(M.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ne(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||u)&&(i>-1&&(e.docView.markDirty(i,o),wf(e)),this.handleDOMChange(i,o,s,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Ne(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let f=e.addedNodes[c];n.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let u=e.previousSibling,i=e.nextSibling;if(te&&Ze<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:d}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(u=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d)}let o=u&&u.parentNode==e.target?W(u)+1:0,s=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?W(i):e.target.childNodes.length,a=r.localPosFromDOM(e.target,l,1);return{from:s,to:a}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Qi=new WeakMap,Xi=!1;function wf(t){if(!Qi.has(t)&&(Qi.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=me,Xi)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Xi=!0}}function Yi(t,e){let n=e.startContainer,r=e.startOffset,u=e.endContainer,i=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return gt(o.node,o.offset,u,i)&&([n,r,u,i]=[u,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:u,focusOffset:i}}function Df(t,e){if(e.getComposedRanges){let u=e.getComposedRanges(t.root)[0];if(u)return Yi(t,u)}let n;function r(u){u.preventDefault(),u.stopImmediatePropagation(),n=u.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?Yi(t,n):null}function _f(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function Ef(t,e,n){let{node:r,fromOffset:u,toOffset:i,from:o,to:s}=t.docView.parseRange(e,n),l=t.domSelectionRange(),a,c=l.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(a=[{node:c,offset:l.anchorOffset}],dr(l)||a.push({node:l.focusNode,offset:l.focusOffset})),Z&&t.input.lastKeyCode===8)for(let g=i;g>u;g--){let x=r.childNodes[g-1],y=x.pmViewDesc;if(x.nodeName=="BR"&&!y){i=g;break}if(!y||y.size)break}let f=t.state.doc,d=t.someProp("domParser")||an.fromSchema(t.state.schema),p=f.resolve(o),h=null,m=d.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:u,to:i,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:a,ruleFromNode:Sf,context:p});if(a&&a[0].pos!=null){let g=a[0].pos,x=a[1]&&a[1].pos;x==null&&(x=g),h={anchor:g+o,head:x+o}}return{doc:m,sel:h,from:o,to:s}}function Sf(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Q&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Q&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Af=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Mf(t,e,n,r,u){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let S=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,L=Lu(t,S);if(L&&!t.state.selection.eq(L)){if(Z&&he&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",O=>O(t,it(13,"Enter"))))return;let se=t.state.tr.setSelection(L);S=="pointer"?se.setMeta("pointer",!0):S=="key"&&se.scrollIntoView(),i&&se.setMeta("composition",i),t.dispatch(se)}return}let o=t.state.doc.resolve(e),s=o.sharedDepth(n);e=o.before(s+1),n=t.state.doc.resolve(n).after(s+1);let l=t.state.selection,a=Ef(t,e,n),c=t.state.doc,f=c.slice(a.from,a.to),d,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(d=t.state.selection.to,p="end"):(d=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let h=Of(f.content,a.doc.content,a.from,d,p);if((It&&t.input.lastIOSEnter>Date.now()-225||he)&&u.some(S=>S.nodeType==1&&!Af.test(S.nodeName))&&(!h||h.endA>=h.endB)&&t.someProp("handleKeyDown",S=>S(t,it(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!h)if(r&&l instanceof T&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(a.sel&&a.sel.anchor!=a.sel.head))h={start:l.from,endA:l.to,endB:l.to};else{if(a.sel){let S=eo(t,t.state.doc,a.sel);if(S&&!S.eq(t.state.selection)){let L=t.state.tr.setSelection(S);i&&L.setMeta("composition",i),t.dispatch(L)}}return}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&h.start==h.endB&&t.state.selection instanceof T&&(h.start>t.state.selection.from&&h.start<=t.state.selection.from+2&&t.state.selection.from>=a.from?h.start=t.state.selection.from:h.endA<t.state.selection.to&&h.endA>=t.state.selection.to-2&&t.state.selection.to<=a.to&&(h.endB+=t.state.selection.to-h.endA,h.endA=t.state.selection.to)),te&&Ze<=11&&h.endB==h.start+1&&h.endA==h.start&&h.start>a.from&&a.doc.textBetween(h.start-a.from-1,h.start-a.from+1)==" "&&(h.start--,h.endA--,h.endB--);let m=a.doc.resolveNoCache(h.start-a.from),g=a.doc.resolveNoCache(h.endB-a.from),x=c.resolve(h.start),y=m.sameParent(g)&&m.parent.inlineContent&&x.end()>=h.endA,w;if((It&&t.input.lastIOSEnter>Date.now()-225&&(!y||u.some(S=>S.nodeName=="DIV"||S.nodeName=="P"))||!y&&m.pos<a.doc.content.size&&!m.sameParent(g)&&(w=M.findFrom(a.doc.resolve(m.pos+1),1,!0))&&w.head==g.pos)&&t.someProp("handleKeyDown",S=>S(t,it(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>h.start&&Tf(c,h.start,h.endA,m,g)&&t.someProp("handleKeyDown",S=>S(t,it(8,"Backspace")))){he&&Z&&t.domObserver.suppressSelectionUpdates();return}Z&&he&&h.endB==h.start&&(t.input.lastAndroidDelete=Date.now()),he&&!y&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&a.sel&&a.sel.anchor==a.sel.head&&a.sel.head==h.endA&&(h.endB-=2,g=a.doc.resolveNoCache(h.endB-a.from),setTimeout(()=>{t.someProp("handleKeyDown",function(S){return S(t,it(13,"Enter"))})},20));let C=h.start,D=h.endA,_,I,B;if(y){if(m.pos==g.pos)te&&Ze<=11&&m.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ne(t),20)),_=t.state.tr.delete(C,D),I=c.resolve(h.start).marksAcross(c.resolve(h.endA));else if(h.endA==h.endB&&(B=vf(m.parent.content.cut(m.parentOffset,g.parentOffset),x.parent.content.cut(x.parentOffset,h.endA-x.start()))))_=t.state.tr,B.type=="add"?_.addMark(C,D,B.mark):_.removeMark(C,D,B.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let S=m.parent.textBetween(m.parentOffset,g.parentOffset);if(t.someProp("handleTextInput",L=>L(t,C,D,S)))return;_=t.state.tr.insertText(S,C,D)}}if(_||(_=t.state.tr.replace(C,D,a.doc.slice(h.start-a.from,h.endB-a.from))),a.sel){let S=eo(t,_.doc,a.sel);S&&!(Z&&he&&t.composing&&S.empty&&(h.start!=h.endB||t.input.lastAndroidDelete<Date.now()-100)&&(S.head==C||S.head==_.mapping.map(D)-1)||te&&S.empty&&S.head==C)&&_.setSelection(S)}I&&_.ensureMarks(I),i&&_.setMeta("composition",i),t.dispatch(_.scrollIntoView())}function eo(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:qu(t,e.resolve(n.anchor),e.resolve(n.head))}function vf(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,u=n,i=r,o,s,l;for(let c=0;c<r.length;c++)u=r[c].removeFromSet(u);for(let c=0;c<n.length;c++)i=n[c].removeFromSet(i);if(u.length==1&&i.length==0)s=u[0],o="add",l=c=>c.mark(s.addToSet(c.marks));else if(u.length==0&&i.length==1)s=i[0],o="remove",l=c=>c.mark(s.removeFromSet(c.marks));else return null;let a=[];for(let c=0;c<e.childCount;c++)a.push(l(e.child(c)));if(b.from(a).eq(t))return{mark:s,type:o}}function Tf(t,e,n,r,u){if(n-e<=u.pos-r.pos||Fr(r,!0,!1)<u.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let s=i.nodeAfter;return s!=null&&n==e+s.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=t.resolve(Fr(i,!0,!0));return!o.parent.isTextblock||o.pos>n||Fr(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Fr(t,e,n){let r=t.depth,u=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,u++,e=!1;if(n){let i=t.node(r).maybeChild(t.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,u++}return u}function Of(t,e,n,r,u){let i=t.findDiffStart(e,n);if(i==null)return null;let{a:o,b:s}=t.findDiffEnd(e,n+t.size,n+e.size);if(u=="end"){let l=Math.max(0,i-Math.min(o,s));r-=o+l-i}if(o<i&&t.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&to(e.textBetween(i-1,i+1))&&(i+=l?1:-1),s=i+(s-o),o=i}else if(s<i){let l=r<=i&&r>=s?i-r:0;i-=l,i&&i<t.size&&to(t.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-s),s=i}return{start:i,endA:o,endB:s}}function to(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class Ff{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Zc,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(oo),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=uo(this),ro(this),this.nodeViews=io(this),this.docView=zi(this.state.doc,no(this),Or(this),this.dom,this),this.domObserver=new Cf(this,(r,u,i,o)=>Mf(this,r,u,i,o)),this.domObserver.start(),Qc(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ku(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(oo),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let u=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(Js(this),o=!0),this.state=e;let s=u.plugins!=e.plugins||this._props.plugins!=n.plugins;if(s||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=io(this);If(p,this.nodeViews)&&(this.nodeViews=p,i=!0)}(s||n.handleDOMEvents!=this._props.handleDOMEvents)&&ku(this),this.editable=uo(this),ro(this);let l=Or(this),a=no(this),c=u.plugins!=e.plugins&&!u.doc.eq(e.doc)?"reset":e.scrollToSelection>u.scrollToSelection?"to selection":"preserve",f=i||!this.docView.matchesNode(e.doc,a,l);(f||!e.selection.eq(u.selection))&&(o=!0);let d=c=="preserve"&&o&&this.dom.style.overflowAnchor==null&&dc(this);if(o){this.domObserver.stop();let p=f&&(te||Z)&&!this.composing&&!u.selection.empty&&!e.selection.empty&&Nf(u.selection,e.selection);if(f){let h=Z?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=ff(this)),(i||!this.docView.update(e.doc,a,l,this))&&(this.docView.updateOuterDeco(a),this.docView.destroy(),this.docView=zi(e.doc,a,l,this.dom,this)),h&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&zc(this))?Ne(this,p):(Ns(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(u),!((r=this.dragging)===null||r===void 0)&&r.node&&!u.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,u),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&hc(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof E){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&Ti(this,n.getBoundingClientRect(),e)}else Ti(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,u=-1;if(this.state.doc.nodeAt(r.from)==r.node)u=r.from;else{let i=r.from+(this.state.doc.content.size-n.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(u=i)}this.dragging=new Ks(e.slice,e.move,u<0?void 0:E.create(this.state.doc,u))}someProp(e,n){let r=this._props&&this._props[e],u;if(r!=null&&(u=n?n(r):r))return u;for(let o=0;o<this.directPlugins.length;o++){let s=this.directPlugins[o].props[e];if(s!=null&&(u=n?n(s):s))return u}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let s=i[o].props[e];if(s!=null&&(u=n?n(s):s))return u}}hasFocus(){if(te){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&pc(this.dom),Ne(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return yc(this,e)}coordsAtPos(e,n=1){return Es(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let u=this.docView.posFromDOM(e,n,r);if(u==null)throw new RangeError("DOM position not inside the editor");return u}endOfTextblock(e,n){return _c(this,n||this.state,e)}pasteHTML(e,n){return hn(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return hn(this,e,null,!0,n||new ClipboardEvent("paste"))}destroy(){this.docView&&(Xc(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Or(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,ec())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return ef(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return Q&&this.root.nodeType===11&&ic(this.dom.ownerDocument)==this.dom&&Df(this,e)||e}domSelection(){return this.root.getSelection()}}function no(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[ce.node(0,t.state.doc.content.size,e)]}function ro(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:ce.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function uo(t){return!t.someProp("editable",e=>e(t.state)===!1)}function Nf(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function io(t){let e=Object.create(null);function n(r){for(let u in r)Object.prototype.hasOwnProperty.call(e,u)||(e[u]=r[u])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function If(t,e){let n=0,r=0;for(let u in t){if(t[u]!=e[u])return!0;n++}for(let u in e)r++;return n!=r}function oo(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}function Rf(t){let e;return{c(){e=Zt("div"),this.h()},l(n){e=Qt(n,"DIV",{class:!0}),Qr(e).forEach(Ge),this.h()},h(){Xr(e,"class","prose")},m(n,r){wn(n,e,r),t[2](e)},p:St,i:St,o:St,d(n){n&&Ge(e),t[2](null)}}}function zf(t,e,n){Kl();let{state:r}=e,u,i;Gl(()=>{i=new Ff(u,{state:r,dispatchTransaction(){}})}),Zl(()=>{i&&i.destroy()});function o(s){Nu[s?"unshift":"push"](()=>{u=s,n(0,u)})}return t.$$set=s=>{"state"in s&&n(1,r=s.state)},[u,r,o]}class Bf extends lr{constructor(e){super(),ar(this,e,zf,Rf,Cn,{state:1})}}const so={};function Pf(t){let e=so[t];if(e)return e;e=so[t]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);e.push(r)}for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}function Rt(t,e){typeof e!="string"&&(e=Rt.defaultChars);const n=Pf(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(r){let u="";for(let i=0,o=r.length;i<o;i+=3){const s=parseInt(r.slice(i+1,i+3),16);if(s<128){u+=n[s];continue}if((s&224)===192&&i+3<o){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const a=s<<6&1984|l&63;a<128?u+="":u+=String.fromCharCode(a),i+=3;continue}}if((s&240)===224&&i+6<o){const l=parseInt(r.slice(i+4,i+6),16),a=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(a&192)===128){const c=s<<12&61440|l<<6&4032|a&63;c<2048||c>=55296&&c<=57343?u+="":u+=String.fromCharCode(c),i+=6;continue}}if((s&248)===240&&i+9<o){const l=parseInt(r.slice(i+4,i+6),16),a=parseInt(r.slice(i+7,i+9),16),c=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(a&192)===128&&(c&192)===128){let f=s<<18&1835008|l<<12&258048|a<<6&4032|c&63;f<65536||f>1114111?u+="":(f-=65536,u+=String.fromCharCode(55296+(f>>10),56320+(f&1023))),i+=9;continue}}u+=""}return u})}Rt.defaultChars=";/?:@&=+$,#";Rt.componentChars="";const lo={};function Lf(t){let e=lo[t];if(e)return e;e=lo[t]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?e.push(r):e.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<t.length;n++)e[t.charCodeAt(n)]=t[n];return e}function An(t,e,n){typeof e!="string"&&(n=e,e=An.defaultChars),typeof n>"u"&&(n=!0);const r=Lf(e);let u="";for(let i=0,o=t.length;i<o;i++){const s=t.charCodeAt(i);if(n&&s===37&&i+2<o&&/^[0-9a-f]{2}$/i.test(t.slice(i+1,i+3))){u+=t.slice(i,i+3),i+=2;continue}if(s<128){u+=r[s];continue}if(s>=55296&&s<=57343){if(s>=55296&&s<=56319&&i+1<o){const l=t.charCodeAt(i+1);if(l>=56320&&l<=57343){u+=encodeURIComponent(t[i]+t[i+1]),i++;continue}}u+="%EF%BF%BD";continue}u+=encodeURIComponent(t[i])}return u}An.defaultChars=";/?:@&=+$,-_.!~*'()#";An.componentChars="-_.!~*'()";function Ju(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&t.hostname.indexOf(":")!==-1?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function nr(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const qf=/^([a-z0-9.+-]+:)/i,Vf=/:[0-9]*$/,$f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Hf=["<",">",'"',"`"," ","\r",`
`,"	"],Wf=["{","}","|","\\","^","`"].concat(Hf),jf=["'"].concat(Wf),ao=["%","/","?",";","#"].concat(jf),co=["/","?","#"],Jf=255,fo=/^[+a-z0-9A-Z_-]{0,63}$/,Uf=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ho={javascript:!0,"javascript:":!0},po={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Uu(t,e){if(t&&t instanceof nr)return t;const n=new nr;return n.parse(t,e),n}nr.prototype.parse=function(t,e){let n,r,u,i=t;if(i=i.trim(),!e&&t.split("#").length===1){const a=$f.exec(i);if(a)return this.pathname=a[1],a[2]&&(this.search=a[2]),this}let o=qf.exec(i);if(o&&(o=o[0],n=o.toLowerCase(),this.protocol=o,i=i.substr(o.length)),(e||o||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(u=i.substr(0,2)==="//",u&&!(o&&ho[o])&&(i=i.substr(2),this.slashes=!0)),!ho[o]&&(u||o&&!po[o])){let a=-1;for(let h=0;h<co.length;h++)r=i.indexOf(co[h]),r!==-1&&(a===-1||r<a)&&(a=r);let c,f;a===-1?f=i.lastIndexOf("@"):f=i.lastIndexOf("@",a),f!==-1&&(c=i.slice(0,f),i=i.slice(f+1),this.auth=c),a=-1;for(let h=0;h<ao.length;h++)r=i.indexOf(ao[h]),r!==-1&&(a===-1||r<a)&&(a=r);a===-1&&(a=i.length),i[a-1]===":"&&a--;const d=i.slice(0,a);i=i.slice(a),this.parseHost(d),this.hostname=this.hostname||"";const p=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!p){const h=this.hostname.split(/\./);for(let m=0,g=h.length;m<g;m++){const x=h[m];if(x&&!x.match(fo)){let y="";for(let w=0,C=x.length;w<C;w++)x.charCodeAt(w)>127?y+="x":y+=x[w];if(!y.match(fo)){const w=h.slice(0,m),C=h.slice(m+1),D=x.match(Uf);D&&(w.push(D[1]),C.unshift(D[2])),C.length&&(i=C.join(".")+i),this.hostname=w.join(".");break}}}}this.hostname.length>Jf&&(this.hostname=""),p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const s=i.indexOf("#");s!==-1&&(this.hash=i.substr(s),i=i.slice(0,s));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),po[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};nr.prototype.parseHost=function(t){let e=Vf.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const Kf=Object.freeze(Object.defineProperty({__proto__:null,decode:Rt,encode:An,format:Ju,parse:Uu},Symbol.toStringTag,{value:"Module"})),Ys=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,el=/[\0-\x1F\x7F-\x9F]/,Gf=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,Ku=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,tl=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,nl=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Zf=Object.freeze(Object.defineProperty({__proto__:null,Any:Ys,Cc:el,Cf:Gf,P:Ku,S:tl,Z:nl},Symbol.toStringTag,{value:"Module"})),Qf=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),Xf=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var Nr;const Yf=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),e0=(Nr=String.fromCodePoint)!==null&&Nr!==void 0?Nr:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function t0(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=Yf.get(t))!==null&&e!==void 0?e:t}var V;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(V||(V={}));const n0=32;var Ke;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Ke||(Ke={}));function Cu(t){return t>=V.ZERO&&t<=V.NINE}function r0(t){return t>=V.UPPER_A&&t<=V.UPPER_F||t>=V.LOWER_A&&t<=V.LOWER_F}function u0(t){return t>=V.UPPER_A&&t<=V.UPPER_Z||t>=V.LOWER_A&&t<=V.LOWER_Z||Cu(t)}function i0(t){return t===V.EQUALS||u0(t)}var q;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(q||(q={}));var $e;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})($e||($e={}));class o0{constructor(e,n,r){this.decodeTree=e,this.emitCodePoint=n,this.errors=r,this.state=q.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=$e.Strict}startEntity(e){this.decodeMode=e,this.state=q.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case q.EntityStart:return e.charCodeAt(n)===V.NUM?(this.state=q.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=q.NamedEntity,this.stateNamedEntity(e,n));case q.NumericStart:return this.stateNumericStart(e,n);case q.NumericDecimal:return this.stateNumericDecimal(e,n);case q.NumericHex:return this.stateNumericHex(e,n);case q.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|n0)===V.LOWER_X?(this.state=q.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=q.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,r,u){if(n!==r){const i=r-n;this.result=this.result*Math.pow(u,i)+parseInt(e.substr(n,i),u),this.consumed+=i}}stateNumericHex(e,n){const r=n;for(;n<e.length;){const u=e.charCodeAt(n);if(Cu(u)||r0(u))n+=1;else return this.addToNumericResult(e,r,n,16),this.emitNumericEntity(u,3)}return this.addToNumericResult(e,r,n,16),-1}stateNumericDecimal(e,n){const r=n;for(;n<e.length;){const u=e.charCodeAt(n);if(Cu(u))n+=1;else return this.addToNumericResult(e,r,n,10),this.emitNumericEntity(u,2)}return this.addToNumericResult(e,r,n,10),-1}emitNumericEntity(e,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===V.SEMI)this.consumed+=1;else if(this.decodeMode===$e.Strict)return 0;return this.emitCodePoint(t0(this.result),this.consumed),this.errors&&(e!==V.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:r}=this;let u=r[this.treeIndex],i=(u&Ke.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const o=e.charCodeAt(n);if(this.treeIndex=s0(r,u,this.treeIndex+Math.max(1,i),o),this.treeIndex<0)return this.result===0||this.decodeMode===$e.Attribute&&(i===0||i0(o))?0:this.emitNotTerminatedNamedEntity();if(u=r[this.treeIndex],i=(u&Ke.VALUE_LENGTH)>>14,i!==0){if(o===V.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==$e.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:r}=this,u=(r[n]&Ke.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,u,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,r){const{decodeTree:u}=this;return this.emitCodePoint(n===1?u[e]&~Ke.VALUE_LENGTH:u[e+1],r),n===3&&this.emitCodePoint(u[e+2],r),r}end(){var e;switch(this.state){case q.NamedEntity:return this.result!==0&&(this.decodeMode!==$e.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case q.NumericDecimal:return this.emitNumericEntity(0,2);case q.NumericHex:return this.emitNumericEntity(0,3);case q.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case q.EntityStart:return 0}}}function rl(t){let e="";const n=new o0(t,r=>e+=e0(r));return function(u,i){let o=0,s=0;for(;(s=u.indexOf("&",s))>=0;){e+=u.slice(o,s),n.startEntity(i);const a=n.write(u,s+1);if(a<0){o=s+n.end();break}o=s+a,s=a===0?o+1:o}const l=e+u.slice(o);return e="",l}}function s0(t,e,n,r){const u=(e&Ke.BRANCH_LENGTH)>>7,i=e&Ke.JUMP_TABLE;if(u===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=u?-1:t[n+l]-1}let o=n,s=o+u-1;for(;o<=s;){const l=o+s>>>1,a=t[l];if(a<r)o=l+1;else if(a>r)s=l-1;else return t[l+u]}return-1}const l0=rl(Qf);rl(Xf);function ul(t,e=$e.Legacy){return l0(t,e)}function a0(t){return Object.prototype.toString.call(t)}function Gu(t){return a0(t)==="[object String]"}const c0=Object.prototype.hasOwnProperty;function f0(t,e){return c0.call(t,e)}function mr(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){t[r]=n[r]})}}),t}function il(t,e,n){return[].concat(t.slice(0,e),n,t.slice(e+1))}function Zu(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function rr(t){if(t>65535){t-=65536;const e=55296+(t>>10),n=56320+(t&1023);return String.fromCharCode(e,n)}return String.fromCharCode(t)}const ol=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,d0=/&([a-z#][a-z0-9]{1,31});/gi,h0=new RegExp(ol.source+"|"+d0.source,"gi"),p0=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function m0(t,e){if(e.charCodeAt(0)===35&&p0.test(e)){const r=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return Zu(r)?rr(r):t}const n=ul(t);return n!==t?n:t}function g0(t){return t.indexOf("\\")<0?t:t.replace(ol,"$1")}function zt(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(h0,function(e,n,r){return n||m0(e,r)})}const b0=/[&<>"]/,x0=/[&<>"]/g,y0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function k0(t){return y0[t]}function Ye(t){return b0.test(t)?t.replace(x0,k0):t}const C0=/[.?*+^$[\]\\(){}|-]/g;function w0(t){return t.replace(C0,"\\$&")}function F(t){switch(t){case 9:case 32:return!0}return!1}function mn(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function gn(t){return Ku.test(t)||tl.test(t)}function bn(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function gr(t){return t=t.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(t=t.replace(//g,"")),t.toLowerCase().toUpperCase()}const D0={mdurl:Kf,ucmicro:Zf},_0=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:il,assign:mr,escapeHtml:Ye,escapeRE:w0,fromCodePoint:rr,has:f0,isMdAsciiPunct:bn,isPunctChar:gn,isSpace:F,isString:Gu,isValidEntityCode:Zu,isWhiteSpace:mn,lib:D0,normalizeReference:gr,unescapeAll:zt,unescapeMd:g0},Symbol.toStringTag,{value:"Module"}));function E0(t,e,n){let r,u,i,o;const s=t.posMax,l=t.pos;for(t.pos=e+1,r=1;t.pos<s;){if(i=t.src.charCodeAt(t.pos),i===93&&(r--,r===0)){u=!0;break}if(o=t.pos,t.md.inline.skipToken(t),i===91){if(o===t.pos-1)r++;else if(n)return t.pos=l,-1}}let a=-1;return u&&(a=t.pos),t.pos=l,a}function S0(t,e,n){let r,u=e;const i={ok:!1,pos:0,str:""};if(t.charCodeAt(u)===60){for(u++;u<n;){if(r=t.charCodeAt(u),r===10||r===60)return i;if(r===62)return i.pos=u+1,i.str=zt(t.slice(e+1,u)),i.ok=!0,i;if(r===92&&u+1<n){u+=2;continue}u++}return i}let o=0;for(;u<n&&(r=t.charCodeAt(u),!(r===32||r<32||r===127));){if(r===92&&u+1<n){if(t.charCodeAt(u+1)===32)break;u+=2;continue}if(r===40&&(o++,o>32))return i;if(r===41){if(o===0)break;o--}u++}return e===u||o!==0||(i.str=zt(t.slice(e,u)),i.pos=u,i.ok=!0),i}function A0(t,e,n,r){let u,i=e;const o={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)o.str=r.str,o.marker=r.marker;else{if(i>=n)return o;let s=t.charCodeAt(i);if(s!==34&&s!==39&&s!==40)return o;e++,i++,s===40&&(s=41),o.marker=s}for(;i<n;){if(u=t.charCodeAt(i),u===o.marker)return o.pos=i+1,o.str+=zt(t.slice(e,i)),o.ok=!0,o;if(u===40&&o.marker===41)return o;u===92&&i+1<n&&i++,i++}return o.can_continue=!0,o.str+=zt(t.slice(e,i)),o}const M0=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:S0,parseLinkLabel:E0,parseLinkTitle:A0},Symbol.toStringTag,{value:"Module"})),Ee={};Ee.code_inline=function(t,e,n,r,u){const i=t[e];return"<code"+u.renderAttrs(i)+">"+Ye(i.content)+"</code>"};Ee.code_block=function(t,e,n,r,u){const i=t[e];return"<pre"+u.renderAttrs(i)+"><code>"+Ye(t[e].content)+`</code></pre>
`};Ee.fence=function(t,e,n,r,u){const i=t[e],o=i.info?zt(i.info).trim():"";let s="",l="";if(o){const c=o.split(/(\s+)/g);s=c[0],l=c.slice(2).join("")}let a;if(n.highlight?a=n.highlight(i.content,s,l)||Ye(i.content):a=Ye(i.content),a.indexOf("<pre")===0)return a+`
`;if(o){const c=i.attrIndex("class"),f=i.attrs?i.attrs.slice():[];c<0?f.push(["class",n.langPrefix+s]):(f[c]=f[c].slice(),f[c][1]+=" "+n.langPrefix+s);const d={attrs:f};return`<pre><code${u.renderAttrs(d)}>${a}</code></pre>
`}return`<pre><code${u.renderAttrs(i)}>${a}</code></pre>
`};Ee.image=function(t,e,n,r,u){const i=t[e];return i.attrs[i.attrIndex("alt")][1]=u.renderInlineAsText(i.children,n,r),u.renderToken(t,e,n)};Ee.hardbreak=function(t,e,n){return n.xhtmlOut?`<br />
`:`<br>
`};Ee.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Ee.text=function(t,e){return Ye(t[e].content)};Ee.html_block=function(t,e){return t[e].content};Ee.html_inline=function(t,e){return t[e].content};function Lt(){this.rules=mr({},Ee)}Lt.prototype.renderAttrs=function(e){let n,r,u;if(!e.attrs)return"";for(u="",n=0,r=e.attrs.length;n<r;n++)u+=" "+Ye(e.attrs[n][0])+'="'+Ye(e.attrs[n][1])+'"';return u};Lt.prototype.renderToken=function(e,n,r){const u=e[n];let i="";if(u.hidden)return"";u.block&&u.nesting!==-1&&n&&e[n-1].hidden&&(i+=`
`),i+=(u.nesting===-1?"</":"<")+u.tag,i+=this.renderAttrs(u),u.nesting===0&&r.xhtmlOut&&(i+=" /");let o=!1;if(u.block&&(o=!0,u.nesting===1&&n+1<e.length)){const s=e[n+1];(s.type==="inline"||s.hidden||s.nesting===-1&&s.tag===u.tag)&&(o=!1)}return i+=o?`>
`:">",i};Lt.prototype.renderInline=function(t,e,n){let r="";const u=this.rules;for(let i=0,o=t.length;i<o;i++){const s=t[i].type;typeof u[s]<"u"?r+=u[s](t,i,e,n,this):r+=this.renderToken(t,i,e)}return r};Lt.prototype.renderInlineAsText=function(t,e,n){let r="";for(let u=0,i=t.length;u<i;u++)switch(t[u].type){case"text":r+=t[u].content;break;case"image":r+=this.renderInlineAsText(t[u].children,e,n);break;case"html_inline":case"html_block":r+=t[u].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};Lt.prototype.render=function(t,e,n){let r="";const u=this.rules;for(let i=0,o=t.length;i<o;i++){const s=t[i].type;s==="inline"?r+=this.renderInline(t[i].children,e,n):typeof u[s]<"u"?r+=u[s](t,i,e,n,this):r+=this.renderToken(t,i,e,n)}return r};function ne(){this.__rules__=[],this.__cache__=null}ne.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1};ne.prototype.__compile__=function(){const t=this,e=[""];t.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),t.__cache__={},e.forEach(function(n){t.__cache__[n]=[],t.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||t.__cache__[n].push(r.fn))})})};ne.prototype.at=function(t,e,n){const r=this.__find__(t),u=n||{};if(r===-1)throw new Error("Parser rule not found: "+t);this.__rules__[r].fn=e,this.__rules__[r].alt=u.alt||[],this.__cache__=null};ne.prototype.before=function(t,e,n,r){const u=this.__find__(t),i=r||{};if(u===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(u,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};ne.prototype.after=function(t,e,n,r){const u=this.__find__(t),i=r||{};if(u===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(u+1,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};ne.prototype.push=function(t,e,n){const r=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};ne.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(r){const u=this.__find__(r);if(u<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[u].enabled=!0,n.push(r)},this),this.__cache__=null,n};ne.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(t,e)};ne.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(r){const u=this.__find__(r);if(u<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[u].enabled=!1,n.push(r)},this),this.__cache__=null,n};ne.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};function ge(t,e,n){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}ge.prototype.attrIndex=function(e){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,u=n.length;r<u;r++)if(n[r][0]===e)return r;return-1};ge.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};ge.prototype.attrSet=function(e,n){const r=this.attrIndex(e),u=[e,n];r<0?this.attrPush(u):this.attrs[r]=u};ge.prototype.attrGet=function(e){const n=this.attrIndex(e);let r=null;return n>=0&&(r=this.attrs[n][1]),r};ge.prototype.attrJoin=function(e,n){const r=this.attrIndex(e);r<0?this.attrPush([e,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function sl(t,e,n){this.src=t,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=e}sl.prototype.Token=ge;const v0=/\r\n?|\n/g,T0=/\0/g;function O0(t){let e;e=t.src.replace(v0,`
`),e=e.replace(T0,""),t.src=e}function F0(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}function N0(t){const e=t.tokens;for(let n=0,r=e.length;n<r;n++){const u=e[n];u.type==="inline"&&t.md.inline.parse(u.content,t.md,t.env,u.children)}}function I0(t){return/^<a[>\s]/i.test(t)}function R0(t){return/^<\/a\s*>/i.test(t)}function z0(t){const e=t.tokens;if(t.md.options.linkify)for(let n=0,r=e.length;n<r;n++){if(e[n].type!=="inline"||!t.md.linkify.pretest(e[n].content))continue;let u=e[n].children,i=0;for(let o=u.length-1;o>=0;o--){const s=u[o];if(s.type==="link_close"){for(o--;u[o].level!==s.level&&u[o].type!=="link_open";)o--;continue}if(s.type==="html_inline"&&(I0(s.content)&&i>0&&i--,R0(s.content)&&i++),!(i>0)&&s.type==="text"&&t.md.linkify.test(s.content)){const l=s.content;let a=t.md.linkify.match(l);const c=[];let f=s.level,d=0;a.length>0&&a[0].index===0&&o>0&&u[o-1].type==="text_special"&&(a=a.slice(1));for(let p=0;p<a.length;p++){const h=a[p].url,m=t.md.normalizeLink(h);if(!t.md.validateLink(m))continue;let g=a[p].text;a[p].schema?a[p].schema==="mailto:"&&!/^mailto:/i.test(g)?g=t.md.normalizeLinkText("mailto:"+g).replace(/^mailto:/,""):g=t.md.normalizeLinkText(g):g=t.md.normalizeLinkText("http://"+g).replace(/^http:\/\//,"");const x=a[p].index;if(x>d){const D=new t.Token("text","",0);D.content=l.slice(d,x),D.level=f,c.push(D)}const y=new t.Token("link_open","a",1);y.attrs=[["href",m]],y.level=f++,y.markup="linkify",y.info="auto",c.push(y);const w=new t.Token("text","",0);w.content=g,w.level=f,c.push(w);const C=new t.Token("link_close","a",-1);C.level=--f,C.markup="linkify",C.info="auto",c.push(C),d=a[p].lastIndex}if(d<l.length){const p=new t.Token("text","",0);p.content=l.slice(d),p.level=f,c.push(p)}e[n].children=u=il(u,o,c)}}}}const ll=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,B0=/\((c|tm|r)\)/i,P0=/\((c|tm|r)\)/ig,L0={c:"",r:"",tm:""};function q0(t,e){return L0[e.toLowerCase()]}function V0(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];r.type==="text"&&!e&&(r.content=r.content.replace(P0,q0)),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function $0(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];r.type==="text"&&!e&&ll.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function H0(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)t.tokens[e].type==="inline"&&(B0.test(t.tokens[e].content)&&V0(t.tokens[e].children),ll.test(t.tokens[e].content)&&$0(t.tokens[e].children))}const W0=/['"]/,mo=/['"]/g,go="";function zn(t,e,n){return t.slice(0,e)+n+t.slice(e+1)}function j0(t,e){let n;const r=[];for(let u=0;u<t.length;u++){const i=t[u],o=t[u].level;for(n=r.length-1;n>=0&&!(r[n].level<=o);n--);if(r.length=n+1,i.type!=="text")continue;let s=i.content,l=0,a=s.length;e:for(;l<a;){mo.lastIndex=l;const c=mo.exec(s);if(!c)break;let f=!0,d=!0;l=c.index+1;const p=c[0]==="'";let h=32;if(c.index-1>=0)h=s.charCodeAt(c.index-1);else for(n=u-1;n>=0&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n--)if(t[n].content){h=t[n].content.charCodeAt(t[n].content.length-1);break}let m=32;if(l<a)m=s.charCodeAt(l);else for(n=u+1;n<t.length&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n++)if(t[n].content){m=t[n].content.charCodeAt(0);break}const g=bn(h)||gn(String.fromCharCode(h)),x=bn(m)||gn(String.fromCharCode(m)),y=mn(h),w=mn(m);if(w?f=!1:x&&(y||g||(f=!1)),y?d=!1:g&&(w||x||(d=!1)),m===34&&c[0]==='"'&&h>=48&&h<=57&&(d=f=!1),f&&d&&(f=g,d=x),!f&&!d){p&&(i.content=zn(i.content,c.index,go));continue}if(d)for(n=r.length-1;n>=0;n--){let C=r[n];if(r[n].level<o)break;if(C.single===p&&r[n].level===o){C=r[n];let D,_;p?(D=e.md.options.quotes[2],_=e.md.options.quotes[3]):(D=e.md.options.quotes[0],_=e.md.options.quotes[1]),i.content=zn(i.content,c.index,_),t[C.token].content=zn(t[C.token].content,C.pos,D),l+=_.length-1,C.token===u&&(l+=D.length-1),s=i.content,a=s.length,r.length=n;continue e}}f?r.push({token:u,pos:c.index,single:p,level:o}):d&&p&&(i.content=zn(i.content,c.index,go))}}}function J0(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)t.tokens[e].type!=="inline"||!W0.test(t.tokens[e].content)||j0(t.tokens[e].children,t)}function U0(t){let e,n;const r=t.tokens,u=r.length;for(let i=0;i<u;i++){if(r[i].type!=="inline")continue;const o=r[i].children,s=o.length;for(e=0;e<s;e++)o[e].type==="text_special"&&(o[e].type="text");for(e=n=0;e<s;e++)o[e].type==="text"&&e+1<s&&o[e+1].type==="text"?o[e+1].content=o[e].content+o[e+1].content:(e!==n&&(o[n]=o[e]),n++);e!==n&&(o.length=n)}}const Ir=[["normalize",O0],["block",F0],["inline",N0],["linkify",z0],["replacements",H0],["smartquotes",J0],["text_join",U0]];function Qu(){this.ruler=new ne;for(let t=0;t<Ir.length;t++)this.ruler.push(Ir[t][0],Ir[t][1])}Qu.prototype.process=function(t){const e=this.ruler.getRules("");for(let n=0,r=e.length;n<r;n++)e[n](t)};Qu.prototype.State=sl;function Se(t,e,n,r){this.src=t,this.md=e,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const u=this.src;for(let i=0,o=0,s=0,l=0,a=u.length,c=!1;o<a;o++){const f=u.charCodeAt(o);if(!c)if(F(f)){s++,f===9?l+=4-l%4:l++;continue}else c=!0;(f===10||o===a-1)&&(f!==10&&o++,this.bMarks.push(i),this.eMarks.push(o),this.tShift.push(s),this.sCount.push(l),this.bsCount.push(0),c=!1,s=0,l=0,i=o+1)}this.bMarks.push(u.length),this.eMarks.push(u.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Se.prototype.push=function(t,e,n){const r=new ge(t,e,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};Se.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Se.prototype.skipEmptyLines=function(e){for(let n=this.lineMax;e<n&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Se.prototype.skipSpaces=function(e){for(let n=this.src.length;e<n;e++){const r=this.src.charCodeAt(e);if(!F(r))break}return e};Se.prototype.skipSpacesBack=function(e,n){if(e<=n)return e;for(;e>n;)if(!F(this.src.charCodeAt(--e)))return e+1;return e};Se.prototype.skipChars=function(e,n){for(let r=this.src.length;e<r&&this.src.charCodeAt(e)===n;e++);return e};Se.prototype.skipCharsBack=function(e,n,r){if(e<=r)return e;for(;e>r;)if(n!==this.src.charCodeAt(--e))return e+1;return e};Se.prototype.getLines=function(e,n,r,u){if(e>=n)return"";const i=new Array(n-e);for(let o=0,s=e;s<n;s++,o++){let l=0;const a=this.bMarks[s];let c=a,f;for(s+1<n||u?f=this.eMarks[s]+1:f=this.eMarks[s];c<f&&l<r;){const d=this.src.charCodeAt(c);if(F(d))d===9?l+=4-(l+this.bsCount[s])%4:l++;else if(c-a<this.tShift[s])l++;else break;c++}l>r?i[o]=new Array(l-r+1).join(" ")+this.src.slice(c,f):i[o]=this.src.slice(c,f)}return i.join("")};Se.prototype.Token=ge;const K0=65536;function Rr(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];return t.src.slice(n,r)}function bo(t){const e=[],n=t.length;let r=0,u=t.charCodeAt(r),i=!1,o=0,s="";for(;r<n;)u===124&&(i?(s+=t.substring(o,r-1),o=r):(e.push(s+t.substring(o,r)),s="",o=r+1)),i=u===92,r++,u=t.charCodeAt(r);return e.push(s+t.substring(o)),e}function G0(t,e,n,r){if(e+2>n)return!1;let u=e+1;if(t.sCount[u]<t.blkIndent||t.sCount[u]-t.blkIndent>=4)return!1;let i=t.bMarks[u]+t.tShift[u];if(i>=t.eMarks[u])return!1;const o=t.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58||i>=t.eMarks[u])return!1;const s=t.src.charCodeAt(i++);if(s!==124&&s!==45&&s!==58&&!F(s)||o===45&&F(s))return!1;for(;i<t.eMarks[u];){const C=t.src.charCodeAt(i);if(C!==124&&C!==45&&C!==58&&!F(C))return!1;i++}let l=Rr(t,e+1),a=l.split("|");const c=[];for(let C=0;C<a.length;C++){const D=a[C].trim();if(!D){if(C===0||C===a.length-1)continue;return!1}if(!/^:?-+:?$/.test(D))return!1;D.charCodeAt(D.length-1)===58?c.push(D.charCodeAt(0)===58?"center":"right"):D.charCodeAt(0)===58?c.push("left"):c.push("")}if(l=Rr(t,e).trim(),l.indexOf("|")===-1||t.sCount[e]-t.blkIndent>=4)return!1;a=bo(l),a.length&&a[0]===""&&a.shift(),a.length&&a[a.length-1]===""&&a.pop();const f=a.length;if(f===0||f!==c.length)return!1;if(r)return!0;const d=t.parentType;t.parentType="table";const p=t.md.block.ruler.getRules("blockquote"),h=t.push("table_open","table",1),m=[e,0];h.map=m;const g=t.push("thead_open","thead",1);g.map=[e,e+1];const x=t.push("tr_open","tr",1);x.map=[e,e+1];for(let C=0;C<a.length;C++){const D=t.push("th_open","th",1);c[C]&&(D.attrs=[["style","text-align:"+c[C]]]);const _=t.push("inline","",0);_.content=a[C].trim(),_.children=[],t.push("th_close","th",-1)}t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let y,w=0;for(u=e+2;u<n&&!(t.sCount[u]<t.blkIndent);u++){let C=!1;for(let _=0,I=p.length;_<I;_++)if(p[_](t,u,n,!0)){C=!0;break}if(C||(l=Rr(t,u).trim(),!l)||t.sCount[u]-t.blkIndent>=4||(a=bo(l),a.length&&a[0]===""&&a.shift(),a.length&&a[a.length-1]===""&&a.pop(),w+=f-a.length,w>K0))break;if(u===e+2){const _=t.push("tbody_open","tbody",1);_.map=y=[e+2,0]}const D=t.push("tr_open","tr",1);D.map=[u,u+1];for(let _=0;_<f;_++){const I=t.push("td_open","td",1);c[_]&&(I.attrs=[["style","text-align:"+c[_]]]);const B=t.push("inline","",0);B.content=a[_]?a[_].trim():"",B.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return y&&(t.push("tbody_close","tbody",-1),y[1]=u),t.push("table_close","table",-1),m[1]=u,t.parentType=d,t.line=u,!0}function Z0(t,e,n){if(t.sCount[e]-t.blkIndent<4)return!1;let r=e+1,u=r;for(;r<n;){if(t.isEmpty(r)){r++;continue}if(t.sCount[r]-t.blkIndent>=4){r++,u=r;continue}break}t.line=u;const i=t.push("code_block","code",0);return i.content=t.getLines(e,u,4+t.blkIndent,!1)+`
`,i.map=[e,t.line],!0}function Q0(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||u+3>i)return!1;const o=t.src.charCodeAt(u);if(o!==126&&o!==96)return!1;let s=u;u=t.skipChars(u,o);let l=u-s;if(l<3)return!1;const a=t.src.slice(s,u),c=t.src.slice(u,i);if(o===96&&c.indexOf(String.fromCharCode(o))>=0)return!1;if(r)return!0;let f=e,d=!1;for(;f++,!(f>=n||(u=s=t.bMarks[f]+t.tShift[f],i=t.eMarks[f],u<i&&t.sCount[f]<t.blkIndent));)if(t.src.charCodeAt(u)===o&&!(t.sCount[f]-t.blkIndent>=4)&&(u=t.skipChars(u,o),!(u-s<l)&&(u=t.skipSpaces(u),!(u<i)))){d=!0;break}l=t.sCount[e],t.line=f+(d?1:0);const p=t.push("fence","code",0);return p.info=c,p.content=t.getLines(e+1,f,l,!0),p.markup=a,p.map=[e,t.line],!0}function X0(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];const o=t.lineMax;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(u)!==62)return!1;if(r)return!0;const s=[],l=[],a=[],c=[],f=t.md.block.ruler.getRules("blockquote"),d=t.parentType;t.parentType="blockquote";let p=!1,h;for(h=e;h<n;h++){const w=t.sCount[h]<t.blkIndent;if(u=t.bMarks[h]+t.tShift[h],i=t.eMarks[h],u>=i)break;if(t.src.charCodeAt(u++)===62&&!w){let D=t.sCount[h]+1,_,I;t.src.charCodeAt(u)===32?(u++,D++,I=!1,_=!0):t.src.charCodeAt(u)===9?(_=!0,(t.bsCount[h]+D)%4===3?(u++,D++,I=!1):I=!0):_=!1;let B=D;for(s.push(t.bMarks[h]),t.bMarks[h]=u;u<i;){const S=t.src.charCodeAt(u);if(F(S))S===9?B+=4-(B+t.bsCount[h]+(I?1:0))%4:B++;else break;u++}p=u>=i,l.push(t.bsCount[h]),t.bsCount[h]=t.sCount[h]+1+(_?1:0),a.push(t.sCount[h]),t.sCount[h]=B-D,c.push(t.tShift[h]),t.tShift[h]=u-t.bMarks[h];continue}if(p)break;let C=!1;for(let D=0,_=f.length;D<_;D++)if(f[D](t,h,n,!0)){C=!0;break}if(C){t.lineMax=h,t.blkIndent!==0&&(s.push(t.bMarks[h]),l.push(t.bsCount[h]),c.push(t.tShift[h]),a.push(t.sCount[h]),t.sCount[h]-=t.blkIndent);break}s.push(t.bMarks[h]),l.push(t.bsCount[h]),c.push(t.tShift[h]),a.push(t.sCount[h]),t.sCount[h]=-1}const m=t.blkIndent;t.blkIndent=0;const g=t.push("blockquote_open","blockquote",1);g.markup=">";const x=[e,0];g.map=x,t.md.block.tokenize(t,e,h);const y=t.push("blockquote_close","blockquote",-1);y.markup=">",t.lineMax=o,t.parentType=d,x[1]=t.line;for(let w=0;w<c.length;w++)t.bMarks[w+e]=s[w],t.tShift[w+e]=c[w],t.sCount[w+e]=a[w],t.bsCount[w+e]=l[w];return t.blkIndent=m,!0}function Y0(t,e,n,r){const u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let i=t.bMarks[e]+t.tShift[e];const o=t.src.charCodeAt(i++);if(o!==42&&o!==45&&o!==95)return!1;let s=1;for(;i<u;){const a=t.src.charCodeAt(i++);if(a!==o&&!F(a))return!1;a===o&&s++}if(s<3)return!1;if(r)return!0;t.line=e+1;const l=t.push("hr","hr",0);return l.map=[e,t.line],l.markup=Array(s+1).join(String.fromCharCode(o)),!0}function xo(t,e){const n=t.eMarks[e];let r=t.bMarks[e]+t.tShift[e];const u=t.src.charCodeAt(r++);if(u!==42&&u!==45&&u!==43)return-1;if(r<n){const i=t.src.charCodeAt(r);if(!F(i))return-1}return r}function yo(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];let u=n;if(u+1>=r)return-1;let i=t.src.charCodeAt(u++);if(i<48||i>57)return-1;for(;;){if(u>=r)return-1;if(i=t.src.charCodeAt(u++),i>=48&&i<=57){if(u-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return u<r&&(i=t.src.charCodeAt(u),!F(i))?-1:u}function ed(t,e){const n=t.level+2;for(let r=e+2,u=t.tokens.length-2;r<u;r++)t.tokens[r].level===n&&t.tokens[r].type==="paragraph_open"&&(t.tokens[r+2].hidden=!0,t.tokens[r].hidden=!0,r+=2)}function td(t,e,n,r){let u,i,o,s,l=e,a=!0;if(t.sCount[l]-t.blkIndent>=4||t.listIndent>=0&&t.sCount[l]-t.listIndent>=4&&t.sCount[l]<t.blkIndent)return!1;let c=!1;r&&t.parentType==="paragraph"&&t.sCount[l]>=t.blkIndent&&(c=!0);let f,d,p;if((p=yo(t,l))>=0){if(f=!0,o=t.bMarks[l]+t.tShift[l],d=Number(t.src.slice(o,p-1)),c&&d!==1)return!1}else if((p=xo(t,l))>=0)f=!1;else return!1;if(c&&t.skipSpaces(p)>=t.eMarks[l])return!1;if(r)return!0;const h=t.src.charCodeAt(p-1),m=t.tokens.length;f?(s=t.push("ordered_list_open","ol",1),d!==1&&(s.attrs=[["start",d]])):s=t.push("bullet_list_open","ul",1);const g=[l,0];s.map=g,s.markup=String.fromCharCode(h);let x=!1;const y=t.md.block.ruler.getRules("list"),w=t.parentType;for(t.parentType="list";l<n;){i=p,u=t.eMarks[l];const C=t.sCount[l]+p-(t.bMarks[l]+t.tShift[l]);let D=C;for(;i<u;){const Ae=t.src.charCodeAt(i);if(Ae===9)D+=4-(D+t.bsCount[l])%4;else if(Ae===32)D++;else break;i++}const _=i;let I;_>=u?I=1:I=D-C,I>4&&(I=1);const B=C+I;s=t.push("list_item_open","li",1),s.markup=String.fromCharCode(h);const S=[l,0];s.map=S,f&&(s.info=t.src.slice(o,p-1));const L=t.tight,se=t.tShift[l],O=t.sCount[l],Tn=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=B,t.tight=!0,t.tShift[l]=_-t.bMarks[l],t.sCount[l]=D,_>=u&&t.isEmpty(l+1)?t.line=Math.min(t.line+2,n):t.md.block.tokenize(t,l,n,!0),(!t.tight||x)&&(a=!1),x=t.line-l>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=Tn,t.tShift[l]=se,t.sCount[l]=O,t.tight=L,s=t.push("list_item_close","li",-1),s.markup=String.fromCharCode(h),l=t.line,S[1]=l,l>=n||t.sCount[l]<t.blkIndent||t.sCount[l]-t.blkIndent>=4)break;let rt=!1;for(let Ae=0,yt=y.length;Ae<yt;Ae++)if(y[Ae](t,l,n,!0)){rt=!0;break}if(rt)break;if(f){if(p=yo(t,l),p<0)break;o=t.bMarks[l]+t.tShift[l]}else if(p=xo(t,l),p<0)break;if(h!==t.src.charCodeAt(p-1))break}return f?s=t.push("ordered_list_close","ol",-1):s=t.push("bullet_list_close","ul",-1),s.markup=String.fromCharCode(h),g[1]=l,t.line=l,t.parentType=w,a&&ed(t,m),!0}function nd(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e],o=e+1;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(u)!==91)return!1;function s(y){const w=t.lineMax;if(y>=w||t.isEmpty(y))return null;let C=!1;if(t.sCount[y]-t.blkIndent>3&&(C=!0),t.sCount[y]<0&&(C=!0),!C){const I=t.md.block.ruler.getRules("reference"),B=t.parentType;t.parentType="reference";let S=!1;for(let L=0,se=I.length;L<se;L++)if(I[L](t,y,w,!0)){S=!0;break}if(t.parentType=B,S)return null}const D=t.bMarks[y]+t.tShift[y],_=t.eMarks[y];return t.src.slice(D,_+1)}let l=t.src.slice(u,i+1);i=l.length;let a=-1;for(u=1;u<i;u++){const y=l.charCodeAt(u);if(y===91)return!1;if(y===93){a=u;break}else if(y===10){const w=s(o);w!==null&&(l+=w,i=l.length,o++)}else if(y===92&&(u++,u<i&&l.charCodeAt(u)===10)){const w=s(o);w!==null&&(l+=w,i=l.length,o++)}}if(a<0||l.charCodeAt(a+1)!==58)return!1;for(u=a+2;u<i;u++){const y=l.charCodeAt(u);if(y===10){const w=s(o);w!==null&&(l+=w,i=l.length,o++)}else if(!F(y))break}const c=t.md.helpers.parseLinkDestination(l,u,i);if(!c.ok)return!1;const f=t.md.normalizeLink(c.str);if(!t.md.validateLink(f))return!1;u=c.pos;const d=u,p=o,h=u;for(;u<i;u++){const y=l.charCodeAt(u);if(y===10){const w=s(o);w!==null&&(l+=w,i=l.length,o++)}else if(!F(y))break}let m=t.md.helpers.parseLinkTitle(l,u,i);for(;m.can_continue;){const y=s(o);if(y===null)break;l+=y,u=i,i=l.length,o++,m=t.md.helpers.parseLinkTitle(l,u,i,m)}let g;for(u<i&&h!==u&&m.ok?(g=m.str,u=m.pos):(g="",u=d,o=p);u<i;){const y=l.charCodeAt(u);if(!F(y))break;u++}if(u<i&&l.charCodeAt(u)!==10&&g)for(g="",u=d,o=p;u<i;){const y=l.charCodeAt(u);if(!F(y))break;u++}if(u<i&&l.charCodeAt(u)!==10)return!1;const x=gr(l.slice(1,a));return x?(r||(typeof t.env.references>"u"&&(t.env.references={}),typeof t.env.references[x]>"u"&&(t.env.references[x]={title:g,href:f}),t.line=o),!0):!1}const rd=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ud="[a-zA-Z_:][a-zA-Z0-9:._-]*",id="[^\"'=<>`\\x00-\\x20]+",od="'[^']*'",sd='"[^"]*"',ld="(?:"+id+"|"+od+"|"+sd+")",ad="(?:\\s+"+ud+"(?:\\s*=\\s*"+ld+")?)",al="<[A-Za-z][A-Za-z0-9\\-]*"+ad+"*\\s*\\/?>",cl="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",cd="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",fd="<[?][\\s\\S]*?[?]>",dd="<![A-Za-z][^>]*>",hd="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",pd=new RegExp("^(?:"+al+"|"+cl+"|"+cd+"|"+fd+"|"+dd+"|"+hd+")"),md=new RegExp("^(?:"+al+"|"+cl+")"),wt=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+rd.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(md.source+"\\s*$"),/^$/,!1]];function gd(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||!t.md.options.html||t.src.charCodeAt(u)!==60)return!1;let o=t.src.slice(u,i),s=0;for(;s<wt.length&&!wt[s][0].test(o);s++);if(s===wt.length)return!1;if(r)return wt[s][2];let l=e+1;if(!wt[s][1].test(o)){for(;l<n&&!(t.sCount[l]<t.blkIndent);l++)if(u=t.bMarks[l]+t.tShift[l],i=t.eMarks[l],o=t.src.slice(u,i),wt[s][1].test(o)){o.length!==0&&l++;break}}t.line=l;const a=t.push("html_block","",0);return a.map=[e,l],a.content=t.getLines(e,l,t.blkIndent,!0),!0}function bd(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let o=t.src.charCodeAt(u);if(o!==35||u>=i)return!1;let s=1;for(o=t.src.charCodeAt(++u);o===35&&u<i&&s<=6;)s++,o=t.src.charCodeAt(++u);if(s>6||u<i&&!F(o))return!1;if(r)return!0;i=t.skipSpacesBack(i,u);const l=t.skipCharsBack(i,35,u);l>u&&F(t.src.charCodeAt(l-1))&&(i=l),t.line=e+1;const a=t.push("heading_open","h"+String(s),1);a.markup="########".slice(0,s),a.map=[e,t.line];const c=t.push("inline","",0);c.content=t.src.slice(u,i).trim(),c.map=[e,t.line],c.children=[];const f=t.push("heading_close","h"+String(s),-1);return f.markup="########".slice(0,s),!0}function xd(t,e,n){const r=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;const u=t.parentType;t.parentType="paragraph";let i=0,o,s=e+1;for(;s<n&&!t.isEmpty(s);s++){if(t.sCount[s]-t.blkIndent>3)continue;if(t.sCount[s]>=t.blkIndent){let p=t.bMarks[s]+t.tShift[s];const h=t.eMarks[s];if(p<h&&(o=t.src.charCodeAt(p),(o===45||o===61)&&(p=t.skipChars(p,o),p=t.skipSpaces(p),p>=h))){i=o===61?1:2;break}}if(t.sCount[s]<0)continue;let d=!1;for(let p=0,h=r.length;p<h;p++)if(r[p](t,s,n,!0)){d=!0;break}if(d)break}if(!i)return!1;const l=t.getLines(e,s,t.blkIndent,!1).trim();t.line=s+1;const a=t.push("heading_open","h"+String(i),1);a.markup=String.fromCharCode(o),a.map=[e,t.line];const c=t.push("inline","",0);c.content=l,c.map=[e,t.line-1],c.children=[];const f=t.push("heading_close","h"+String(i),-1);return f.markup=String.fromCharCode(o),t.parentType=u,!0}function yd(t,e,n){const r=t.md.block.ruler.getRules("paragraph"),u=t.parentType;let i=e+1;for(t.parentType="paragraph";i<n&&!t.isEmpty(i);i++){if(t.sCount[i]-t.blkIndent>3||t.sCount[i]<0)continue;let a=!1;for(let c=0,f=r.length;c<f;c++)if(r[c](t,i,n,!0)){a=!0;break}if(a)break}const o=t.getLines(e,i,t.blkIndent,!1).trim();t.line=i;const s=t.push("paragraph_open","p",1);s.map=[e,t.line];const l=t.push("inline","",0);return l.content=o,l.map=[e,t.line],l.children=[],t.push("paragraph_close","p",-1),t.parentType=u,!0}const Bn=[["table",G0,["paragraph","reference"]],["code",Z0],["fence",Q0,["paragraph","reference","blockquote","list"]],["blockquote",X0,["paragraph","reference","blockquote","list"]],["hr",Y0,["paragraph","reference","blockquote","list"]],["list",td,["paragraph","reference","blockquote"]],["reference",nd],["html_block",gd,["paragraph","reference","blockquote"]],["heading",bd,["paragraph","reference","blockquote"]],["lheading",xd],["paragraph",yd]];function br(){this.ruler=new ne;for(let t=0;t<Bn.length;t++)this.ruler.push(Bn[t][0],Bn[t][1],{alt:(Bn[t][2]||[]).slice()})}br.prototype.tokenize=function(t,e,n){const r=this.ruler.getRules(""),u=r.length,i=t.md.options.maxNesting;let o=e,s=!1;for(;o<n&&(t.line=o=t.skipEmptyLines(o),!(o>=n||t.sCount[o]<t.blkIndent));){if(t.level>=i){t.line=n;break}const l=t.line;let a=!1;for(let c=0;c<u;c++)if(a=r[c](t,o,n,!1),a){if(l>=t.line)throw new Error("block rule didn't increment state.line");break}if(!a)throw new Error("none of the block rules matched");t.tight=!s,t.isEmpty(t.line-1)&&(s=!0),o=t.line,o<n&&t.isEmpty(o)&&(s=!0,o++,t.line=o)}};br.prototype.parse=function(t,e,n,r){if(!t)return;const u=new this.State(t,e,n,r);this.tokenize(u,u.line,u.lineMax)};br.prototype.State=Se;function Mn(t,e,n,r){this.src=t,this.env=n,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Mn.prototype.pushPending=function(){const t=new ge("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t};Mn.prototype.push=function(t,e,n){this.pending&&this.pushPending();const r=new ge(t,e,n);let u=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],u={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(u),r};Mn.prototype.scanDelims=function(t,e){const n=this.posMax,r=this.src.charCodeAt(t),u=t>0?this.src.charCodeAt(t-1):32;let i=t;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const o=i-t,s=i<n?this.src.charCodeAt(i):32,l=bn(u)||gn(String.fromCharCode(u)),a=bn(s)||gn(String.fromCharCode(s)),c=mn(u),f=mn(s),d=!f&&(!a||c||l),p=!c&&(!l||f||a);return{can_open:d&&(e||!p||l),can_close:p&&(e||!d||a),length:o}};Mn.prototype.Token=ge;function kd(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function Cd(t,e){let n=t.pos;for(;n<t.posMax&&!kd(t.src.charCodeAt(n));)n++;return n===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}const wd=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function Dd(t,e){if(!t.md.options.linkify||t.linkLevel>0)return!1;const n=t.pos,r=t.posMax;if(n+3>r||t.src.charCodeAt(n)!==58||t.src.charCodeAt(n+1)!==47||t.src.charCodeAt(n+2)!==47)return!1;const u=t.pending.match(wd);if(!u)return!1;const i=u[1],o=t.md.linkify.matchAtStart(t.src.slice(n-i.length));if(!o)return!1;let s=o.url;if(s.length<=i.length)return!1;s=s.replace(/\*+$/,"");const l=t.md.normalizeLink(s);if(!t.md.validateLink(l))return!1;if(!e){t.pending=t.pending.slice(0,-i.length);const a=t.push("link_open","a",1);a.attrs=[["href",l]],a.markup="linkify",a.info="auto";const c=t.push("text","",0);c.content=t.md.normalizeLinkText(s);const f=t.push("link_close","a",-1);f.markup="linkify",f.info="auto"}return t.pos+=s.length-i.length,!0}function _d(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==10)return!1;const r=t.pending.length-1,u=t.posMax;if(!e)if(r>=0&&t.pending.charCodeAt(r)===32)if(r>=1&&t.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&t.pending.charCodeAt(i-1)===32;)i--;t.pending=t.pending.slice(0,i),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(n++;n<u&&F(t.src.charCodeAt(n));)n++;return t.pos=n,!0}const Xu=[];for(let t=0;t<256;t++)Xu.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){Xu[t.charCodeAt(0)]=1});function Ed(t,e){let n=t.pos;const r=t.posMax;if(t.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let u=t.src.charCodeAt(n);if(u===10){for(e||t.push("hardbreak","br",0),n++;n<r&&(u=t.src.charCodeAt(n),!!F(u));)n++;return t.pos=n,!0}let i=t.src[n];if(u>=55296&&u<=56319&&n+1<r){const s=t.src.charCodeAt(n+1);s>=56320&&s<=57343&&(i+=t.src[n+1],n++)}const o="\\"+i;if(!e){const s=t.push("text_special","",0);u<256&&Xu[u]!==0?s.content=i:s.content=o,s.markup=o,s.info="escape"}return t.pos=n+1,!0}function Sd(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==96)return!1;const u=n;n++;const i=t.posMax;for(;n<i&&t.src.charCodeAt(n)===96;)n++;const o=t.src.slice(u,n),s=o.length;if(t.backticksScanned&&(t.backticks[s]||0)<=u)return e||(t.pending+=o),t.pos+=s,!0;let l=n,a;for(;(a=t.src.indexOf("`",l))!==-1;){for(l=a+1;l<i&&t.src.charCodeAt(l)===96;)l++;const c=l-a;if(c===s){if(!e){const f=t.push("code_inline","code",0);f.markup=o,f.content=t.src.slice(n,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=l,!0}t.backticks[c]=a}return t.backticksScanned=!0,e||(t.pending+=o),t.pos+=s,!0}function Ad(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e||r!==126)return!1;const u=t.scanDelims(t.pos,!0);let i=u.length;const o=String.fromCharCode(r);if(i<2)return!1;let s;i%2&&(s=t.push("text","",0),s.content=o,i--);for(let l=0;l<i;l+=2)s=t.push("text","",0),s.content=o+o,t.delimiters.push({marker:r,length:0,token:t.tokens.length-1,end:-1,open:u.can_open,close:u.can_close});return t.pos+=u.length,!0}function ko(t,e){let n;const r=[],u=e.length;for(let i=0;i<u;i++){const o=e[i];if(o.marker!==126||o.end===-1)continue;const s=e[o.end];n=t.tokens[o.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=t.tokens[s.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",t.tokens[s.token-1].type==="text"&&t.tokens[s.token-1].content==="~"&&r.push(s.token-1)}for(;r.length;){const i=r.pop();let o=i+1;for(;o<t.tokens.length&&t.tokens[o].type==="s_close";)o++;o--,i!==o&&(n=t.tokens[o],t.tokens[o]=t.tokens[i],t.tokens[i]=n)}}function Md(t){const e=t.tokens_meta,n=t.tokens_meta.length;ko(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&ko(t,e[r].delimiters)}const fl={tokenize:Ad,postProcess:Md};function vd(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e||r!==95&&r!==42)return!1;const u=t.scanDelims(t.pos,r===42);for(let i=0;i<u.length;i++){const o=t.push("text","",0);o.content=String.fromCharCode(r),t.delimiters.push({marker:r,length:u.length,token:t.tokens.length-1,end:-1,open:u.can_open,close:u.can_close})}return t.pos+=u.length,!0}function Co(t,e){const n=e.length;for(let r=n-1;r>=0;r--){const u=e[r];if(u.marker!==95&&u.marker!==42||u.end===-1)continue;const i=e[u.end],o=r>0&&e[r-1].end===u.end+1&&e[r-1].marker===u.marker&&e[r-1].token===u.token-1&&e[u.end+1].token===i.token+1,s=String.fromCharCode(u.marker),l=t.tokens[u.token];l.type=o?"strong_open":"em_open",l.tag=o?"strong":"em",l.nesting=1,l.markup=o?s+s:s,l.content="";const a=t.tokens[i.token];a.type=o?"strong_close":"em_close",a.tag=o?"strong":"em",a.nesting=-1,a.markup=o?s+s:s,a.content="",o&&(t.tokens[e[r-1].token].content="",t.tokens[e[u.end+1].token].content="",r--)}}function Td(t){const e=t.tokens_meta,n=t.tokens_meta.length;Co(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Co(t,e[r].delimiters)}const dl={tokenize:vd,postProcess:Td};function Od(t,e){let n,r,u,i,o="",s="",l=t.pos,a=!0;if(t.src.charCodeAt(t.pos)!==91)return!1;const c=t.pos,f=t.posMax,d=t.pos+1,p=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(p<0)return!1;let h=p+1;if(h<f&&t.src.charCodeAt(h)===40){for(a=!1,h++;h<f&&(n=t.src.charCodeAt(h),!(!F(n)&&n!==10));h++);if(h>=f)return!1;if(l=h,u=t.md.helpers.parseLinkDestination(t.src,h,t.posMax),u.ok){for(o=t.md.normalizeLink(u.str),t.md.validateLink(o)?h=u.pos:o="",l=h;h<f&&(n=t.src.charCodeAt(h),!(!F(n)&&n!==10));h++);if(u=t.md.helpers.parseLinkTitle(t.src,h,t.posMax),h<f&&l!==h&&u.ok)for(s=u.str,h=u.pos;h<f&&(n=t.src.charCodeAt(h),!(!F(n)&&n!==10));h++);}(h>=f||t.src.charCodeAt(h)!==41)&&(a=!0),h++}if(a){if(typeof t.env.references>"u")return!1;if(h<f&&t.src.charCodeAt(h)===91?(l=h+1,h=t.md.helpers.parseLinkLabel(t,h),h>=0?r=t.src.slice(l,h++):h=p+1):h=p+1,r||(r=t.src.slice(d,p)),i=t.env.references[gr(r)],!i)return t.pos=c,!1;o=i.href,s=i.title}if(!e){t.pos=d,t.posMax=p;const m=t.push("link_open","a",1),g=[["href",o]];m.attrs=g,s&&g.push(["title",s]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=h,t.posMax=f,!0}function Fd(t,e){let n,r,u,i,o,s,l,a,c="";const f=t.pos,d=t.posMax;if(t.src.charCodeAt(t.pos)!==33||t.src.charCodeAt(t.pos+1)!==91)return!1;const p=t.pos+2,h=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(h<0)return!1;if(i=h+1,i<d&&t.src.charCodeAt(i)===40){for(i++;i<d&&(n=t.src.charCodeAt(i),!(!F(n)&&n!==10));i++);if(i>=d)return!1;for(a=i,s=t.md.helpers.parseLinkDestination(t.src,i,t.posMax),s.ok&&(c=t.md.normalizeLink(s.str),t.md.validateLink(c)?i=s.pos:c=""),a=i;i<d&&(n=t.src.charCodeAt(i),!(!F(n)&&n!==10));i++);if(s=t.md.helpers.parseLinkTitle(t.src,i,t.posMax),i<d&&a!==i&&s.ok)for(l=s.str,i=s.pos;i<d&&(n=t.src.charCodeAt(i),!(!F(n)&&n!==10));i++);else l="";if(i>=d||t.src.charCodeAt(i)!==41)return t.pos=f,!1;i++}else{if(typeof t.env.references>"u")return!1;if(i<d&&t.src.charCodeAt(i)===91?(a=i+1,i=t.md.helpers.parseLinkLabel(t,i),i>=0?u=t.src.slice(a,i++):i=h+1):i=h+1,u||(u=t.src.slice(p,h)),o=t.env.references[gr(u)],!o)return t.pos=f,!1;c=o.href,l=o.title}if(!e){r=t.src.slice(p,h);const m=[];t.md.inline.parse(r,t.md,t.env,m);const g=t.push("image","img",0),x=[["src",c],["alt",""]];g.attrs=x,g.children=m,g.content=r,l&&x.push(["title",l])}return t.pos=i,t.posMax=d,!0}const Nd=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Id=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function Rd(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==60)return!1;const r=t.pos,u=t.posMax;for(;;){if(++n>=u)return!1;const o=t.src.charCodeAt(n);if(o===60)return!1;if(o===62)break}const i=t.src.slice(r+1,n);if(Id.test(i)){const o=t.md.normalizeLink(i);if(!t.md.validateLink(o))return!1;if(!e){const s=t.push("link_open","a",1);s.attrs=[["href",o]],s.markup="autolink",s.info="auto";const l=t.push("text","",0);l.content=t.md.normalizeLinkText(i);const a=t.push("link_close","a",-1);a.markup="autolink",a.info="auto"}return t.pos+=i.length+2,!0}if(Nd.test(i)){const o=t.md.normalizeLink("mailto:"+i);if(!t.md.validateLink(o))return!1;if(!e){const s=t.push("link_open","a",1);s.attrs=[["href",o]],s.markup="autolink",s.info="auto";const l=t.push("text","",0);l.content=t.md.normalizeLinkText(i);const a=t.push("link_close","a",-1);a.markup="autolink",a.info="auto"}return t.pos+=i.length+2,!0}return!1}function zd(t){return/^<a[>\s]/i.test(t)}function Bd(t){return/^<\/a\s*>/i.test(t)}function Pd(t){const e=t|32;return e>=97&&e<=122}function Ld(t,e){if(!t.md.options.html)return!1;const n=t.posMax,r=t.pos;if(t.src.charCodeAt(r)!==60||r+2>=n)return!1;const u=t.src.charCodeAt(r+1);if(u!==33&&u!==63&&u!==47&&!Pd(u))return!1;const i=t.src.slice(r).match(pd);if(!i)return!1;if(!e){const o=t.push("html_inline","",0);o.content=i[0],zd(o.content)&&t.linkLevel++,Bd(o.content)&&t.linkLevel--}return t.pos+=i[0].length,!0}const qd=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Vd=/^&([a-z][a-z0-9]{1,31});/i;function $d(t,e){const n=t.pos,r=t.posMax;if(t.src.charCodeAt(n)!==38||n+1>=r)return!1;if(t.src.charCodeAt(n+1)===35){const i=t.src.slice(n).match(qd);if(i){if(!e){const o=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),s=t.push("text_special","",0);s.content=Zu(o)?rr(o):rr(65533),s.markup=i[0],s.info="entity"}return t.pos+=i[0].length,!0}}else{const i=t.src.slice(n).match(Vd);if(i){const o=ul(i[0]);if(o!==i[0]){if(!e){const s=t.push("text_special","",0);s.content=o,s.markup=i[0],s.info="entity"}return t.pos+=i[0].length,!0}}}return!1}function wo(t){const e={},n=t.length;if(!n)return;let r=0,u=-2;const i=[];for(let o=0;o<n;o++){const s=t[o];if(i.push(0),(t[r].marker!==s.marker||u!==s.token-1)&&(r=o),u=s.token,s.length=s.length||0,!s.close)continue;e.hasOwnProperty(s.marker)||(e[s.marker]=[-1,-1,-1,-1,-1,-1]);const l=e[s.marker][(s.open?3:0)+s.length%3];let a=r-i[r]-1,c=a;for(;a>l;a-=i[a]+1){const f=t[a];if(f.marker===s.marker&&f.open&&f.end<0){let d=!1;if((f.close||s.open)&&(f.length+s.length)%3===0&&(f.length%3!==0||s.length%3!==0)&&(d=!0),!d){const p=a>0&&!t[a-1].open?i[a-1]+1:0;i[o]=o-a+p,i[a]=p,s.open=!1,f.end=o,f.close=!1,c=-1,u=-2;break}}}c!==-1&&(e[s.marker][(s.open?3:0)+(s.length||0)%3]=c)}}function Hd(t){const e=t.tokens_meta,n=t.tokens_meta.length;wo(t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&wo(e[r].delimiters)}function Wd(t){let e,n,r=0;const u=t.tokens,i=t.tokens.length;for(e=n=0;e<i;e++)u[e].nesting<0&&r--,u[e].level=r,u[e].nesting>0&&r++,u[e].type==="text"&&e+1<i&&u[e+1].type==="text"?u[e+1].content=u[e].content+u[e+1].content:(e!==n&&(u[n]=u[e]),n++);e!==n&&(u.length=n)}const zr=[["text",Cd],["linkify",Dd],["newline",_d],["escape",Ed],["backticks",Sd],["strikethrough",fl.tokenize],["emphasis",dl.tokenize],["link",Od],["image",Fd],["autolink",Rd],["html_inline",Ld],["entity",$d]],Br=[["balance_pairs",Hd],["strikethrough",fl.postProcess],["emphasis",dl.postProcess],["fragments_join",Wd]];function vn(){this.ruler=new ne;for(let t=0;t<zr.length;t++)this.ruler.push(zr[t][0],zr[t][1]);this.ruler2=new ne;for(let t=0;t<Br.length;t++)this.ruler2.push(Br[t][0],Br[t][1])}vn.prototype.skipToken=function(t){const e=t.pos,n=this.ruler.getRules(""),r=n.length,u=t.md.options.maxNesting,i=t.cache;if(typeof i[e]<"u"){t.pos=i[e];return}let o=!1;if(t.level<u){for(let s=0;s<r;s++)if(t.level++,o=n[s](t,!0),t.level--,o){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;o||t.pos++,i[e]=t.pos};vn.prototype.tokenize=function(t){const e=this.ruler.getRules(""),n=e.length,r=t.posMax,u=t.md.options.maxNesting;for(;t.pos<r;){const i=t.pos;let o=!1;if(t.level<u){for(let s=0;s<n;s++)if(o=e[s](t,!1),o){if(i>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}if(o){if(t.pos>=r)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};vn.prototype.parse=function(t,e,n,r){const u=new this.State(t,e,n,r);this.tokenize(u);const i=this.ruler2.getRules(""),o=i.length;for(let s=0;s<o;s++)i[s](u)};vn.prototype.State=Mn;function jd(t){const e={};t=t||{},e.src_Any=Ys.source,e.src_Cc=el.source,e.src_Z=nl.source,e.src_P=Ku.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const n="[><]";return e.src_pseudo_letter="(?:(?!"+n+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+n+"|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function wu(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){t[r]=n[r]})}),t}function xr(t){return Object.prototype.toString.call(t)}function Jd(t){return xr(t)==="[object String]"}function Ud(t){return xr(t)==="[object Object]"}function Kd(t){return xr(t)==="[object RegExp]"}function Do(t){return xr(t)==="[object Function]"}function Gd(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const hl={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function Zd(t){return Object.keys(t||{}).reduce(function(e,n){return e||hl.hasOwnProperty(n)},!1)}const Qd={"http:":{validate:function(t,e,n){const r=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){const r=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?e>=3&&t[e-3]===":"||e>=3&&t[e-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){const r=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},Xd="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Yd="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function eh(t){t.__index__=-1,t.__text_cache__=""}function th(t){return function(e,n){const r=e.slice(n);return t.test(r)?r.match(t)[0].length:0}}function _o(){return function(t,e){e.normalize(t)}}function ur(t){const e=t.re=jd(t.__opts__),n=t.__tlds__.slice();t.onCompile(),t.__tlds_replaced__||n.push(Xd),n.push(e.src_xn),e.src_tlds=n.join("|");function r(s){return s.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const u=[];t.__compiled__={};function i(s,l){throw new Error('(LinkifyIt) Invalid schema "'+s+'": '+l)}Object.keys(t.__schemas__).forEach(function(s){const l=t.__schemas__[s];if(l===null)return;const a={validate:null,link:null};if(t.__compiled__[s]=a,Ud(l)){Kd(l.validate)?a.validate=th(l.validate):Do(l.validate)?a.validate=l.validate:i(s,l),Do(l.normalize)?a.normalize=l.normalize:l.normalize?i(s,l):a.normalize=_o();return}if(Jd(l)){u.push(s);return}i(s,l)}),u.forEach(function(s){t.__compiled__[t.__schemas__[s]]&&(t.__compiled__[s].validate=t.__compiled__[t.__schemas__[s]].validate,t.__compiled__[s].normalize=t.__compiled__[t.__schemas__[s]].normalize)}),t.__compiled__[""]={validate:null,normalize:_o()};const o=Object.keys(t.__compiled__).filter(function(s){return s.length>0&&t.__compiled__[s]}).map(Gd).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+o+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+o+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),eh(t)}function nh(t,e){const n=t.__index__,r=t.__last_index__,u=t.__text_cache__.slice(n,r);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=r+e,this.raw=u,this.text=u,this.url=u}function Du(t,e){const n=new nh(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function oe(t,e){if(!(this instanceof oe))return new oe(t,e);e||Zd(t)&&(e=t,t={}),this.__opts__=wu({},hl,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=wu({},Qd,t),this.__compiled__={},this.__tlds__=Yd,this.__tlds_replaced__=!1,this.re={},ur(this)}oe.prototype.add=function(e,n){return this.__schemas__[e]=n,ur(this),this};oe.prototype.set=function(e){return this.__opts__=wu(this.__opts__,e),this};oe.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let n,r,u,i,o,s,l,a,c;if(this.re.schema_test.test(e)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(e))!==null;)if(i=this.testSchemaAt(e,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(a=e.search(this.re.host_fuzzy_test),a>=0&&(this.__index__<0||a<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(o=r.index+r[1].length,(this.__index__<0||o<this.__index__)&&(this.__schema__="",this.__index__=o,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&(u=e.match(this.re.email_fuzzy))!==null&&(o=u.index+u[1].length,s=u.index+u[0].length,(this.__index__<0||o<this.__index__||o===this.__index__&&s>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=o,this.__last_index__=s))),this.__index__>=0};oe.prototype.pretest=function(e){return this.re.pretest.test(e)};oe.prototype.testSchemaAt=function(e,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(e,r,this):0};oe.prototype.match=function(e){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===e&&(n.push(Du(this,r)),r=this.__last_index__);let u=r?e.slice(r):e;for(;this.test(u);)n.push(Du(this,r)),u=u.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};oe.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const n=this.re.schema_at_start.exec(e);if(!n)return null;const r=this.testSchemaAt(e,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,Du(this,0)):null};oe.prototype.tlds=function(e,n){return e=Array.isArray(e)?e:[e],n?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,u,i){return r!==i[u-1]}).reverse(),ur(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,ur(this),this)};oe.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};oe.prototype.onCompile=function(){};const Ot=2147483647,Ce=36,Yu=1,xn=26,rh=38,uh=700,pl=72,ml=128,gl="-",ih=/^xn--/,oh=/[^\0-\x7F]/,sh=/[\x2E\u3002\uFF0E\uFF61]/g,lh={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Pr=Ce-Yu,we=Math.floor,Lr=String.fromCharCode;function Le(t){throw new RangeError(lh[t])}function ah(t,e){const n=[];let r=t.length;for(;r--;)n[r]=e(t[r]);return n}function bl(t,e){const n=t.split("@");let r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(sh,".");const u=t.split("."),i=ah(u,e).join(".");return r+i}function xl(t){const e=[];let n=0;const r=t.length;for(;n<r;){const u=t.charCodeAt(n++);if(u>=55296&&u<=56319&&n<r){const i=t.charCodeAt(n++);(i&64512)==56320?e.push(((u&1023)<<10)+(i&1023)+65536):(e.push(u),n--)}else e.push(u)}return e}const ch=t=>String.fromCodePoint(...t),fh=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:Ce},Eo=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},yl=function(t,e,n){let r=0;for(t=n?we(t/uh):t>>1,t+=we(t/e);t>Pr*xn>>1;r+=Ce)t=we(t/Pr);return we(r+(Pr+1)*t/(t+rh))},kl=function(t){const e=[],n=t.length;let r=0,u=ml,i=pl,o=t.lastIndexOf(gl);o<0&&(o=0);for(let s=0;s<o;++s)t.charCodeAt(s)>=128&&Le("not-basic"),e.push(t.charCodeAt(s));for(let s=o>0?o+1:0;s<n;){const l=r;for(let c=1,f=Ce;;f+=Ce){s>=n&&Le("invalid-input");const d=fh(t.charCodeAt(s++));d>=Ce&&Le("invalid-input"),d>we((Ot-r)/c)&&Le("overflow"),r+=d*c;const p=f<=i?Yu:f>=i+xn?xn:f-i;if(d<p)break;const h=Ce-p;c>we(Ot/h)&&Le("overflow"),c*=h}const a=e.length+1;i=yl(r-l,a,l==0),we(r/a)>Ot-u&&Le("overflow"),u+=we(r/a),r%=a,e.splice(r++,0,u)}return String.fromCodePoint(...e)},Cl=function(t){const e=[];t=xl(t);const n=t.length;let r=ml,u=0,i=pl;for(const l of t)l<128&&e.push(Lr(l));const o=e.length;let s=o;for(o&&e.push(gl);s<n;){let l=Ot;for(const c of t)c>=r&&c<l&&(l=c);const a=s+1;l-r>we((Ot-u)/a)&&Le("overflow"),u+=(l-r)*a,r=l;for(const c of t)if(c<r&&++u>Ot&&Le("overflow"),c===r){let f=u;for(let d=Ce;;d+=Ce){const p=d<=i?Yu:d>=i+xn?xn:d-i;if(f<p)break;const h=f-p,m=Ce-p;e.push(Lr(Eo(p+h%m,0))),f=we(h/m)}e.push(Lr(Eo(f,0))),i=yl(u,a,s===o),u=0,++s}++u,++r}return e.join("")},dh=function(t){return bl(t,function(e){return ih.test(e)?kl(e.slice(4).toLowerCase()):e})},hh=function(t){return bl(t,function(e){return oh.test(e)?"xn--"+Cl(e):e})},wl={version:"2.3.1",ucs2:{decode:xl,encode:ch},decode:kl,encode:Cl,toASCII:hh,toUnicode:dh},ph={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},mh={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},gh={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},bh={default:ph,zero:mh,commonmark:gh},xh=/^(vbscript|javascript|file|data):/,yh=/^data:image\/(gif|png|jpeg|webp);/;function kh(t){const e=t.trim().toLowerCase();return xh.test(e)?yh.test(e):!0}const Dl=["http:","https:","mailto:"];function Ch(t){const e=Uu(t,!0);if(e.hostname&&(!e.protocol||Dl.indexOf(e.protocol)>=0))try{e.hostname=wl.toASCII(e.hostname)}catch{}return An(Ju(e))}function wh(t){const e=Uu(t,!0);if(e.hostname&&(!e.protocol||Dl.indexOf(e.protocol)>=0))try{e.hostname=wl.toUnicode(e.hostname)}catch{}return Rt(Ju(e),Rt.defaultChars+"%")}function de(t,e){if(!(this instanceof de))return new de(t,e);e||Gu(t)||(e=t||{},t="default"),this.inline=new vn,this.block=new br,this.core=new Qu,this.renderer=new Lt,this.linkify=new oe,this.validateLink=kh,this.normalizeLink=Ch,this.normalizeLinkText=wh,this.utils=_0,this.helpers=mr({},M0),this.options={},this.configure(t),e&&this.set(e)}de.prototype.set=function(t){return mr(this.options,t),this};de.prototype.configure=function(t){const e=this;if(Gu(t)){const n=t;if(t=bh[n],!t)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enableOnly(t.components[n].rules),t.components[n].rules2&&e[n].ruler2.enableOnly(t.components[n].rules2)}),this};de.prototype.enable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(u){n=n.concat(this[u].ruler.enable(t,!0))},this),n=n.concat(this.inline.ruler2.enable(t,!0));const r=t.filter(function(u){return n.indexOf(u)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};de.prototype.disable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(u){n=n.concat(this[u].ruler.disable(t,!0))},this),n=n.concat(this.inline.ruler2.disable(t,!0));const r=t.filter(function(u){return n.indexOf(u)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};de.prototype.use=function(t){const e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this};de.prototype.parse=function(t,e){if(typeof t!="string")throw new Error("Input data should be a String");const n=new this.core.State(t,this,e);return this.core.process(n),n.tokens};de.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};de.prototype.parseInline=function(t,e){const n=new this.core.State(t,this,e);return n.inlineMode=!0,this.core.process(n),n.tokens};de.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};const ut=new xa({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(t){return["h"+t.attrs.level,0]}},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:t=>({params:t.getAttribute("data-params")||""})}],toDOM(t){return["pre",t.attrs.params?{"data-params":t.attrs.params}:{},["code",0]]}},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs(t){return{order:t.hasAttribute("start")?+t.getAttribute("start"):1,tight:t.hasAttribute("data-tight")}}}],toDOM(t){return["ol",{start:t.attrs.order==1?null:t.attrs.order,"data-tight":t.attrs.tight?"true":null},0]}},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:t=>({tight:t.hasAttribute("data-tight")})}],toDOM(t){return["ul",{"data-tight":t.attrs.tight?"true":null},0]}},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM(){return["li",0]}},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs(t){return{src:t.getAttribute("src"),title:t.getAttribute("title"),alt:t.getAttribute("alt")}}}],toDOM(t){return["img",t.attrs]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return["br"]}}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:t=>t.type.name=="em"}],toDOM(){return["em"]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name=="strong"},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],toDOM(){return["strong"]}},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(t){return{href:t.getAttribute("href"),title:t.getAttribute("title")}}}],toDOM(t){return["a",t.attrs]}},code:{parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}});function Dh(t,e){if(t.isText&&e.isText&&v.sameSet(t.marks,e.marks))return t.withText(t.text+e.text)}class _h{constructor(e,n){this.schema=e,this.tokenHandlers=n,this.stack=[{type:e.topNodeType,attrs:null,content:[],marks:v.none}]}top(){return this.stack[this.stack.length-1]}push(e){this.stack.length&&this.top().content.push(e)}addText(e){if(!e)return;let n=this.top(),r=n.content,u=r[r.length-1],i=this.schema.text(e,n.marks),o;u&&(o=Dh(u,i))?r[r.length-1]=o:r.push(i)}openMark(e){let n=this.top();n.marks=e.addToSet(n.marks)}closeMark(e){let n=this.top();n.marks=e.removeFromSet(n.marks)}parseTokens(e){for(let n=0;n<e.length;n++){let r=e[n],u=this.tokenHandlers[r.type];if(!u)throw new Error("Token type `"+r.type+"` not supported by Markdown parser");u(this,r,e,n)}}addNode(e,n,r){let u=this.top(),i=e.createAndFill(n,r,u?u.marks:[]);return i?(this.push(i),i):null}openNode(e,n){this.stack.push({type:e,attrs:n,content:[],marks:v.none})}closeNode(){let e=this.stack.pop();return this.addNode(e.type,e.attrs,e.content)}}function Wt(t,e,n,r){return t.getAttrs?t.getAttrs(e,n,r):t.attrs instanceof Function?t.attrs(e):t.attrs}function qr(t,e){return t.noCloseToken||e=="code_inline"||e=="code_block"||e=="fence"}function So(t){return t[t.length-1]==`
`?t.slice(0,t.length-1):t}function Vr(){}function Eh(t,e){let n=Object.create(null);for(let r in e){let u=e[r];if(u.block){let i=t.nodeType(u.block);qr(u,r)?n[r]=(o,s,l,a)=>{o.openNode(i,Wt(u,s,l,a)),o.addText(So(s.content)),o.closeNode()}:(n[r+"_open"]=(o,s,l,a)=>o.openNode(i,Wt(u,s,l,a)),n[r+"_close"]=o=>o.closeNode())}else if(u.node){let i=t.nodeType(u.node);n[r]=(o,s,l,a)=>o.addNode(i,Wt(u,s,l,a))}else if(u.mark){let i=t.marks[u.mark];qr(u,r)?n[r]=(o,s,l,a)=>{o.openMark(i.create(Wt(u,s,l,a))),o.addText(So(s.content)),o.closeMark(i)}:(n[r+"_open"]=(o,s,l,a)=>o.openMark(i.create(Wt(u,s,l,a))),n[r+"_close"]=o=>o.closeMark(i))}else if(u.ignore)qr(u,r)?n[r]=Vr:(n[r+"_open"]=Vr,n[r+"_close"]=Vr);else throw new RangeError("Unrecognized parsing spec "+JSON.stringify(u))}return n.text=(r,u)=>r.addText(u.content),n.inline=(r,u)=>r.parseTokens(u.children),n.softbreak=n.softbreak||(r=>r.addText(" ")),n}class Sh{constructor(e,n,r){this.schema=e,this.tokenizer=n,this.tokens=r,this.tokenHandlers=Eh(e,r)}parse(e,n={}){let r=new _h(this.schema,this.tokenHandlers),u;r.parseTokens(this.tokenizer.parse(e,n));do u=r.closeNode();while(r.stack.length);return u||this.schema.topNodeType.createAndFill()}}function Ao(t,e){for(;++e<t.length;)if(t[e].type!="list_item_open")return t[e].hidden;return!1}const $r=new Sh(ut,de("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:(t,e,n)=>({tight:Ao(e,n)})},ordered_list:{block:"ordered_list",getAttrs:(t,e,n)=>({order:+t.attrGet("start")||1,tight:Ao(e,n)})},heading:{block:"heading",getAttrs:t=>({level:+t.tag.slice(1)})},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:t=>({params:t.info||""}),noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:t=>({src:t.attrGet("src"),title:t.attrGet("title")||null,alt:t.children[0]&&t.children[0].content||null})},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:t=>({href:t.attrGet("href"),title:t.attrGet("title")||null})},code_inline:{mark:"code",noCloseToken:!0}});var et={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ir={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ah=typeof navigator<"u"&&/Mac/.test(navigator.platform),Mh=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var j=0;j<10;j++)et[48+j]=et[96+j]=String(j);for(var j=1;j<=24;j++)et[j+111]="F"+j;for(var j=65;j<=90;j++)et[j]=String.fromCharCode(j+32),ir[j]=String.fromCharCode(j);for(var Hr in et)ir.hasOwnProperty(Hr)||(ir[Hr]=et[Hr]);function vh(t){var e=Ah&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Mh&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?ir:et)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const Th=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Oh(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,u,i,o;for(let s=0;s<e.length-1;s++){let l=e[s];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))u=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Th?o=!0:u=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),u&&(n="Ctrl-"+n),o&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function Fh(t){let e=Object.create(null);for(let n in t)e[Oh(n)]=t[n];return e}function Wr(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function Mo(t){return new xt({props:{handleKeyDown:_l(t)}})}function _l(t){let e=Fh(t);return function(n,r){let u=vh(r),i,o=e[Wr(u,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(u.length==1&&u!=" "){if(r.shiftKey){let s=e[Wr(u,r,!1)];if(s&&s(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||u.charCodeAt(0)>127)&&(i=et[r.keyCode])&&i!=u){let s=e[Wr(i,r)];if(s&&s(n.state,n.dispatch,n))return!0}}return!1}}var or=200,$=function(){};$.prototype.append=function(e){return e.length?(e=$.from(e),!this.length&&e||e.length<or&&this.leafAppend(e)||this.length<or&&e.leafPrepend(this)||this.appendInner(e)):this};$.prototype.prepend=function(e){return e.length?$.from(e).append(this):this};$.prototype.appendInner=function(e){return new Nh(this,e)};$.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?$.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};$.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};$.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};$.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var u=[];return this.forEach(function(i,o){return u.push(e(i,o))},n,r),u};$.from=function(e){return e instanceof $?e:e&&e.length?new El(e):$.empty};var El=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(u,i){return u==0&&i==this.length?this:new e(this.values.slice(u,i))},e.prototype.getInner=function(u){return this.values[u]},e.prototype.forEachInner=function(u,i,o,s){for(var l=i;l<o;l++)if(u(this.values[l],s+l)===!1)return!1},e.prototype.forEachInvertedInner=function(u,i,o,s){for(var l=i-1;l>=o;l--)if(u(this.values[l],s+l)===!1)return!1},e.prototype.leafAppend=function(u){if(this.length+u.length<=or)return new e(this.values.concat(u.flatten()))},e.prototype.leafPrepend=function(u){if(this.length+u.length<=or)return new e(u.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}($);$.empty=new El([]);var Nh=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,u,i,o){var s=this.left.length;if(u<s&&this.left.forEachInner(r,u,Math.min(i,s),o)===!1||i>s&&this.right.forEachInner(r,Math.max(u-s,0),Math.min(this.length,i)-s,o+s)===!1)return!1},e.prototype.forEachInvertedInner=function(r,u,i,o){var s=this.left.length;if(u>s&&this.right.forEachInvertedInner(r,u-s,Math.max(i,s)-s,o+s)===!1||i<s&&this.left.forEachInvertedInner(r,Math.min(u,s),i,o)===!1)return!1},e.prototype.sliceInner=function(r,u){if(r==0&&u==this.length)return this;var i=this.left.length;return u<=i?this.left.slice(r,u):r>=i?this.right.slice(r-i,u-i):this.left.slice(r,i).append(this.right.slice(0,u-i))},e.prototype.leafAppend=function(r){var u=this.right.leafAppend(r);if(u)return new e(this.left,u)},e.prototype.leafPrepend=function(r){var u=this.left.leafPrepend(r);if(u)return new e(u,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}($);const Ih=500;class pe{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let u,i;n&&(u=this.remapping(r,this.items.length),i=u.maps.length);let o=e.tr,s,l,a=[],c=[];return this.items.forEach((f,d)=>{if(!f.step){u||(u=this.remapping(r,d+1),i=u.maps.length),i--,c.push(f);return}if(u){c.push(new xe(f.map));let p=f.step.map(u.slice(i)),h;p&&o.maybeStep(p).doc&&(h=o.mapping.maps[o.mapping.maps.length-1],a.push(new xe(h,void 0,void 0,a.length+c.length))),i--,h&&u.appendMap(h,i)}else o.maybeStep(f.step);if(f.selection)return s=u?f.selection.map(u.slice(i)):f.selection,l=new pe(this.items.slice(0,r).append(c.reverse().concat(a)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:s}}addTransform(e,n,r,u){let i=[],o=this.eventCount,s=this.items,l=!u&&s.length?s.get(s.length-1):null;for(let c=0;c<e.steps.length;c++){let f=e.steps[c].invert(e.docs[c]),d=new xe(e.mapping.maps[c],f,n),p;(p=l&&l.merge(d))&&(d=p,c?i.pop():s=s.slice(0,s.length-1)),i.push(d),n&&(o++,n=void 0),u||(l=d)}let a=o-r.depth;return a>zh&&(s=Rh(s,a),o-=a),new pe(s.append(i),o)}remapping(e,n){let r=new At;return this.items.forEach((u,i)=>{let o=u.mirrorOffset!=null&&i-u.mirrorOffset>=e?r.maps.length-u.mirrorOffset:void 0;r.appendMap(u.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new pe(this.items.append(e.map(n=>new xe(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],u=Math.max(0,this.items.length-n),i=e.mapping,o=e.steps.length,s=this.eventCount;this.items.forEach(d=>{d.selection&&s--},u);let l=n;this.items.forEach(d=>{let p=i.getMirror(--l);if(p==null)return;o=Math.min(o,p);let h=i.maps[p];if(d.step){let m=e.steps[p].invert(e.docs[p]),g=d.selection&&d.selection.map(i.slice(l+1,p));g&&s++,r.push(new xe(h,m,g))}else r.push(new xe(h))},u);let a=[];for(let d=n;d<o;d++)a.push(new xe(i.maps[d]));let c=this.items.slice(0,u).append(a).append(r),f=new pe(c,s);return f.emptyItemCount()>Ih&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,u=[],i=0;return this.items.forEach((o,s)=>{if(s>=e)u.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(n.slice(r)),a=l&&l.getMap();if(r--,a&&n.appendMap(a,r),l){let c=o.selection&&o.selection.map(n.slice(r));c&&i++;let f=new xe(a.invert(),l,c),d,p=u.length-1;(d=u.length&&u[p].merge(f))?u[p]=d:u.push(f)}}else o.map&&r--},this.items.length,0),new pe($.from(u.reverse()),i)}}pe.empty=new pe($.empty,0);function Rh(t,e){let n;return t.forEach((r,u)=>{if(r.selection&&e--==0)return n=u,!1}),t.slice(n)}class xe{constructor(e,n,r,u){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=u}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new xe(n.getMap().invert(),n,this.selection)}}}class qe{constructor(e,n,r,u,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=u,this.prevComposition=i}}const zh=20;function Bh(t,e,n,r){let u=n.getMeta(pt),i;if(u)return u.historyState;n.getMeta(qh)&&(t=new qe(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(pt))return o.getMeta(pt).redo?new qe(t.done.addTransform(n,void 0,r,Hn(e)),t.undone,vo(n.mapping.maps),t.prevTime,t.prevComposition):new qe(t.done,t.undone.addTransform(n,void 0,r,Hn(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let s=n.getMeta("composition"),l=t.prevTime==0||!o&&t.prevComposition!=s&&(t.prevTime<(n.time||0)-r.newGroupDelay||!Ph(n,t.prevRanges)),a=o?jr(t.prevRanges,n.mapping):vo(n.mapping.maps);return new qe(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,Hn(e)),pe.empty,a,n.time,s??t.prevComposition)}else return(i=n.getMeta("rebased"))?new qe(t.done.rebased(n,i),t.undone.rebased(n,i),jr(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new qe(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),jr(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function Ph(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,u)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&u>=e[i]&&(n=!0)}),n}function vo(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,u,i,o)=>e.push(i,o));return e}function jr(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let u=e.map(t[r],1),i=e.map(t[r+1],-1);u<=i&&n.push(u,i)}return n}function Lh(t,e,n){let r=Hn(e),u=pt.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),s=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),u,r),l=new qe(n?s:i.remaining,n?i.remaining:s,null,0,-1);return i.transform.setSelection(o).setMeta(pt,{redo:n,historyState:l})}let Jr=!1,To=null;function Hn(t){let e=t.plugins;if(To!=e){Jr=!1,To=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Jr=!0;break}}return Jr}const pt=new ys("history"),qh=new ys("closeHistory");function Vh(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new xt({key:pt,state:{init(){return new qe(pe.empty,pe.empty,null,0,-1)},apply(e,n,r){return Bh(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,u=r=="historyUndo"?sr:r=="historyRedo"?yn:null;return u?(n.preventDefault(),u(e.state,e.dispatch)):!1}}}})}function Sl(t,e){return(n,r)=>{let u=pt.getState(n);if(!u||(t?u.undone:u.done).eventCount==0)return!1;if(r){let i=Lh(u,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const sr=Sl(!1,!0),yn=Sl(!0,!0),Al=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function $h(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Hh=(t,e,n)=>{let r=$h(t,n);if(!r)return!1;let u=Ml(r);if(!u){let o=r.blockRange(),s=o&&Dn(o);return s==null?!1:(e&&e(t.tr.lift(o,s).scrollIntoView()),!0)}let i=u.nodeBefore;if(!i.type.spec.isolating&&Ol(t,u,e))return!0;if(r.parent.content.size==0&&(Bt(i,"end")||E.isSelectable(i))){let o=zu(t.doc,r.before(),r.after(),k.empty);if(o&&o.slice.size<o.to-o.from){if(e){let s=t.tr.step(o);s.setSelection(Bt(i,"end")?M.findFrom(s.doc.resolve(s.mapping.map(u.pos,-1)),-1):E.create(s.doc,u.pos-i.nodeSize)),e(s.scrollIntoView())}return!0}}return i.isAtom&&u.depth==r.depth-1?(e&&e(t.tr.delete(u.pos-i.nodeSize,u.pos).scrollIntoView()),!0):!1};function Bt(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const Wh=(t,e,n)=>{let{$head:r,empty:u}=t.selection,i=r;if(!u)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=Ml(r)}let o=i&&i.nodeBefore;return!o||!E.isSelectable(o)?!1:(e&&e(t.tr.setSelection(E.create(t.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function Ml(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function jh(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Jh=(t,e,n)=>{let r=jh(t,n);if(!r)return!1;let u=vl(r);if(!u)return!1;let i=u.nodeAfter;if(Ol(t,u,e))return!0;if(r.parent.content.size==0&&(Bt(i,"start")||E.isSelectable(i))){let o=zu(t.doc,r.before(),r.after(),k.empty);if(o&&o.slice.size<o.to-o.from){if(e){let s=t.tr.step(o);s.setSelection(Bt(i,"start")?M.findFrom(s.doc.resolve(s.mapping.map(u.pos)),1):E.create(s.doc,s.mapping.map(u.pos))),e(s.scrollIntoView())}return!0}}return i.isAtom&&u.depth==r.depth-1?(e&&e(t.tr.delete(u.pos,u.pos+i.nodeSize).scrollIntoView()),!0):!1},Uh=(t,e,n)=>{let{$head:r,empty:u}=t.selection,i=r;if(!u)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=vl(r)}let o=i&&i.nodeAfter;return!o||!E.isSelectable(o)?!1:(e&&e(t.tr.setSelection(E.create(t.doc,i.pos)).scrollIntoView()),!0)};function vl(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const _u=(t,e)=>{let n=t.selection,r=n instanceof E,u;if(r){if(n.node.isTextblock||!Pt(t.doc,n.from))return!1;u=n.from}else if(u=fs(t.doc,n.from,-1),u==null)return!1;if(e){let i=t.tr.join(u);r&&i.setSelection(E.create(i.doc,u-t.doc.resolve(u).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},Kh=(t,e)=>{let n=t.selection,r;if(n instanceof E){if(n.node.isTextblock||!Pt(t.doc,n.to))return!1;r=n.to}else if(r=fs(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},Eu=(t,e)=>{let{$from:n,$to:r}=t.selection,u=n.blockRange(r),i=u&&Dn(u);return i==null?!1:(e&&e(t.tr.lift(u,i).scrollIntoView()),!0)},Gh=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function ei(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const Tl=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let u=n.node(-1),i=n.indexAfter(-1),o=ei(u.contentMatchAt(i));if(!o||!u.canReplaceWith(i,i,o))return!1;if(e){let s=n.after(),l=t.tr.replaceWith(s,s,o.createAndFill());l.setSelection(M.near(l.doc.resolve(s),1)),e(l.scrollIntoView())}return!0},Zh=(t,e)=>{let n=t.selection,{$from:r,$to:u}=n;if(n instanceof ue||r.parent.inlineContent||u.parent.inlineContent)return!1;let i=ei(u.parent.contentMatchAt(u.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&u.index()<u.parent.childCount?r:u).pos,s=t.tr.insert(o,i.createAndFill());s.setSelection(T.create(s.doc,o+1)),e(s.scrollIntoView())}return!0},Qh=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(Mt(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let r=n.blockRange(),u=r&&Dn(r);return u==null?!1:(e&&e(t.tr.lift(r,u).scrollIntoView()),!0)};function Xh(t){return(e,n)=>{let{$from:r,$to:u}=e.selection;if(e.selection instanceof E&&e.selection.node.isBlock)return!r.parentOffset||!Mt(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(n){let i=u.parentOffset==u.parent.content.size,o=e.tr;(e.selection instanceof T||e.selection instanceof ue)&&o.deleteSelection();let s=r.depth==0?null:ei(r.node(-1).contentMatchAt(r.indexAfter(-1))),l=i&&s?[{type:s}]:void 0,a=Mt(o.doc,o.mapping.map(r.pos),1,l);if(!l&&!a&&Mt(o.doc,o.mapping.map(r.pos),1,s?[{type:s}]:void 0)&&(s&&(l=[{type:s}]),a=!0),a&&(o.split(o.mapping.map(r.pos),1,l),!i&&!r.parentOffset&&r.parent.type!=s)){let c=o.mapping.map(r.before()),f=o.doc.resolve(c);s&&r.node(-1).canReplaceWith(f.index(),f.index()+1,s)&&o.setNodeMarkup(o.mapping.map(r.before()),s)}n(o.scrollIntoView())}return!0}}const Yh=Xh(),Su=(t,e)=>{let{$from:n,to:r}=t.selection,u,i=n.sharedDepth(r);return i==0?!1:(u=n.before(i),e&&e(t.tr.setSelection(E.create(t.doc,u))),!0)},ep=(t,e)=>(e&&e(t.tr.setSelection(new ue(t.doc))),!0);function tp(t,e,n){let r=e.nodeBefore,u=e.nodeAfter,i=e.index();return!r||!u||!r.type.compatibleContent(u.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(u.isTextblock||Pt(t.doc,e.pos))?!1:(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function Ol(t,e,n){let r=e.nodeBefore,u=e.nodeAfter,i,o;if(r.type.spec.isolating||u.type.spec.isolating)return!1;if(tp(t,e,n))return!0;let s=e.parent.canReplace(e.index(),e.index()+1);if(s&&(i=(o=r.contentMatchAt(r.childCount)).findWrapping(u.type))&&o.matchType(i[0]||u.type).validEnd){if(n){let f=e.pos+u.nodeSize,d=b.empty;for(let m=i.length-1;m>=0;m--)d=b.from(i[m].create(null,d));d=b.from(r.copy(d));let p=t.tr.step(new J(e.pos-1,f,e.pos,f,new k(d,1,0),i.length,!0)),h=f+2*i.length;Pt(p.doc,h)&&p.join(h),n(p.scrollIntoView())}return!0}let l=M.findFrom(e,1),a=l&&l.$from.blockRange(l.$to),c=a&&Dn(a);if(c!=null&&c>=e.depth)return n&&n(t.tr.lift(a,c).scrollIntoView()),!0;if(s&&Bt(u,"start",!0)&&Bt(r,"end")){let f=r,d=[];for(;d.push(f),!f.isTextblock;)f=f.lastChild;let p=u,h=1;for(;!p.isTextblock;p=p.firstChild)h++;if(f.canReplace(f.childCount,f.childCount,p.content)){if(n){let m=b.empty;for(let x=d.length-1;x>=0;x--)m=b.from(d[x].copy(m));let g=t.tr.step(new J(e.pos-d.length,e.pos+u.nodeSize,e.pos+h,e.pos+u.nodeSize-h,new k(m,d.length,0),0,!0));n(g.scrollIntoView())}return!0}}return!1}function Fl(t){return function(e,n){let r=e.selection,u=t<0?r.$from:r.$to,i=u.depth;for(;u.node(i).isInline;){if(!i)return!1;i--}return u.node(i).isTextblock?(n&&n(e.tr.setSelection(T.create(e.doc,t<0?u.start(i):u.end(i)))),!0):!1}}const np=Fl(-1),rp=Fl(1);function Au(t,e=null){return function(n,r){let{$from:u,$to:i}=n.selection,o=u.blockRange(i),s=o&&Ru(o,t,e);return s?(r&&r(n.tr.wrap(o,s).scrollIntoView()),!0):!1}}function Wn(t,e=null){return function(n,r){let u=!1;for(let i=0;i<n.selection.ranges.length&&!u;i++){let{$from:{pos:o},$to:{pos:s}}=n.selection.ranges[i];n.doc.nodesBetween(o,s,(l,a)=>{if(u)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)u=!0;else{let c=n.doc.resolve(a),f=c.index();u=c.parent.canReplaceWith(f,f+1,t)}})}if(!u)return!1;if(r){let i=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:s},$to:{pos:l}}=n.selection.ranges[o];i.setBlockType(s,l,t,e)}r(i.scrollIntoView())}return!0}}function up(t,e,n){for(let r=0;r<e.length;r++){let{$from:u,$to:i}=e[r],o=u.depth==0?t.inlineContent&&t.type.allowsMarkType(n):!1;if(t.nodesBetween(u.pos,i.pos,s=>{if(o)return!1;o=s.inlineContent&&s.type.allowsMarkType(n)}),o)return!0}return!1}function He(t,e=null){return function(n,r){let{empty:u,$cursor:i,ranges:o}=n.selection;if(u&&!i||!up(n.doc,o,t))return!1;if(r)if(i)t.isInSet(n.storedMarks||i.marks())?r(n.tr.removeStoredMark(t)):r(n.tr.addStoredMark(t.create(e)));else{let s=!1,l=n.tr;for(let a=0;!s&&a<o.length;a++){let{$from:c,$to:f}=o[a];s=n.doc.rangeHasMark(c.pos,f.pos,t)}for(let a=0;a<o.length;a++){let{$from:c,$to:f}=o[a];if(s)l.removeMark(c.pos,f.pos,t);else{let d=c.pos,p=f.pos,h=c.nodeAfter,m=f.nodeBefore,g=h&&h.isText?/^\s*/.exec(h.text)[0].length:0,x=m&&m.isText?/\s*$/.exec(m.text)[0].length:0;d+g<p&&(d+=g,p-=x),l.addMark(d,p,t.create(e))}}r(l.scrollIntoView())}return!0}}function yr(...t){return function(e,n,r){for(let u=0;u<t.length;u++)if(t[u](e,n,r))return!0;return!1}}let Ur=yr(Al,Hh,Wh),Oo=yr(Al,Jh,Uh);const Oe={Enter:yr(Gh,Zh,Qh,Yh),"Mod-Enter":Tl,Backspace:Ur,"Mod-Backspace":Ur,"Shift-Backspace":Ur,Delete:Oo,"Mod-Delete":Oo,"Mod-a":ep},Nl={"Ctrl-h":Oe.Backspace,"Alt-Backspace":Oe["Mod-Backspace"],"Ctrl-d":Oe.Delete,"Ctrl-Alt-Backspace":Oe["Mod-Delete"],"Alt-Delete":Oe["Mod-Delete"],"Alt-d":Oe["Mod-Delete"],"Ctrl-a":np,"Ctrl-e":rp};for(let t in Oe)Nl[t]=Oe[t];const ip=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,op=ip?Nl:Oe;function sp(t={}){return new xt({view(e){return new lp(e,t)}})}class lp{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(u=>{let i=o=>{this[u](o)};return e.dom.addEventListener(u,i),{name:u,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r;if(n){let s=e.nodeBefore,l=e.nodeAfter;if(s||l){let a=this.editorView.nodeDOM(this.cursorPos-(s?s.nodeSize:0));if(a){let c=a.getBoundingClientRect(),f=s?c.bottom:c.top;s&&l&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:c.left,right:c.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!r){let s=this.editorView.coordsAtPos(this.cursorPos);r={left:s.left-this.width/2,right:s.left+this.width/2,top:s.top,bottom:s.bottom}}let u=this.editorView.dom.offsetParent;this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let i,o;if(!u||u==document.body&&getComputedStyle(u).position=="static")i=-pageXOffset,o=-pageYOffset;else{let s=u.getBoundingClientRect();i=s.left-u.scrollLeft,o=s.top-u.scrollTop}this.element.style.left=r.left-i+"px",this.element.style.top=r.top-o+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),u=r&&r.type.spec.disableDropCursor,i=typeof u=="function"?u(this.editorView,n,e):u;if(n&&!i){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let s=ds(this.editorView.state.doc,o,this.editorView.dragging.slice);s!=null&&(o=s)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}class R extends M{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return R.valid(r)?new R(r):M.near(r)}content(){return k.empty}eq(e){return e instanceof R&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new R(e.resolve(n.pos))}getBookmark(){return new ti(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!ap(e)||!cp(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let u=n.contentMatchAt(e.index()).defaultType;return u&&u.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&R.valid(e))return e;let u=e.pos,i=null;for(let o=e.depth;;o--){let s=e.node(o);if(n>0?e.indexAfter(o)<s.childCount:e.index(o)>0){i=s.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;u+=n;let l=e.doc.resolve(u);if(R.valid(l))return l}for(;;){let o=n>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!E.isSelectable(i)){e=e.doc.resolve(u+i.nodeSize*n),r=!1;continue e}break}i=o,u+=n;let s=e.doc.resolve(u);if(R.valid(s))return s}return null}}}R.prototype.visible=!1;R.findFrom=R.findGapCursorFrom;M.jsonID("gapcursor",R);class ti{constructor(e){this.pos=e}map(e){return new ti(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return R.valid(n)?new R(n):M.near(n)}}function ap(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let u=r.child(n-1);;u=u.lastChild){if(u.childCount==0&&!u.inlineContent||u.isAtom||u.type.spec.isolating)return!0;if(u.inlineContent)return!1}}return!0}function cp(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let u=r.child(n);;u=u.firstChild){if(u.childCount==0&&!u.inlineContent||u.isAtom||u.type.spec.isolating)return!0;if(u.inlineContent)return!1}}return!0}function fp(){return new xt({props:{decorations:mp,createSelectionBetween(t,e,n){return e.pos==n.pos&&R.valid(n)?new R(n):null},handleClick:hp,handleKeyDown:dp,handleDOMEvents:{beforeinput:pp}}})}const dp=_l({ArrowLeft:Pn("horiz",-1),ArrowRight:Pn("horiz",1),ArrowUp:Pn("vert",-1),ArrowDown:Pn("vert",1)});function Pn(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,u,i){let o=r.selection,s=e>0?o.$to:o.$from,l=o.empty;if(o instanceof T){if(!i.endOfTextblock(n)||s.depth==0)return!1;l=!1,s=r.doc.resolve(e>0?s.after():s.before())}let a=R.findGapCursorFrom(s,e,l);return a?(u&&u(r.tr.setSelection(new R(a))),!0):!1}}function hp(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!R.valid(r))return!1;let u=t.posAtCoords({left:n.clientX,top:n.clientY});return u&&u.inside>-1&&E.isSelectable(t.state.doc.nodeAt(u.inside))?!1:(t.dispatch(t.state.tr.setSelection(new R(r))),!0)}function pp(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof R))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let u=b.empty;for(let o=r.length-1;o>=0;o--)u=b.from(r[o].createAndFill(null,u));let i=t.state.tr.replace(n.pos,n.pos,new k(u,0,0));return i.setSelection(T.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function mp(t){if(!(t.selection instanceof R))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",P.create(t.doc,[ce.widget(t.selection.head,e,{key:"gapcursor"})])}function ie(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var u=n[r];typeof u=="string"?t.setAttribute(r,u):u!=null&&(t[r]=u)}e++}for(;e<arguments.length;e++)Il(t,arguments[e]);return t}function Il(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)Il(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const nn="http://www.w3.org/2000/svg",gp="http://www.w3.org/1999/xlink",Mu="ProseMirror-icon";function bp(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n)|0;return e}function xp(t,e){let n=(t.nodeType==9?t:t.ownerDocument)||document,r=n.createElement("div");if(r.className=Mu,e.path){let{path:u,width:i,height:o}=e,s="pm-icon-"+bp(u).toString(16);n.getElementById(s)||yp(t,s,e);let l=r.appendChild(n.createElementNS(nn,"svg"));l.style.width=i/o+"em",l.appendChild(n.createElementNS(nn,"use")).setAttributeNS(gp,"href",/([^#]*)/.exec(n.location.toString())[1]+"#"+s)}else if(e.dom)r.appendChild(e.dom.cloneNode(!0));else{let{text:u,css:i}=e;r.appendChild(n.createElement("span")).textContent=u||"",i&&(r.firstChild.style.cssText=i)}return r}function yp(t,e,n){let[r,u]=t.nodeType==9?[t,t.body]:[t.ownerDocument||document,t],i=r.getElementById(Mu+"-collection");i||(i=r.createElementNS(nn,"svg"),i.id=Mu+"-collection",i.style.display="none",u.insertBefore(i,u.firstChild));let o=r.createElementNS(nn,"symbol");o.id=e,o.setAttribute("viewBox","0 0 "+n.width+" "+n.height),o.appendChild(r.createElementNS(nn,"path")).setAttribute("d",n.path),i.appendChild(o)}const ee="ProseMirror-menu";class be{constructor(e){this.spec=e}render(e){let n=this.spec,r=n.render?n.render(e):n.icon?xp(e.root,n.icon):n.label?ie("div",null,kn(e,n.label)):null;if(!r)throw new RangeError("MenuItem without icon or label property");if(n.title){const i=typeof n.title=="function"?n.title(e.state):n.title;r.setAttribute("title",kn(e,i))}n.class&&r.classList.add(n.class),n.css&&(r.style.cssText+=n.css),r.addEventListener("mousedown",i=>{i.preventDefault(),r.classList.contains(ee+"-disabled")||n.run(e.state,e.dispatch,e,i)});function u(i){if(n.select){let s=n.select(i);if(r.style.display=s?"":"none",!s)return!1}let o=!0;if(n.enable&&(o=n.enable(i)||!1,vu(r,ee+"-disabled",!o)),n.active){let s=o&&n.active(i)||!1;vu(r,ee+"-active",s)}return!0}return{dom:r,update:u}}}function kn(t,e){return t._props.translate?t._props.translate(e):e}let rn={time:0,node:null};function Rl(t){rn.time=Date.now(),rn.node=t.target}function zl(t){return Date.now()-100<rn.time&&rn.node&&t.contains(rn.node)}class Fo{constructor(e,n={}){this.options=n,this.options=n||{},this.content=Array.isArray(e)?e:[e]}render(e){let n=Bl(this.content,e),r=e.dom.ownerDocument.defaultView||window,u=ie("div",{class:ee+"-dropdown "+(this.options.class||""),style:this.options.css},kn(e,this.options.label||""));this.options.title&&u.setAttribute("title",kn(e,this.options.title));let i=ie("div",{class:ee+"-dropdown-wrap"},u),o=null,s=null,l=()=>{o&&o.close()&&(o=null,r.removeEventListener("mousedown",s))};u.addEventListener("mousedown",c=>{c.preventDefault(),Rl(c),o?l():(o=this.expand(i,n.dom),r.addEventListener("mousedown",s=()=>{zl(i)||l()}))});function a(c){let f=n.update(c);return i.style.display=f?"":"none",f}return{dom:i,update:a}}expand(e,n){let r=ie("div",{class:ee+"-dropdown-menu "+(this.options.class||"")},n),u=!1;function i(){return u?!1:(u=!0,e.removeChild(r),!0)}return e.appendChild(r),{close:i,node:r}}}function Bl(t,e){let n=[],r=[];for(let u=0;u<t.length;u++){let{dom:i,update:o}=t[u].render(e);n.push(ie("div",{class:ee+"-dropdown-item"},i)),r.push(o)}return{dom:n,update:Pl(r,n)}}function Pl(t,e){return n=>{let r=!1;for(let u=0;u<t.length;u++){let i=t[u](n);e[u].style.display=i?"":"none",i&&(r=!0)}return r}}class kp{constructor(e,n={}){this.options=n,this.content=Array.isArray(e)?e:[e]}render(e){let n=Bl(this.content,e),r=e.dom.ownerDocument.defaultView||window,u=ie("div",{class:ee+"-submenu-label"},kn(e,this.options.label||"")),i=ie("div",{class:ee+"-submenu-wrap"},u,ie("div",{class:ee+"-submenu"},n.dom)),o=null;u.addEventListener("mousedown",l=>{l.preventDefault(),Rl(l),vu(i,ee+"-submenu-wrap-active",!1),o||r.addEventListener("mousedown",o=()=>{zl(i)||(i.classList.remove(ee+"-submenu-wrap-active"),r.removeEventListener("mousedown",o),o=null)})});function s(l){let a=n.update(l);return i.style.display=a?"":"none",a}return{dom:i,update:s}}}function Cp(t,e){let n=document.createDocumentFragment(),r=[],u=[];for(let o=0;o<e.length;o++){let s=e[o],l=[],a=[];for(let c=0;c<s.length;c++){let{dom:f,update:d}=s[c].render(t),p=ie("span",{class:ee+"item"},f);n.appendChild(p),a.push(p),l.push(d)}l.length&&(r.push(Pl(l,a)),o<e.length-1&&u.push(n.appendChild(wp())))}function i(o){let s=!1,l=!1;for(let a=0;a<r.length;a++){let c=r[a](o);a&&(u[a-1].style.display=l&&c?"":"none"),l=c,c&&(s=!0)}return s}return{dom:n,update:i}}function wp(){return ie("span",{class:ee+"separator"})}const ae={join:{width:800,height:900,path:"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z"},lift:{width:1024,height:1024,path:"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z"},selectParentNode:{text:"",css:"font-weight: bold"},undo:{width:1024,height:1024,path:"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z"},redo:{width:1024,height:1024,path:"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z"},strong:{width:805,height:1024,path:"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z"},em:{width:585,height:1024,path:"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z"},code:{width:896,height:1024,path:"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z"},link:{width:951,height:1024,path:"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z"},bulletList:{width:768,height:896,path:"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z"},orderedList:{width:768,height:896,path:"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z"},blockquote:{width:640,height:896,path:"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z"}},Dp=new be({title:"Join with above block",run:_u,select:t=>_u(t),icon:ae.join}),_p=new be({title:"Lift out of enclosing block",run:Eu,select:t=>Eu(t),icon:ae.lift}),Ep=new be({title:"Select parent node",run:Su,select:t=>Su(t),icon:ae.selectParentNode});let Sp=new be({title:"Undo last change",run:sr,enable:t=>sr(t),icon:ae.undo}),Ap=new be({title:"Redo last undone change",run:yn,enable:t=>yn(t),icon:ae.redo});function Mp(t,e){let n={run(r,u){return Au(t,e.attrs)(r,u)},select(r){return Au(t,e.attrs)(r)}};for(let r in e)n[r]=e[r];return new be(n)}function Kr(t,e){let n=Wn(t,e.attrs),r={run:n,enable(u){return n(u)},active(u){let{$from:i,to:o,node:s}=u.selection;return s?s.hasMarkup(t,e.attrs):o<=i.end()&&i.parent.hasMarkup(t,e.attrs)}};for(let u in e)r[u]=e[u];return new be(r)}function vu(t,e,n){n?t.classList.add(e):t.classList.remove(e)}const Ln="ProseMirror-menubar";function vp(){if(typeof navigator>"u")return!1;let t=navigator.userAgent;return!/Edge\/\d/.test(t)&&/AppleWebKit/.test(t)&&/Mobile\/\w+/.test(t)}function Tp(t){return new xt({view(e){return new Op(e,t)}})}class Op{constructor(e,n){this.editorView=e,this.options=n,this.spacer=null,this.maxHeight=0,this.widthForMaxHeight=0,this.floating=!1,this.scrollHandler=null,this.wrapper=ie("div",{class:Ln+"-wrapper"}),this.menu=this.wrapper.appendChild(ie("div",{class:Ln})),this.menu.className=Ln,e.dom.parentNode&&e.dom.parentNode.replaceChild(this.wrapper,e.dom),this.wrapper.appendChild(e.dom);let{dom:r,update:u}=Cp(this.editorView,this.options.content);if(this.contentUpdate=u,this.menu.appendChild(r),this.update(),n.floating&&!vp()){this.updateFloat();let i=Ip(this.wrapper);this.scrollHandler=o=>{let s=this.editorView.root;(s.body||s).contains(this.wrapper)?this.updateFloat(o.target.getBoundingClientRect?o.target:void 0):i.forEach(l=>l.removeEventListener("scroll",this.scrollHandler))},i.forEach(o=>o.addEventListener("scroll",this.scrollHandler))}}update(){this.contentUpdate(this.editorView.state),this.floating?this.updateScrollCursor():(this.menu.offsetWidth!=this.widthForMaxHeight&&(this.widthForMaxHeight=this.menu.offsetWidth,this.maxHeight=0),this.menu.offsetHeight>this.maxHeight&&(this.maxHeight=this.menu.offsetHeight,this.menu.style.minHeight=this.maxHeight+"px"))}updateScrollCursor(){let e=this.editorView.root.getSelection();if(!e.focusNode)return;let n=e.getRangeAt(0).getClientRects(),r=n[Fp(e)?0:n.length-1];if(!r)return;let u=this.menu.getBoundingClientRect();if(r.top<u.bottom&&r.bottom>u.top){let i=Np(this.wrapper);i&&(i.scrollTop-=u.bottom-r.top)}}updateFloat(e){let n=this.wrapper,r=n.getBoundingClientRect(),u=e?Math.max(0,e.getBoundingClientRect().top):0;if(this.floating)if(r.top>=u||r.bottom<this.menu.offsetHeight+10)this.floating=!1,this.menu.style.position=this.menu.style.left=this.menu.style.top=this.menu.style.width="",this.menu.style.display="",this.spacer.parentNode.removeChild(this.spacer),this.spacer=null;else{let i=(n.offsetWidth-n.clientWidth)/2;this.menu.style.left=r.left+i+"px",this.menu.style.display=r.top>(this.editorView.dom.ownerDocument.defaultView||window).innerHeight?"none":"",e&&(this.menu.style.top=u+"px")}else if(r.top<u&&r.bottom>=this.menu.offsetHeight+10){this.floating=!0;let i=this.menu.getBoundingClientRect();this.menu.style.left=i.left+"px",this.menu.style.width=i.width+"px",e&&(this.menu.style.top=u+"px"),this.menu.style.position="fixed",this.spacer=ie("div",{class:Ln+"-spacer",style:`height: ${i.height}px`}),n.insertBefore(this.spacer,this.menu)}}destroy(){this.wrapper.parentNode&&this.wrapper.parentNode.replaceChild(this.editorView.dom,this.wrapper)}}function Fp(t){return t.anchorNode==t.focusNode?t.anchorOffset>t.focusOffset:t.anchorNode.compareDocumentPosition(t.focusNode)==Node.DOCUMENT_POSITION_FOLLOWING}function Np(t){for(let e=t.parentNode;e;e=e.parentNode)if(e.scrollHeight>e.clientHeight)return e}function Ip(t){let e=[t.ownerDocument.defaultView||window];for(let n=t.parentNode;n;n=n.parentNode)e.push(n);return e}function Tu(t,e=null){return function(n,r){let{$from:u,$to:i}=n.selection,o=u.blockRange(i),s=!1,l=o;if(!o)return!1;if(o.depth>=2&&u.node(o.depth-1).type.compatibleContent(t)&&o.startIndex==0){if(u.index(o.depth-1)==0)return!1;let c=n.doc.resolve(o.start-2);l=new Kn(c,c,o.depth),o.endIndex<o.parent.childCount&&(o=new Kn(u,n.doc.resolve(i.end(o.depth)),o.depth)),s=!0}let a=Ru(l,t,e,o);return a?(r&&r(Rp(n.tr,o,a,s,t).scrollIntoView()),!0):!1}}function Rp(t,e,n,r,u){let i=b.empty;for(let c=n.length-1;c>=0;c--)i=b.from(n[c].type.create(n[c].attrs,i));t.step(new J(e.start-(r?2:0),e.end,e.start,e.end,new k(i,0,0),n.length,!0));let o=0;for(let c=0;c<n.length;c++)n[c].type==u&&(o=c+1);let s=n.length-o,l=e.start+n.length-(r?2:0),a=e.parent;for(let c=e.startIndex,f=e.endIndex,d=!0;c<f;c++,d=!1)!d&&Mt(t.doc,l,s)&&(t.split(l,s),l+=2*s),l+=a.child(c).nodeSize;return t}function zp(t,e){return function(n,r){let{$from:u,$to:i,node:o}=n.selection;if(o&&o.isBlock||u.depth<2||!u.sameParent(i))return!1;let s=u.node(-1);if(s.type!=t)return!1;if(u.parent.content.size==0&&u.node(-1).childCount==u.indexAfter(-1)){if(u.depth==3||u.node(-3).type!=t||u.index(-2)!=u.node(-2).childCount-1)return!1;if(r){let f=b.empty,d=u.index(-1)?1:u.index(-2)?2:3;for(let x=u.depth-d;x>=u.depth-3;x--)f=b.from(u.node(x).copy(f));let p=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3;f=f.append(b.from(t.createAndFill()));let h=u.before(u.depth-(d-1)),m=n.tr.replace(h,u.after(-p),new k(f,4-d,0)),g=-1;m.doc.nodesBetween(h,m.doc.content.size,(x,y)=>{if(g>-1)return!1;x.isTextblock&&x.content.size==0&&(g=y+1)}),g>-1&&m.setSelection(M.near(m.doc.resolve(g))),r(m.scrollIntoView())}return!0}let l=i.pos==u.end()?s.contentMatchAt(0).defaultType:null,a=n.tr.delete(u.pos,i.pos),c=l?[null,{type:l}]:void 0;return Mt(a.doc,u.pos,2,c)?(r&&r(a.split(u.pos,2,c).scrollIntoView()),!0):!1}}function Bp(t){return function(e,n){let{$from:r,$to:u}=e.selection,i=r.blockRange(u,o=>o.childCount>0&&o.firstChild.type==t);return i?n?r.node(i.depth-1).type==t?Pp(e,n,t,i):Lp(e,n,i):!0:!1}}function Pp(t,e,n,r){let u=t.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(u.step(new J(i-1,o,i,o,new k(b.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Kn(u.doc.resolve(r.$from.pos),u.doc.resolve(o),r.depth));const s=Dn(r);if(s==null)return!1;u.lift(r,s);let l=u.mapping.map(i,-1)-1;return Pt(u.doc,l)&&u.join(l),e(u.scrollIntoView()),!0}function Lp(t,e,n){let r=t.tr,u=n.parent;for(let p=n.end,h=n.endIndex-1,m=n.startIndex;h>m;h--)p-=u.child(h).nodeSize,r.delete(p-1,p+1);let i=r.doc.resolve(n.start),o=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let s=n.startIndex==0,l=n.endIndex==u.childCount,a=i.node(-1),c=i.index(-1);if(!a.canReplace(c+(s?0:1),c+1,o.content.append(l?b.empty:b.from(u))))return!1;let f=i.pos,d=f+o.nodeSize;return r.step(new J(f-(s?1:0),d+(l?1:0),f+1,d-1,new k((s?b.empty:b.from(u.copy(b.empty))).append(l?b.empty:b.from(u.copy(b.empty))),s?0:1,l?0:1),s?0:1)),e(r.scrollIntoView()),!0}function qp(t){return function(e,n){let{$from:r,$to:u}=e.selection,i=r.blockRange(u,a=>a.childCount>0&&a.firstChild.type==t);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let s=i.parent,l=s.child(o-1);if(l.type!=t)return!1;if(n){let a=l.lastChild&&l.lastChild.type==s.type,c=b.from(a?t.create():null),f=new k(b.from(t.create(null,b.from(s.type.create(null,c)))),a?3:1,0),d=i.start,p=i.end;n(e.tr.step(new J(d-(a?3:1),p,d,p,f,1,!0)).scrollIntoView())}return!0}}class nt{constructor(e,n,r={}){this.match=e,this.match=e,this.handler=typeof n=="string"?Vp(n):n,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1}}function Vp(t){return function(e,n,r,u){let i=t;if(n[1]){let o=n[0].lastIndexOf(n[1]);i+=n[0].slice(o+n[1].length),r+=o;let s=r-u;s>0&&(i=n[0].slice(o-s,o)+i,r=u)}return e.tr.insertText(i,r,u)}}const $p=500;function Hp({rules:t}){let e=new xt({state:{init(){return null},apply(n,r){let u=n.getMeta(this);return u||(n.selectionSet||n.docChanged?null:r)}},props:{handleTextInput(n,r,u,i){return No(n,r,u,i,t,e)},handleDOMEvents:{compositionend:n=>{setTimeout(()=>{let{$cursor:r}=n.state.selection;r&&No(n,r.pos,r.pos,"",t,e)})}}},isInputRules:!0});return e}function No(t,e,n,r,u,i){if(t.composing)return!1;let o=t.state,s=o.doc.resolve(e),l=s.parent.textBetween(Math.max(0,s.parentOffset-$p),s.parentOffset,null,"")+r;for(let a=0;a<u.length;a++){let c=u[a];if(s.parent.type.spec.code){if(!c.inCode)continue}else if(c.inCode==="only")continue;let f=c.match.exec(l),d=f&&c.handler(o,f,e-(f[0].length-r.length),n);if(d)return c.undoable&&d.setMeta(i,{transform:d,from:e,to:n,text:r}),t.dispatch(d),!0}return!1}const Wp=(t,e)=>{let n=t.plugins;for(let r=0;r<n.length;r++){let u=n[r],i;if(u.spec.isInputRules&&(i=u.getState(t))){if(e){let o=t.tr,s=i.transform;for(let l=s.steps.length-1;l>=0;l--)o.step(s.steps[l].invert(s.docs[l]));if(i.text){let l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,t.schema.text(i.text,l))}else o.delete(i.from,i.to);e(o)}return!0}}return!1},jp=new nt(/--$/,""),Jp=new nt(/\.\.\.$/,""),Up=new nt(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,""),Kp=new nt(/"$/,""),Gp=new nt(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,""),Zp=new nt(/'$/,""),Qp=[Up,Kp,Gp,Zp];function ni(t,e,n=null,r){return new nt(t,(u,i,o,s)=>{let l=n instanceof Function?n(i):n,a=u.tr.delete(o,s),c=a.doc.resolve(o),f=c.blockRange(),d=f&&Ru(f,e,l);if(!d)return null;a.wrap(f,d);let p=a.doc.resolve(o-1).nodeBefore;return p&&p.type==e&&Pt(a.doc,o-1)&&(!r||r(i,p))&&a.join(o-1),a})}function Ll(t,e,n=null){return new nt(t,(r,u,i,o)=>{let s=r.doc.resolve(i),l=n instanceof Function?n(u):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e)?r.tr.delete(i,o).setBlockType(i,i,e,l):null})}const qn="ProseMirror-prompt";function ql(t){let e=document.body.appendChild(document.createElement("div"));e.className=qn;let n=d=>{e.contains(d.target)||r()};setTimeout(()=>window.addEventListener("mousedown",n),50);let r=()=>{window.removeEventListener("mousedown",n),e.parentNode&&e.parentNode.removeChild(e)},u=[];for(let d in t.fields)u.push(t.fields[d].render());let i=document.createElement("button");i.type="submit",i.className=qn+"-submit",i.textContent="OK";let o=document.createElement("button");o.type="button",o.className=qn+"-cancel",o.textContent="Cancel",o.addEventListener("click",r);let s=e.appendChild(document.createElement("form"));t.title&&(s.appendChild(document.createElement("h5")).textContent=t.title),u.forEach(d=>{s.appendChild(document.createElement("div")).appendChild(d)});let l=s.appendChild(document.createElement("div"));l.className=qn+"-buttons",l.appendChild(i),l.appendChild(document.createTextNode(" ")),l.appendChild(o);let a=e.getBoundingClientRect();e.style.top=(window.innerHeight-a.height)/2+"px",e.style.left=(window.innerWidth-a.width)/2+"px";let c=()=>{let d=Xp(t.fields,u);d&&(r(),t.callback(d))};s.addEventListener("submit",d=>{d.preventDefault(),c()}),s.addEventListener("keydown",d=>{d.keyCode==27?(d.preventDefault(),r()):d.keyCode==13&&!(d.ctrlKey||d.metaKey||d.shiftKey)?(d.preventDefault(),c()):d.keyCode==9&&window.setTimeout(()=>{e.contains(document.activeElement)||r()},500)});let f=s.elements[0];f&&f.focus()}function Xp(t,e){let n=Object.create(null),r=0;for(let u in t){let i=t[u],o=e[r++],s=i.read(o),l=i.validate(s);if(l)return Yp(o,l),null;n[u]=i.clean(s)}return n}function Yp(t,e){let n=t.parentNode,r=n.appendChild(document.createElement("div"));r.style.left=t.offsetLeft+t.offsetWidth+2+"px",r.style.top=t.offsetTop-5+"px",r.className="ProseMirror-invalid",r.textContent=e,setTimeout(()=>n.removeChild(r),1500)}class e1{constructor(e){this.options=e}read(e){return e.value}validateType(e){return null}validate(e){return!e&&this.options.required?"Required field":this.validateType(e)||(this.options.validate?this.options.validate(e):null)}clean(e){return this.options.clean?this.options.clean(e):e}}class un extends e1{render(){let e=document.createElement("input");return e.type="text",e.placeholder=this.options.label,e.value=this.options.value||"",e.autocomplete="off",e}}function Vl(t,e){let n=t.selection.$from;for(let r=n.depth;r>=0;r--){let u=n.index(r);if(n.node(r).canReplaceWith(u,u,e))return!0}return!1}function t1(t){return new be({title:"Insert image",label:"Image",enable(e){return Vl(e,t)},run(e,n,r){let{from:u,to:i}=e.selection,o=null;e.selection instanceof E&&e.selection.node.type==t&&(o=e.selection.node.attrs),ql({title:"Insert image",fields:{src:new un({label:"Location",required:!0,value:o&&o.src}),title:new un({label:"Title",value:o&&o.title}),alt:new un({label:"Description",value:o?o.alt:e.doc.textBetween(u,i," ")})},callback(s){r.dispatch(r.state.tr.replaceSelectionWith(t.createAndFill(s))),r.focus()}})}})}function $l(t,e){let n={label:e.title,run:t};for(let r in e)n[r]=e[r];return!e.enable&&!e.select&&(n[e.enable?"enable":"select"]=r=>t(r)),new be(n)}function Ou(t,e){let{from:n,$from:r,to:u,empty:i}=t.selection;return i?!!e.isInSet(t.storedMarks||r.marks()):t.doc.rangeHasMark(n,u,e)}function Gr(t,e){let n={active(r){return Ou(r,t)}};for(let r in e)n[r]=e[r];return $l(He(t),n)}function n1(t){return new be({title:"Add or remove link",icon:ae.link,active(e){return Ou(e,t)},enable(e){return!e.selection.empty},run(e,n,r){if(Ou(e,t))return He(t)(e,n),!0;ql({title:"Create a link",fields:{href:new un({label:"Link target",required:!0}),title:new un({label:"Title"})},callback(u){He(t,u)(r.state,r.dispatch),r.focus()}})}})}function Io(t,e){return $l(Tu(t,e.attrs),e)}function r1(t){let e={},n;(n=t.marks.strong)&&(e.toggleStrong=Gr(n,{title:"Toggle strong style",icon:ae.strong})),(n=t.marks.em)&&(e.toggleEm=Gr(n,{title:"Toggle emphasis",icon:ae.em})),(n=t.marks.code)&&(e.toggleCode=Gr(n,{title:"Toggle code font",icon:ae.code})),(n=t.marks.link)&&(e.toggleLink=n1(n));let r;if((r=t.nodes.image)&&(e.insertImage=t1(r)),(r=t.nodes.bullet_list)&&(e.wrapBulletList=Io(r,{title:"Wrap in bullet list",icon:ae.bulletList})),(r=t.nodes.ordered_list)&&(e.wrapOrderedList=Io(r,{title:"Wrap in ordered list",icon:ae.orderedList})),(r=t.nodes.blockquote)&&(e.wrapBlockQuote=Mp(r,{title:"Wrap in block quote",icon:ae.blockquote})),(r=t.nodes.paragraph)&&(e.makeParagraph=Kr(r,{title:"Change to paragraph",label:"Plain"})),(r=t.nodes.code_block)&&(e.makeCodeBlock=Kr(r,{title:"Change to code block",label:"Code"})),r=t.nodes.heading)for(let i=1;i<=10;i++)e["makeHead"+i]=Kr(r,{title:"Change to heading "+i,label:"Level "+i,attrs:{level:i}});if(r=t.nodes.horizontal_rule){let i=r;e.insertHorizontalRule=new be({title:"Insert horizontal rule",label:"Horizontal rule",enable(o){return Vl(o,i)},run(o,s){s(o.tr.replaceSelectionWith(i.create()))}})}let u=i=>i.filter(o=>o);return e.insertMenu=new Fo(u([e.insertImage,e.insertHorizontalRule]),{label:"Insert"}),e.typeMenu=new Fo(u([e.makeParagraph,e.makeCodeBlock,e.makeHead1&&new kp(u([e.makeHead1,e.makeHead2,e.makeHead3,e.makeHead4,e.makeHead5,e.makeHead6]),{label:"Heading"})]),{label:"Type..."}),e.inlineMenu=[u([e.toggleStrong,e.toggleEm,e.toggleCode,e.toggleLink])],e.blockMenu=[u([e.wrapBulletList,e.wrapOrderedList,e.wrapBlockQuote,Dp,_p,Ep])],e.fullMenu=e.inlineMenu.concat([[e.insertMenu,e.typeMenu]],[[Sp,Ap]],e.blockMenu),e}const Ro=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function u1(t,e){let n={},r;function u(i,o){if(e){let s=e[i];if(s===!1)return;s&&(i=s)}n[i]=o}if(u("Mod-z",sr),u("Shift-Mod-z",yn),u("Backspace",Wp),Ro||u("Mod-y",yn),u("Alt-ArrowUp",_u),u("Alt-ArrowDown",Kh),u("Mod-BracketLeft",Eu),u("Escape",Su),(r=t.marks.strong)&&(u("Mod-b",He(r)),u("Mod-B",He(r))),(r=t.marks.em)&&(u("Mod-i",He(r)),u("Mod-I",He(r))),(r=t.marks.code)&&u("Mod-`",He(r)),(r=t.nodes.bullet_list)&&u("Shift-Ctrl-8",Tu(r)),(r=t.nodes.ordered_list)&&u("Shift-Ctrl-9",Tu(r)),(r=t.nodes.blockquote)&&u("Ctrl->",Au(r)),r=t.nodes.hard_break){let i=r,o=yr(Tl,(s,l)=>(l&&l(s.tr.replaceSelectionWith(i.create()).scrollIntoView()),!0));u("Mod-Enter",o),u("Shift-Enter",o),Ro&&u("Ctrl-Enter",o)}if((r=t.nodes.list_item)&&(u("Enter",zp(r)),u("Mod-[",Bp(r)),u("Mod-]",qp(r))),(r=t.nodes.paragraph)&&u("Shift-Ctrl-0",Wn(r)),(r=t.nodes.code_block)&&u("Shift-Ctrl-\\",Wn(r)),r=t.nodes.heading)for(let i=1;i<=6;i++)u("Shift-Ctrl-"+i,Wn(r,{level:i}));if(r=t.nodes.horizontal_rule){let i=r;u("Mod-_",(o,s)=>(s&&s(o.tr.replaceSelectionWith(i.create()).scrollIntoView()),!0))}return n}function i1(t){return ni(/^\s*>\s$/,t)}function o1(t){return ni(/^(\d+)\.\s$/,t,e=>({order:+e[1]}),(e,n)=>n.childCount+n.attrs.order==+e[1])}function s1(t){return ni(/^\s*([-+*])\s$/,t)}function l1(t){return Ll(/^```$/,t)}function a1(t,e){return Ll(new RegExp("^(#{1,"+e+"})\\s$"),t,n=>({level:n[1].length}))}function c1(t){let e=Qp.concat(Jp,jp),n;return(n=t.nodes.blockquote)&&e.push(i1(n)),(n=t.nodes.ordered_list)&&e.push(o1(n)),(n=t.nodes.bullet_list)&&e.push(s1(n)),(n=t.nodes.code_block)&&e.push(l1(n)),(n=t.nodes.heading)&&e.push(a1(n,6)),Hp({rules:e})}function Zr(t){let e=[c1(t.schema),Mo(u1(t.schema,t.mapKeys)),Mo(op),sp(),fp()];return t.menuBar!==!1&&e.push(Tp({floating:t.floatingMenu!==!1,content:t.menuContent||r1(t.schema).fullMenu})),t.history!==!1&&e.push(Vh()),e.concat(new xt({props:{attributes:{class:"ProseMirror-example-setup-style"}}}))}const ri="-";function f1(t){const e=h1(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;function u(o){const s=o.split(ri);return s[0]===""&&s.length!==1&&s.shift(),Hl(s,e)||d1(o)}function i(o,s){const l=n[o]||[];return s&&r[o]?[...l,...r[o]]:l}return{getClassGroupId:u,getConflictingClassGroupIds:i}}function Hl(t,e){var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),u=r?Hl(t.slice(1),r):void 0;if(u)return u;if(e.validators.length===0)return;const i=t.join(ri);return(o=e.validators.find(({validator:s})=>s(i)))==null?void 0:o.classGroupId}const zo=/^\[(.+)\]$/;function d1(t){if(zo.test(t)){const e=zo.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function h1(t){const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return m1(Object.entries(t.classGroups),n).forEach(([i,o])=>{Fu(o,r,i,e)}),r}function Fu(t,e,n,r){t.forEach(u=>{if(typeof u=="string"){const i=u===""?e:Bo(e,u);i.classGroupId=n;return}if(typeof u=="function"){if(p1(u)){Fu(u(r),e,n,r);return}e.validators.push({validator:u,classGroupId:n});return}Object.entries(u).forEach(([i,o])=>{Fu(o,Bo(e,i),n,r)})})}function Bo(t,e){let n=t;return e.split(ri).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function p1(t){return t.isThemeGetter}function m1(t,e){return e?t.map(([n,r])=>{const u=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,s])=>[e+o,s])):i);return[n,u]}):t}function g1(t){if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;function u(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return u(i,o),o},set(i,o){n.has(i)?n.set(i,o):u(i,o)}}}const Wl="!";function b1(t){const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,u=e[0],i=e.length;function o(s){const l=[];let a=0,c=0,f;for(let g=0;g<s.length;g++){let x=s[g];if(a===0){if(x===u&&(r||s.slice(g,g+i)===e)){l.push(s.slice(c,g)),c=g+i;continue}if(x==="/"){f=g;continue}}x==="["?a++:x==="]"&&a--}const d=l.length===0?s:s.substring(c),p=d.startsWith(Wl),h=p?d.substring(1):d,m=f&&f>c?f-c:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:h,maybePostfixModifierPosition:m}}return n?function(l){return n({className:l,parseClassName:o})}:o}function x1(t){if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e}function y1(t){return{cache:g1(t.cacheSize),parseClassName:b1(t),...f1(t)}}const k1=/\s+/;function C1(t,e){const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:u}=e,i=new Set;return t.trim().split(k1).map(o=>{const{modifiers:s,hasImportantModifier:l,baseClassName:a,maybePostfixModifierPosition:c}=n(o);let f=!!c,d=r(f?a.substring(0,c):a);if(!d){if(!f)return{isTailwindClass:!1,originalClassName:o};if(d=r(a),!d)return{isTailwindClass:!1,originalClassName:o};f=!1}const p=x1(s).join(":");return{isTailwindClass:!0,modifierId:l?p+Wl:p,classGroupId:d,originalClassName:o,hasPostfixModifier:f}}).reverse().filter(o=>{if(!o.isTailwindClass)return!0;const{modifierId:s,classGroupId:l,hasPostfixModifier:a}=o,c=s+l;return i.has(c)?!1:(i.add(c),u(l,a).forEach(f=>i.add(s+f)),!0)}).reverse().map(o=>o.originalClassName).join(" ")}function w1(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=jl(e))&&(r&&(r+=" "),r+=n);return r}function jl(t){if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=jl(t[r]))&&(n&&(n+=" "),n+=e);return n}function D1(t,...e){let n,r,u,i=o;function o(l){const a=e.reduce((c,f)=>f(c),t());return n=y1(a),r=n.cache.get,u=n.cache.set,i=s,s(l)}function s(l){const a=r(l);if(a)return a;const c=C1(l,n);return u(l,c),c}return function(){return i(w1.apply(null,arguments))}}function N(t){const e=n=>n[t]||[];return e.isThemeGetter=!0,e}const Jl=/^\[(?:([a-z-]+):)?(.+)\]$/i,_1=/^\d+\/\d+$/,E1=new Set(["px","full","screen"]),S1=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,A1=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,M1=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,v1=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,T1=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function ve(t){return lt(t)||E1.has(t)||_1.test(t)}function Ie(t){return qt(t,"length",P1)}function lt(t){return!!t&&!Number.isNaN(Number(t))}function Vn(t){return qt(t,"number",lt)}function jt(t){return!!t&&Number.isInteger(Number(t))}function O1(t){return t.endsWith("%")&&lt(t.slice(0,-1))}function A(t){return Jl.test(t)}function Re(t){return S1.test(t)}const F1=new Set(["length","size","percentage"]);function N1(t){return qt(t,F1,Ul)}function I1(t){return qt(t,"position",Ul)}const R1=new Set(["image","url"]);function z1(t){return qt(t,R1,q1)}function B1(t){return qt(t,"",L1)}function Jt(){return!0}function qt(t,e,n){const r=Jl.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1}function P1(t){return A1.test(t)&&!M1.test(t)}function Ul(){return!1}function L1(t){return v1.test(t)}function q1(t){return T1.test(t)}function V1(){const t=N("colors"),e=N("spacing"),n=N("blur"),r=N("brightness"),u=N("borderColor"),i=N("borderRadius"),o=N("borderSpacing"),s=N("borderWidth"),l=N("contrast"),a=N("grayscale"),c=N("hueRotate"),f=N("invert"),d=N("gap"),p=N("gradientColorStops"),h=N("gradientColorStopPositions"),m=N("inset"),g=N("margin"),x=N("opacity"),y=N("padding"),w=N("saturate"),C=N("scale"),D=N("sepia"),_=N("skew"),I=N("space"),B=N("translate"),S=()=>["auto","contain","none"],L=()=>["auto","hidden","clip","visible","scroll"],se=()=>["auto",A,e],O=()=>[A,e],Tn=()=>["",ve,Ie],rt=()=>["auto",lt,A],Ae=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],yt=()=>["solid","dashed","dotted","double","none"],ui=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],kr=()=>["start","end","center","between","around","evenly","stretch"],Vt=()=>["","0",A],ii=()=>["auto","avoid","all","avoid-page","page","left","right","column"],$t=()=>[lt,Vn],On=()=>[lt,A];return{cacheSize:500,separator:":",theme:{colors:[Jt],spacing:[ve,Ie],blur:["none","",Re,A],brightness:$t(),borderColor:[t],borderRadius:["none","","full",Re,A],borderSpacing:O(),borderWidth:Tn(),contrast:$t(),grayscale:Vt(),hueRotate:On(),invert:Vt(),gap:O(),gradientColorStops:[t],gradientColorStopPositions:[O1,Ie],inset:se(),margin:se(),opacity:$t(),padding:O(),saturate:$t(),scale:$t(),sepia:Vt(),skew:On(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",A]}],container:["container"],columns:[{columns:[Re]}],"break-after":[{"break-after":ii()}],"break-before":[{"break-before":ii()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Ae(),A]}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",jt,A]}],basis:[{basis:se()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",A]}],grow:[{grow:Vt()}],shrink:[{shrink:Vt()}],order:[{order:["first","last","none",jt,A]}],"grid-cols":[{"grid-cols":[Jt]}],"col-start-end":[{col:["auto",{span:["full",jt,A]},A]}],"col-start":[{"col-start":rt()}],"col-end":[{"col-end":rt()}],"grid-rows":[{"grid-rows":[Jt]}],"row-start-end":[{row:["auto",{span:[jt,A]},A]}],"row-start":[{"row-start":rt()}],"row-end":[{"row-end":rt()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",A]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",A]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...kr()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...kr(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...kr(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",A,e]}],"min-w":[{"min-w":[A,e,"min","max","fit"]}],"max-w":[{"max-w":[A,e,"none","full","min","max","fit","prose",{screen:[Re]},Re]}],h:[{h:[A,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[A,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[A,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[A,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Re,Ie]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Vn]}],"font-family":[{font:[Jt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",A]}],"line-clamp":[{"line-clamp":["none",lt,Vn]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ve,A]}],"list-image":[{"list-image":["none",A]}],"list-style-type":[{list:["none","disc","decimal",A]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...yt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ve,Ie]}],"underline-offset":[{"underline-offset":["auto",ve,A]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",A]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",A]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Ae(),I1]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",N1]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},z1]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[h]}],"gradient-via-pos":[{via:[h]}],"gradient-to-pos":[{to:[h]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...yt(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:yt()}],"border-color":[{border:[u]}],"border-color-x":[{"border-x":[u]}],"border-color-y":[{"border-y":[u]}],"border-color-t":[{"border-t":[u]}],"border-color-r":[{"border-r":[u]}],"border-color-b":[{"border-b":[u]}],"border-color-l":[{"border-l":[u]}],"divide-color":[{divide:[u]}],"outline-style":[{outline:["",...yt()]}],"outline-offset":[{"outline-offset":[ve,A]}],"outline-w":[{outline:[ve,Ie]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:Tn()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[ve,Ie]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Re,B1]}],"shadow-color":[{shadow:[Jt]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...ui(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ui()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Re,A]}],grayscale:[{grayscale:[a]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[a]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",A]}],duration:[{duration:On()}],ease:[{ease:["linear","in","out","in-out",A]}],delay:[{delay:On()}],animate:[{animate:["none","spin","ping","pulse","bounce",A]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[jt,A]}],"translate-x":[{"translate-x":[B]}],"translate-y":[{"translate-y":[B]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",A]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",A]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",A]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ve,Ie,Vn]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}const $1=D1(V1);function H1(t){let e,n,r,u=[{type:"range"},t[2],{class:t[1]}],i={};for(let o=0;o<u.length;o+=1)i=Yr(i,u[o]);return{c(){e=Zt("input"),this.h()},l(o){e=Qt(o,"INPUT",{type:!0,class:!0}),this.h()},h(){oi(e,i)},m(o,s){wn(o,e,s),e.autofocus&&e.focus(),si(e,t[0]),n||(r=[ze(e,"change",t[9]),ze(e,"input",t[9]),ze(e,"change",t[4]),ze(e,"click",t[5]),ze(e,"keydown",t[6]),ze(e,"keypress",t[7]),ze(e,"keyup",t[8])],n=!0)},p(o,[s]){oi(e,i=na(u,[{type:"range"},s&4&&o[2],s&2&&{class:o[1]}])),s&1&&si(e,o[0])},i:St,o:St,d(o){o&&Ge(e),n=!1,Ql(r)}}}function W1(t,e,n){const r=["value","size"];let u=li(e,r),{value:i}=e,{size:o="md"}=e;const s={sm:"h-1 range-sm",md:"h-2",lg:"h-3 range-lg"};let l;function a(m){Dt.call(this,t,m)}function c(m){Dt.call(this,t,m)}function f(m){Dt.call(this,t,m)}function d(m){Dt.call(this,t,m)}function p(m){Dt.call(this,t,m)}function h(){i=Xl(this.value),n(0,i)}return t.$$set=m=>{n(11,e=Yr(Yr({},e),ai(m))),n(2,u=li(e,r)),"value"in m&&n(0,i=m.value),"size"in m&&n(3,o=m.size)},t.$$.update=()=>{n(1,l=$1("w-full bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",s[o]??s.md,e.class))},e=ai(e),[i,l,u,o,a,c,f,d,p,h]}class j1 extends lr{constructor(e){super(),ar(this,e,W1,H1,Cn,{value:0,size:3})}}function J1(t){let e,n,r,u,i,o,s,l="Detail Level",a,c,f;function d(h){t[2](h)}let p={min:0,max:100,step:50};return t[0]!==void 0&&(p.value=t[0]),n=new j1({props:p}),Nu.push(()=>qo(n,"value",d)),n.$on("click",U1),{c(){e=Zt("div"),nu(n.$$.fragment),u=eu(),i=Zt("div"),o=eu(),s=Zt("div"),s.textContent=l,this.h()},l(h){e=Qt(h,"DIV",{class:!0});var m=Qr(e);ru(n.$$.fragment,m),u=tu(m),i=Qt(m,"DIV",{}),Qr(i).forEach(Ge),o=tu(m),s=Qt(m,"DIV",{class:!0,"data-svelte-h":!0}),Yl(s)!=="svelte-1fck0kr"&&(s.textContent=l),m.forEach(Ge),this.h()},h(){Xr(s,"class","text-xs"),Xr(e,"class","flex flex-col align-top gap-2 p-4 rounded-md bg-neutral-100 sticky top-2")},m(h,m){wn(h,e,m),uu(n,e,null),Fn(e,u),Fn(e,i),Fn(e,o),Fn(e,s),a=!0,c||(f=ze(e,"click",t[1]),c=!0)},p(h,[m]){const g={};!r&&m&1&&(r=!0,g.value=h[0],Lo(()=>r=!1)),n.$set(g)},i(h){a||(on(n.$$.fragment,h),a=!0)},o(h){sn(n.$$.fragment,h),a=!1},d(h){h&&Ge(e),iu(n),c=!1,f()}}}const U1=t=>t.stopPropagation();function K1(t,e,n){let{level:r}=e;function u(o){Dt.call(this,t,o)}function i(o){r=o,n(0,r)}return t.$$set=o=>{"level"in o&&n(0,r=o.level)},[r,u,i]}class G1 extends lr{constructor(e){super(),ar(this,e,K1,J1,Cn,{level:0})}}function Po(t){let e,n,r,u,i;function o(l){t[4](l)}let s={};return t[1]!==void 0&&(s.level=t[1]),e=new G1({props:s}),Nu.push(()=>qo(e,"level",o)),u=new Bf({props:{state:t[2]}}),u.$on("statechange",t[3]),{c(){nu(e.$$.fragment),r=eu(),nu(u.$$.fragment)},l(l){ru(e.$$.fragment,l),r=tu(l),ru(u.$$.fragment,l)},m(l,a){uu(e,l,a),wn(l,r,a),uu(u,l,a),i=!0},p(l,a){const c={};!n&&a&2&&(n=!0,c.level=l[1],Lo(()=>n=!1)),e.$set(c);const f={};a&4&&(f.state=l[2]),u.$set(f)},i(l){i||(on(e.$$.fragment,l),on(u.$$.fragment,l),i=!0)},o(l){sn(e.$$.fragment,l),sn(u.$$.fragment,l),i=!1},d(l){l&&Ge(r),iu(e,l),iu(u,l)}}}function Z1(t){let e=t[0].content.index.toString()+t[1],n,r,u=Po(t);return{c(){u.c(),n=ci()},l(i){u.l(i),n=ci()},m(i,o){u.m(i,o),wn(i,n,o),r=!0},p(i,[o]){o&3&&Cn(e,e=i[0].content.index.toString()+i[1])?(ea(),sn(u,1,1,St),ta(),u=Po(i),u.c(),on(u,1),u.m(n.parentNode,n)):u.p(i,o)},i(i){r||(on(u),r=!0)},o(i){sn(u),r=!1},d(i){i&&Ge(n),u.d(i)}}}function Q1(t,e,n){let{data:r}=e,u,i=100;function o(l){n(2,u=l.detail.state)}function s(l){i=l,n(1,i)}return t.$$set=l=>{"data"in l&&n(0,r=l.data)},t.$$.update=()=>{t.$$.dirty&3&&(i===0?n(2,u=Je.create({schema:ut,doc:$r.parse(r.content.quarter),plugins:Zr({schema:ut,menuBar:!1})})):i===50?n(2,u=Je.create({schema:ut,doc:$r.parse(r.content.half),plugins:Zr({schema:ut,menuBar:!1})})):i===100&&n(2,u=Je.create({schema:ut,doc:$r.parse(r.content.index),plugins:Zr({schema:ut,menuBar:!1})})))},[r,i,u,o,s]}class tm extends lr{constructor(e){super(),ar(this,e,Q1,Z1,Cn,{data:0})}}export{tm as P};
